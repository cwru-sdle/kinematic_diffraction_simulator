(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    348202,       9008]
NotebookOptionsPosition[    318484,       8580]
NotebookOutlinePosition[    319011,       8599]
CellTagsIndexPosition[    318968,       8596]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Diffraction", "Title",ExpressionUUID->"4bffcede-9db8-4d82-82b0-f760447a5827"],

Cell[CellGroupData[{

Cell["Settings", "Chapter",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"a32133cb-441f-4de4-8b64-6c3a7f7e17e9"],

Cell["Interactive / Speed", "Section",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"14bf0795-8324-476b-bf0a-dbda742b5996"],

Cell["Speed Version / Interactive", "Subsubsection",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"5e70a3ef-720f-42c4-8d8f-e2d6a9feca3d"],

Cell[TextData[{
 "Parallelization is incompatible with Monitor[], a function showing the \
evolving patterns. If you want to view progress during execution, set ",
 StyleBox["bInteractive",
  FontSlant->"Italic"],
 " to True. The interactive version will also indicate the location of the \
pattern center by a cross and add a 1 nm scale marker. If you set interactive \
to False, parallelization will grab up the maximum allowed number of CPUs on \
your machine and process subsequent iterations of the loop that generates \
diffraction patterns on different kernels / CPUs."
}], "Text",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"fcfc5d70-a2a7-4130-8519-816bc8acdaf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bInteractive", "=", "False"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellLabel->"In[9]:=",ExpressionUUID->"9d3f7ba4-6355-4594-8c08-0ff03f247c2f"],

Cell["Output Folder", "Section",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"55d50fee-a451-4a21-ae8c-cf7959ad9bd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sOutputFolder", "=", "\"\<OutputFolder\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.926212265226263*^9, 3.9262122702326183`*^9}, {
  3.926212576306604*^9, 3.926212585372788*^9}, {3.926212792644751*^9, 
  3.9262127953834352`*^9}},ExpressionUUID->"53f39d9d-fe28-451c-ac20-\
4c0ba9400154"],

Cell["Mathematica", "Section",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"973ae5d5-c003-4001-a8b8-166d90d007e7"],

Cell["Git Version Control", "Subsubsection",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"fa70895d-ea6b-4650-8060-18af9e971c27"],

Cell["\<\
https://bit.ly/3GV63BG: Go to Option Inspector, \
\[OpenCurlyDoubleQuote]Notebook Options\[CloseCurlyDoubleQuote]/\
\[CloseCurlyDoubleQuote]PrivatNotebookOptions\[CloseCurlyDoubleQuote]/\
\[CloseCurlyDoubleQuote]FileOutlineCache.\[CloseCurlyDoubleQuote]
Set \[OpenCurlyDoubleQuote]FileOutlineCache\[CloseCurlyDoubleQuote] to \
\[OpenCurlyDoubleQuote]False.\[CloseCurlyDoubleQuote]\
\>", "Text",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"f7dab53f-62ab-4174-be47-c05abc684c9d"],

Cell["Subscripted Variables", "Subsubsection",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"3152b6fc-d5ce-425d-88c7-297d16d454af"],

Cell[TextData[{
 "The following makes subscripted variables ",
 StyleBox["single",
  FontSlant->"Italic"],
 " variables."
}], "Text",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"485940a4-9af5-4f97-9844-1024197d7fdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Symbolize", "[", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SubscriptBox", "[", 
     RowBox[{"\"\<_\>\"", ",", "\"\<_\>\""}], "]"}], "]"}], "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{3.9262122745112743`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"f7725e6d-96a8-47b5-b399-4005b4689c45"],

Cell["Length Unit", "Section",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"5f93470f-7ea4-4bb3-828a-4bbb9d2d78da"],

Cell["\<\
The global default length unit assumed in this notebook is 1 nm.\
\>", "Text",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"7693ef42-22c2-40b5-9b6c-4efd07a1ac5e"],

Cell["\<\
Define a constant we can use to convert from Angstrom to nanometer.\
\>", "Text",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"d4b95f32-d474-409b-808a-4a52801405c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalARing]", "=", "0.1"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellLabel->"In[13]:=",ExpressionUUID->"2617f01f-e10f-4a84-96c2-c46ffac8fc0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["X-Ray Diffractometry", "Chapter",ExpressionUUID->"7caeabf8-e1a2-416d-b22b-3f93f06bfbb0"],

Cell[CellGroupData[{

Cell["X-Ray Atom Form Factors", "Section",ExpressionUUID->"0a1749b0-0737-44b4-b2b0-aa2bc61b5b92"],

Cell[TextData[{
 "Different atoms diffract X-rays with different efficacy or \
\[OpenCurlyDoubleQuote]diffraction amplitude.\[CloseCurlyDoubleQuote] \
Moreover, the diffraction amplitude depends on the ",
 StyleBox["angle",
  FontSlant->"Italic"],
 " into which diffraction is being considered. The amplitude falls off with \
increasing angle because portions of the wave diffracted from different \
regions around the exact atom position interfere destructively. The smaller \
the atom, the more quickly is the fall-off."
}], "Text",ExpressionUUID->"e7a77704-f561-4b7e-b624-cc685f7354f9"],

Cell["\<\
The dependency of the diffraction amplitude on the atomic number and the \
diffraction angle is generally known and tabulated in the form of 4 \
superimposed Gau\[SZ] distributions plus one constant. The data are contained \
in the next section.\
\>", "Text",ExpressionUUID->"92b18b57-01f2-4d1d-b7d0-4c7eb96e870a"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Form Factor Data", "Subsection"]], "Subsection",ExpressionUUID->"00f7b557-7beb-4f55-91ba-f170a9f5d594"],

Cell["https://bit.ly/3X2X1I1", "Text",ExpressionUUID->"752961e2-10b1-47e4-a73e-e23f4cacd6cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lXFFData", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<H\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "0.489918", ",", "20.6593", ",", "0.262003", ",", "7.74039", ",", 
        "0.196767", ",", "49.5519", ",", "0.049879", ",", "2.20159", ",", 
        "0.001305"}], "}"}]}], ",", 
     RowBox[{"\"\<H1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "0.897661", ",", "53.1368", ",", "0.565616", ",", "15.187", ",", 
        "0.415815", ",", "186.576", ",", "0.116973", ",", "3.56709", ",", 
        "0.002389"}], "}"}]}], ",", 
     RowBox[{"\"\<He\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "0.8734", ",", "9.1037", ",", "0.6309", ",", "3.3568", ",", "0.3112", 
        ",", "22.9276", ",", "0.178", ",", "0.9821", ",", "0.0064"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Li\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "1.1282", ",", "3.9546", ",", "0.7508", ",", "1.0524", ",", "0.6175", 
        ",", "85.3905", ",", "0.4653", ",", "168.261", ",", "0.0377"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Li1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "0.6968", ",", "4.6237", ",", "0.7888", ",", "1.9557", ",", "0.3414", 
        ",", "0.6316", ",", "0.1563", ",", "10.0953", ",", "0.0167"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Be\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "1.5919", ",", "43.6427", ",", "1.1278", ",", "1.8623", ",", "0.5391", 
        ",", "103.483", ",", "0.7029", ",", "0.542", ",", "0.0385"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Be2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "6.2603", ",", "0.0027", ",", "0.8849", ",", "0.8313", ",", "0.7993", 
        ",", "2.2758", ",", "0.1647", ",", "5.1146", ",", 
        RowBox[{"-", "6.1092"}]}], "}"}]}], ",", 
     RowBox[{"\"\<B\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "2.0545", ",", "23.2185", ",", "1.3326", ",", "1.021", ",", "1.0979", 
        ",", "60.3498", ",", "0.7068", ",", "0.1403", ",", 
        RowBox[{"-", "0.1932"}]}], "}"}]}], ",", 
     RowBox[{"\"\<C\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "2.31", ",", "20.8439", ",", "1.02", ",", "10.2075", ",", "1.5886", 
        ",", "0.5687", ",", "0.865", ",", "51.6512", ",", "0.2156"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Cval\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "2.26069", ",", "22.6907", ",", "1.56165", ",", "0.656665", ",", 
        "1.05075", ",", "9.75618", ",", "0.839259", ",", "55.5949", ",", 
        "0.286977"}], "}"}]}], ",", 
     RowBox[{"\"\<N\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "12.2126", ",", "0.0057", ",", "3.1322", ",", "9.8933", ",", "2.0125", 
        ",", "28.9975", ",", "1.1663", ",", "0.5826", ",", 
        RowBox[{"-", "11.529"}]}], "}"}]}], ",", 
     RowBox[{"\"\<O\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.0485", ",", "13.2771", ",", "2.2868", ",", "5.7011", ",", "1.5463", 
        ",", "0.3239", ",", "0.867", ",", "32.9089", ",", "0.2508"}], "}"}]}],
      ",", 
     RowBox[{"\"\<O1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "4.1916", ",", "12.8573", ",", "1.63969", ",", "4.17236", ",", 
        "1.52673", ",", "47.0179", ",", 
        RowBox[{"-", "20.307"}], ",", 
        RowBox[{"-", "0.01404"}], ",", "21.9412"}], "}"}]}], ",", 
     RowBox[{"\"\<F\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.5392", ",", "10.2825", ",", "2.6412", ",", "4.2944", ",", "1.517", 
        ",", "0.2615", ",", "1.0243", ",", "26.1476", ",", "0.2776"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<F1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.6322", ",", "5.27756", ",", "3.51057", ",", "14.7353", ",", 
        "1.26064", ",", "0.442258", ",", "0.940706", ",", "47.3437", ",", 
        "0.653396"}], "}"}]}], ",", 
     RowBox[{"\"\<Ne\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.9553", ",", "8.4042", ",", "3.1125", ",", "3.4262", ",", "1.4546", 
        ",", "0.2306", ",", "1.1251", ",", "21.7184", ",", "0.3515"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Na\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "4.7626", ",", "3.285", ",", "3.1736", ",", "8.8422", ",", "1.2674", 
        ",", "0.3136", ",", "1.1128", ",", "129.424", ",", "0.676"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Na1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.2565", ",", "2.6671", ",", "3.9362", ",", "6.1153", ",", "1.3998", 
        ",", "0.2001", ",", "1.0032", ",", "14.039", ",", "0.404"}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Mg\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "5.4204", ",", "2.8275", ",", "2.1735", ",", "79.2611", ",", "1.2269", 
        ",", "0.3808", ",", "2.3073", ",", "7.1937", ",", "0.8584"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Mg2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.4988", ",", "2.1676", ",", "3.8378", ",", "4.7542", ",", "1.3284", 
        ",", "0.185", ",", "0.8497", ",", "10.1411", ",", "0.4853"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Al\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "6.4202", ",", "3.0387", ",", "1.9002", ",", "0.7426", ",", "1.5936", 
        ",", "31.5472", ",", "1.9646", ",", "85.0886", ",", "1.1151"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Al3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "4.17448", ",", "1.93816", ",", "3.3876", ",", "4.14553", ",", 
        "1.20296", ",", "0.228753", ",", "0.528137", ",", "8.28524", ",", 
        "0.706786"}], "}"}]}], ",", 
     RowBox[{"\"\<Siv\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "6.2915", ",", "2.4386", ",", "3.0353", ",", "32.3337", ",", "1.9891", 
        ",", "0.6785", ",", "1.541", ",", "81.6937", ",", "1.1407"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Sival\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "5.66269", ",", "2.6652", ",", "3.07164", ",", "38.6634", ",", 
        "2.62446", ",", "0.916946", ",", "1.3932", ",", "93.5458", ",", 
        "1.24707"}], "}"}]}], ",", 
     RowBox[{"\"\<Si4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "4.43918", ",", "1.64167", ",", "3.20345", ",", "3.43757", ",", 
        "1.19453", ",", "0.2149", ",", "0.41653", ",", "6.65365", ",", 
        "0.746297"}], "}"}]}], ",", 
     RowBox[{"\"\<P\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "6.4345", ",", "1.9067", ",", "4.1791", ",", "27.157", ",", "1.78", 
        ",", "0.526", ",", "1.4908", ",", "68.1645", ",", "1.1149"}], "}"}]}],
      ",", 
     RowBox[{"\"\<S\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "6.9053", ",", "1.4679", ",", "5.2034", ",", "22.2151", ",", "1.4379", 
        ",", "0.2536", ",", "1.5863", ",", "56.172", ",", "0.8669"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Cl\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.4604", ",", "0.0104", ",", "7.1964", ",", "1.1662", ",", "6.2556", 
        ",", "18.5194", ",", "1.6455", ",", "47.7784", ",", 
        RowBox[{"-", "9.5574"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Cl1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.2915", ",", "0.0066", ",", "7.2084", ",", "1.1717", ",", "6.5337", 
        ",", "19.5424", ",", "2.3386", ",", "60.4486", ",", 
        RowBox[{"-", "16.378"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Ar\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "7.4845", ",", "0.9072", ",", "6.7723", ",", "14.8407", ",", "0.6539", 
        ",", "43.8983", ",", "1.6442", ",", "33.3929", ",", "1.4445"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<K\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "8.2186", ",", "12.7949", ",", "7.4398", ",", "0.7748", ",", "1.0519", 
        ",", "213.187", ",", "0.8659", ",", "41.6841", ",", "1.4228"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<K1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "7.9578", ",", "12.6331", ",", "7.4917", ",", "0.7674", ",", "6.359", 
        ",", 
        RowBox[{"-", "0.002"}], ",", "1.1915", ",", "31.9128", ",", 
        RowBox[{"-", "4.9978"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Ca\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "8.6266", ",", "10.4421", ",", "7.3873", ",", "0.6599", ",", "1.5899", 
        ",", "85.7484", ",", "1.0211", ",", "178.437", ",", "1.3751"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ca2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"15.6348", ",", 
        RowBox[{"-", "0.0074"}], ",", "7.9518", ",", "0.6089", ",", "8.4372", 
        ",", "10.3116", ",", "0.8537", ",", "25.9905", ",", 
        RowBox[{"-", "14.875"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Sc\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.189", ",", "9.0213", ",", "7.3679", ",", "0.5729", ",", "1.6409", 
        ",", "136.108", ",", "1.468", ",", "51.3531", ",", "1.3329"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sc3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "13.4008", ",", "0.29854", ",", "8.0273", ",", "7.9629", ",", 
        "1.65943", ",", 
        RowBox[{"-", "0.28604"}], ",", "1.57936", ",", "16.0662", ",", 
        RowBox[{"-", "6.6667"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Ti\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.7595", ",", "7.8508", ",", "7.3558", ",", "0.5", ",", "1.6991", ",",
         "35.6338", ",", "1.9021", ",", "116.105", ",", "1.2807"}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Ti2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.11423", ",", "7.5243", ",", "7.62174", ",", "0.457585", ",", 
        "2.2793", ",", "19.5361", ",", "0.087899", ",", "61.6558", ",", 
        "0.897155"}], "}"}]}], ",", 
     RowBox[{"\"\<Ti3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.7344", ",", "0.22061", ",", "8.73816", ",", "7.04716", ",", 
        "5.25691", ",", 
        RowBox[{"-", "0.15762"}], ",", "1.92134", ",", "15.9768", ",", 
        RowBox[{"-", "14.652"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Ti4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.5114", ",", "0.178847", ",", "8.23473", ",", "6.67018", ",", 
        "2.01341", ",", 
        RowBox[{"-", "0.29263"}], ",", "1.5208", ",", "12.9464", ",", 
        RowBox[{"-", "13.28"}]}], "}"}]}], ",", 
     RowBox[{"\"\<V\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.2971", ",", "6.8657", ",", "7.3511", ",", "0.4385", ",", "2.0703", 
        ",", "26.8938", ",", "2.0571", ",", "102.478", ",", "1.2199"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<V2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.106", ",", "6.8818", ",", "7.3541", ",", "0.4409", ",", "2.2884", 
        ",", "20.3004", ",", "0.0223", ",", "115.122", ",", "1.2298"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<V3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.43141", ",", "6.39535", ",", "7.7419", ",", "0.383349", ",", 
        "2.15343", ",", "15.1908", ",", "0.016865", ",", "63.969", ",", 
        "0.656565"}], "}"}]}], ",", 
     RowBox[{"\"\<V5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "15.6887", ",", "0.679003", ",", "8.14208", ",", "5.40135", ",", 
        "2.03081", ",", "9.97278", ",", 
        RowBox[{"-", "9.576"}], ",", "0.940464", ",", "1.7143"}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Cr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.6406", ",", "6.1038", ",", "7.3537", ",", "0.392", ",", "3.324", 
        ",", "20.2626", ",", "1.4922", ",", "98.7399", ",", "1.1832"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Cr2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.54034", ",", "5.66078", ",", "7.7509", ",", "0.344261", ",", 
        "3.58274", ",", "13.3075", ",", "0.509107", ",", "32.4224", ",", 
        "0.616898"}], "}"}]}], ",", 
     RowBox[{"\"\<Cr3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.6809", ",", "5.59463", ",", "7.81136", ",", "0.334393", ",", 
        "2.87603", ",", "12.8288", ",", "0.113575", ",", "32.8761", ",", 
        "0.518275"}], "}"}]}], ",", 
     RowBox[{"\"\<Mn\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.2819", ",", "5.3409", ",", "7.3573", ",", "0.3432", ",", "3.0193", 
        ",", "17.8674", ",", "2.2441", ",", "83.7543", ",", "1.0896"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Mn2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.8061", ",", "5.2796", ",", "7.362", ",", "0.3435", ",", "3.5268", 
        ",", "14.343", ",", "0.2184", ",", "41.3235", ",", "1.0874"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Mn3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.84521", ",", "4.91797", ",", "7.87194", ",", "0.294393", ",", 
        "3.56531", ",", "10.8171", ",", "0.323613", ",", "24.1281", ",", 
        "0.393974"}], "}"}]}], ",", 
     RowBox[{"\"\<Mn4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "9.96253", ",", "4.8485", ",", "7.97057", ",", "0.283303", ",", 
        "2.76067", ",", "10.4852", ",", "0.054447", ",", "27.573", ",", 
        "0.251877"}], "}"}]}], ",", 
     RowBox[{"\"\<Fe\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.7695", ",", "4.7611", ",", "7.3573", ",", "0.3072", ",", "3.5222", 
        ",", "15.3535", ",", "2.3045", ",", "76.8805", ",", "1.0369"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Fe2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.0424", ",", "4.6538", ",", "7.374", ",", "0.3053", ",", "4.1346", 
        ",", "12.0546", ",", "0.4399", ",", "31.2809", ",", "1.0097"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Fe3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.1764", ",", "4.6147", ",", "7.3863", ",", "0.3005", ",", "3.3948", 
        ",", "11.6729", ",", "0.0724", ",", "38.5566", ",", "0.9707"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Co\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "12.2841", ",", "4.2791", ",", "7.3409", ",", "0.2784", ",", "4.0034", 
        ",", "13.5359", ",", "2.3488", ",", "71.1692", ",", "1.0118"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Co2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.2296", ",", "4.1231", ",", "7.3883", ",", "0.2726", ",", "4.7393", 
        ",", "10.2443", ",", "0.7108", ",", "25.6466", ",", "0.9324"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Co3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.338", ",", "3.90969", ",", "7.88173", ",", "0.238668", ",", 
        "4.76795", ",", "8.35583", ",", "0.725591", ",", "18.3491", ",", 
        "0.286667"}], "}"}]}], ",", 
     RowBox[{"\"\<Ni\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "12.8376", ",", "3.8785", ",", "7.292", ",", "0.2565", ",", "4.4438", 
        ",", "12.1763", ",", "2.38", ",", "66.3421", ",", "1.0341"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Ni2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.4166", ",", "3.6766", ",", "7.4005", ",", "0.2449", ",", "5.3442", 
        ",", "8.873", ",", "0.9773", ",", "22.1626", ",", "0.8614"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Ni3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "10.7806", ",", "3.5477", ",", "7.75868", ",", "0.22314", ",", 
        "5.22746", ",", "7.64468", ",", "0.847114", ",", "16.9673", ",", 
        "0.386044"}], "}"}]}], ",", 
     RowBox[{"\"\<Cu\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "13.338", ",", "3.5828", ",", "7.1676", ",", "0.247", ",", "5.6158", 
        ",", "11.3966", ",", "1.6735", ",", "64.8126", ",", "1.191"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Cu1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.9475", ",", "3.3669", ",", "7.3573", ",", "0.2274", ",", "6.2455", 
        ",", "8.6625", ",", "1.5578", ",", "25.8487", ",", "0.89"}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Cu2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.8168", ",", "3.37484", ",", "7.11181", ",", "0.244078", ",", 
        "5.78135", ",", "7.9876", ",", "1.14523", ",", "19.897", ",", 
        "1.14431"}], "}"}]}], ",", 
     RowBox[{"\"\<Zn\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "14.0743", ",", "3.2655", ",", "7.0318", ",", "0.2333", ",", "5.1652", 
        ",", "10.3163", ",", "2.41", ",", "58.7097", ",", "1.3041"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Zn2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "11.9719", ",", "2.9946", ",", "7.3862", ",", "0.2031", ",", "6.4668", 
        ",", "7.0826", ",", "1.394", ",", "18.0995", ",", "0.7807"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Ga\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "15.2354", ",", "3.0669", ",", "6.7006", ",", "0.2412", ",", "4.3591", 
        ",", "10.7805", ",", "2.9623", ",", "61.4135", ",", "1.7189"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ga3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "12.692", ",", "2.81262", ",", "6.69883", ",", "0.22789", ",", 
        "6.06692", ",", "6.36441", ",", "1.0066", ",", "14.4122", ",", 
        "1.53545"}], "}"}]}], ",", 
     RowBox[{"\"\<Ge\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "16.0816", ",", "2.8509", ",", "6.3747", ",", "0.2516", ",", "3.7068", 
        ",", "11.4468", ",", "3.683", ",", "54.7625", ",", "2.1313"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ge4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "12.9172", ",", "2.53718", ",", "6.70003", ",", "0.205855", ",", 
        "6.06791", ",", "5.47913", ",", "0.859041", ",", "11.603", ",", 
        "1.45572"}], "}"}]}], ",", 
     RowBox[{"\"\<As\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "16.6723", ",", "2.6345", ",", "6.0701", ",", "0.2647", ",", "3.4313", 
        ",", "12.9479", ",", "4.2779", ",", "47.7972", ",", "2.531"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Se\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.0006", ",", "2.4098", ",", "5.8196", ",", "0.2726", ",", "3.9731", 
        ",", "15.2372", ",", "4.3543", ",", "43.8163", ",", "2.8409"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Br\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.1789", ",", "2.1723", ",", "5.2358", ",", "16.5796", ",", "5.6377",
         ",", "0.2609", ",", "3.9851", ",", "41.4328", ",", "2.9557"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Br1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.1718", ",", "2.2059", ",", "6.3338", ",", "19.3345", ",", "5.5754",
         ",", "0.2871", ",", "3.7272", ",", "58.1535", ",", "3.1776"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Kr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.3555", ",", "1.9384", ",", "6.7286", ",", "16.5623", ",", "5.5493",
         ",", "0.2261", ",", "3.5375", ",", "39.3972", ",", "2.825"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Rb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.1784", ",", "1.7888", ",", "9.6435", ",", "17.3151", ",", "5.1399",
         ",", "0.2748", ",", "1.5292", ",", "164.934", ",", "3.4873"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Rb1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.5816", ",", "1.7139", ",", "7.6598", ",", "14.7957", ",", "5.8981",
         ",", "0.1603", ",", "2.7817", ",", "31.2087", ",", "2.0782"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.5663", ",", "1.5564", ",", "9.8184", ",", "14.0988", ",", "5.422", 
        ",", "0.1664", ",", "2.6694", ",", "132.376", ",", "2.5064"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sr2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.0874", ",", "1.4907", ",", "8.1373", ",", "12.6963", ",", "2.5654",
         ",", "24.5651", ",", 
        RowBox[{"-", "34.193"}], ",", 
        RowBox[{"-", "0.0138"}], ",", "41.4025"}], "}"}]}], ",", 
     RowBox[{"\"\<Y\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.776", ",", "1.4029", ",", "10.2946", ",", "12.8006", ",", 
        "5.72629", ",", "0.125599", ",", "3.26588", ",", "104.354", ",", 
        "1.91213"}], "}"}]}], ",", 
     RowBox[{"\"\<Y3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.9268", ",", "1.35417", ",", "9.1531", ",", "11.2145", ",", 
        "1.76795", ",", "22.6599", ",", 
        RowBox[{"-", "33.108"}], ",", 
        RowBox[{"-", "0.01319"}], ",", "40.2602"}], "}"}]}], ",", 
     RowBox[{"\"\<Zr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.8765", ",", "1.27618", ",", "10.948", ",", "11.916", ",", 
        "5.41732", ",", "0.117622", ",", "3.65721", ",", "87.6627", ",", 
        "2.06929"}], "}"}]}], ",", 
     RowBox[{"\"\<Zr4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.1668", ",", "1.2148", ",", "10.0562", ",", "10.1483", ",", 
        "1.01118", ",", "21.6054", ",", 
        RowBox[{"-", "2.6479"}], ",", 
        RowBox[{"-", "0.10276"}], ",", "9.41454"}], "}"}]}], ",", 
     RowBox[{"\"\<Nb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.6142", ",", "1.18865", ",", "12.0144", ",", "11.766", ",", 
        "4.04183", ",", "0.204785", ",", "3.53346", ",", "69.7957", ",", 
        "3.75591"}], "}"}]}], ",", 
     RowBox[{"\"\<Nb3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.8812", ",", "0.019175", ",", "18.0653", ",", "1.13305", ",", 
        "11.0177", ",", "10.1621", ",", "1.94715", ",", "28.3389", ",", 
        RowBox[{"-", "12.912"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Nb5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.9163", ",", "1.12446", ",", "13.3417", ",", "0.028781", ",", 
        "10.799", ",", "9.28206", ",", "0.337905", ",", "25.7228", ",", 
        RowBox[{"-", "6.3934"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Mo\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "3.7025", ",", "0.2772", ",", "17.2356", ",", "1.0958", ",", "12.8876",
         ",", "11.004", ",", "3.7429", ",", "61.6584", ",", "4.3875"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Mo3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.1664", ",", "0.014734", ",", "18.2017", ",", "1.03031", ",", 
        "11.7423", ",", "9.53659", ",", "2.30951", ",", "26.6307", ",", 
        RowBox[{"-", "14.421"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Mo5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.0149", ",", "0.014345", ",", "18.0992", ",", "1.02238", ",", 
        "11.4632", ",", "8.78809", ",", "0.740625", ",", "23.3452", ",", 
        RowBox[{"-", "14.316"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Mo6\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "17.8871", ",", "1.03649", ",", "11.175", ",", "8.48061", ",", 
        "6.57891", ",", "0.058881", ",", "0.000", ",", "0.000", ",", 
        "0.344941"}], "}"}]}], ",", 
     RowBox[{"\"\<Tc\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1301", ",", "0.864132", ",", "11.0948", ",", "8.14487", ",", 
        "4.64901", ",", "21.5707", ",", "2.71263", ",", "86.8472", ",", 
        "5.40428"}], "}"}]}], ",", 
     RowBox[{"\"\<Ru\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.2674", ",", "0.80852", ",", "12.9182", ",", "8.43467", ",", 
        "4.86337", ",", "24.7997", ",", "1.56756", ",", "94.2928", ",", 
        "5.37874"}], "}"}]}], ",", 
     RowBox[{"\"\<Ru3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.5638", ",", "0.847329", ",", "13.2885", ",", "8.37164", ",", 
        "9.32602", ",", "0.017662", ",", "3.00964", ",", "22.887", ",", 
        RowBox[{"-", "3.1892"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Ru4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.5003", ",", "0.844582", ",", "13.1787", ",", "8.12534", ",", 
        "4.71304", ",", "0.36495", ",", "2.18535", ",", "20.8504", ",", 
        "1.42357"}], "}"}]}], ",", 
     RowBox[{"\"\<Rh\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.2957", ",", "0.751536", ",", "14.3501", ",", "8.21758", ",", 
        "4.73425", ",", "25.8749", ",", "1.28918", ",", "98.6062", ",", 
        "5.328"}], "}"}]}], ",", 
     RowBox[{"\"\<Rh3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.8785", ",", "0.764252", ",", "14.1259", ",", "7.84438", ",", 
        "3.32515", ",", "21.2487", ",", 
        RowBox[{"-", "6.1989"}], ",", 
        RowBox[{"-", "0.01036"}], ",", "11.8678"}], "}"}]}], ",", 
     RowBox[{"\"\<Rh4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.8545", ",", "0.760825", ",", "13.9806", ",", "7.62436", ",", 
        "2.53464", ",", "19.3317", ",", 
        RowBox[{"-", "5.6526"}], ",", 
        RowBox[{"-", "0.0102"}], ",", "11.2835"}], "}"}]}], ",", 
     RowBox[{"\"\<Pd\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.3319", ",", "0.698655", ",", "15.5017", ",", "7.98929", ",", 
        "5.29537", ",", "25.2052", ",", "0.605844", ",", "76.8986", ",", 
        "5.26593"}], "}"}]}], ",", 
     RowBox[{"\"\<Pd2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1701", ",", "0.696219", ",", "15.2096", ",", "7.55573", ",", 
        "4.32234", ",", "22.5057", ",", "0.000", ",", "0.000", ",", 
        "5.2916"}], "}"}]}], ",", 
     RowBox[{"\"\<Pd4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.2493", ",", "0.683839", ",", "14.79", ",", "7.14833", ",", 
        "2.89289", ",", "17.9144", ",", 
        RowBox[{"-", "7.9492"}], ",", "0.005127", ",", "13.0174"}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Ag\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.2808", ",", "0.6446", ",", "16.6885", ",", "7.4726", ",", "4.8045",
         ",", "24.6605", ",", "1.0463", ",", "99.8156", ",", "5.179"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ag1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1812", ",", "0.646179", ",", "15.9719", ",", "7.19123", ",", 
        "5.27475", ",", "21.7326", ",", "0.357534", ",", "66.1147", ",", 
        "5.21572"}], "}"}]}], ",", 
     RowBox[{"\"\<Ag2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1643", ",", "0.645643", ",", "16.2456", ",", "7.18544", ",", 
        "4.3709", ",", "21.4072", ",", "0.000", ",", "0.000", ",", 
        "5.21404"}], "}"}]}], ",", 
     RowBox[{"\"\<Cd\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.2214", ",", "0.5946", ",", "17.6444", ",", "6.9089", ",", "4.461", 
        ",", "24.7008", ",", "1.6029", ",", "87.4825", ",", "5.0694"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Cd2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1514", ",", "0.597922", ",", "17.2535", ",", "6.80639", ",", 
        "4.47128", ",", "20.2521", ",", "0.000", ",", "0.000", ",", 
        "5.11937"}], "}"}]}], ",", 
     RowBox[{"\"\<In\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1624", ",", "0.5476", ",", "18.5596", ",", "6.3776", ",", "4.2948",
         ",", "25.8499", ",", "2.0396", ",", "92.8029", ",", "4.9391"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<In3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1045", ",", "0.551522", ",", "18.1108", ",", "6.3247", ",", 
        "3.78897", ",", "17.3595", ",", "0.000", ",", "0.000", ",", 
        "4.99635"}], "}"}]}], ",", 
     RowBox[{"\"\<Sn\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1889", ",", "5.8303", ",", "19.1005", ",", "0.5031", ",", "4.4585",
         ",", "26.8909", ",", "2.4663", ",", "83.9571", ",", "4.7821"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sn2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.1094", ",", "0.5036", ",", "19.0548", ",", "5.8378", ",", "4.5648",
         ",", "23.3752", ",", "0.487", ",", "62.2061", ",", "4.7861"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sn4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.9333", ",", "5.764", ",", "19.7131", ",", "0.4655", ",", "3.4182", 
        ",", "14.0049", ",", "0.0193", ",", 
        RowBox[{"-", "0.7583"}], ",", "3.9182"}], "}"}]}], ",", 
     RowBox[{"\"\<Sb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.6418", ",", "5.3034", ",", "19.0455", ",", "0.4607", ",", "5.0371",
         ",", "27.9074", ",", "2.6827", ",", "75.2825", ",", "4.5909"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Sb3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "18.9755", ",", "0.467196", ",", "18.933", ",", "5.22126", ",", 
        "5.10789", ",", "19.5902", ",", "0.288753", ",", "55.5113", ",", 
        "4.69626"}], "}"}]}], ",", 
     RowBox[{"\"\<Sb5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.8685", ",", "5.44853", ",", "19.0302", ",", "0.467973", ",", 
        "2.41253", ",", "14.1259", ",", "0.000", ",", "0.000", ",", 
        "4.69263"}], "}"}]}], ",", 
     RowBox[{"\"\<Te\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "19.9644", ",", "4.81742", ",", "19.0138", ",", "0.420885", ",", 
        "6.14487", ",", "28.5284", ",", "2.5239", ",", "70.8403", ",", 
        "4.352"}], "}"}]}], ",", 
     RowBox[{"\"\<I\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.1472", ",", "4.347", ",", "18.9949", ",", "0.3814", ",", "7.5138", 
        ",", "27.766", ",", "2.2735", ",", "66.8776", ",", "4.0712"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<I1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.2332", ",", "4.3579", ",", "18.997", ",", "0.3815", ",", "7.8069", 
        ",", "29.5259", ",", "2.8868", ",", "84.9304", ",", "4.0714"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Xe\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.2933", ",", "3.9282", ",", "19.0298", ",", "0.344", ",", "8.9767", 
        ",", "26.4659", ",", "1.99", ",", "64.2658", ",", "3.7118"}], "}"}]}],
      ",", 
     RowBox[{"\"\<Cs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.3892", ",", "3.569", ",", "19.1062", ",", "0.3107", ",", "10.662", 
        ",", "24.3879", ",", "1.4953", ",", "213.904", ",", "3.3352"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Cs1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.3524", ",", "3.552", ",", "19.1278", ",", "0.3086", ",", "10.2821",
         ",", "23.7128", ",", "0.9615", ",", "59.4565", ",", "3.2791"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ba\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.3361", ",", "3.216", ",", "19.297", ",", "0.2756", ",", "10.888", 
        ",", "20.2073", ",", "2.6959", ",", "167.202", ",", "2.7731"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ba2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.1807", ",", "3.21367", ",", "19.1136", ",", "0.28331", ",", 
        "10.9054", ",", "20.0558", ",", "0.77634", ",", "51.746", ",", 
        "3.02902"}], "}"}]}], ",", 
     RowBox[{"\"\<La\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.578", ",", "2.94817", ",", "19.599", ",", "0.244475", ",", 
        "11.3727", ",", "18.7726", ",", "3.28719", ",", "133.124", ",", 
        "2.14678"}], "}"}]}], ",", 
     RowBox[{"\"\<La3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.2489", ",", "2.9207", ",", "19.3763", ",", "0.250698", ",", 
        "11.6323", ",", "17.8211", ",", "0.336048", ",", "54.9453", ",", 
        "2.4086"}], "}"}]}], ",", 
     RowBox[{"\"\<Ce\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.1671", ",", "2.81219", ",", "19.7695", ",", "0.226836", ",", 
        "11.8513", ",", "17.6083", ",", "3.33049", ",", "127.113", ",", 
        "1.86264"}], "}"}]}], ",", 
     RowBox[{"\"\<Ce3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.8036", ",", "2.77691", ",", "19.559", ",", "0.23154", ",", 
        "11.9369", ",", "16.5408", ",", "0.612376", ",", "43.1692", ",", 
        "2.09013"}], "}"}]}], ",", 
     RowBox[{"\"\<Ce4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.3235", ",", "2.65941", ",", "19.8186", ",", "0.21885", ",", 
        "12.1233", ",", "15.7992", ",", "0.144583", ",", "62.2355", ",", 
        "1.5918"}], "}"}]}], ",", 
     RowBox[{"\"\<Pr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "22.044", ",", "2.77393", ",", "19.6697", ",", "0.222087", ",", 
        "12.3856", ",", "16.7669", ",", "2.82428", ",", "143.644", ",", 
        "2.0583"}], "}"}]}], ",", 
     RowBox[{"\"\<Pr3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.3727", ",", "2.6452", ",", "19.7491", ",", "0.214299", ",", 
        "12.1329", ",", "15.323", ",", "0.97518", ",", "36.4065", ",", 
        "1.77132"}], "}"}]}], ",", 
     RowBox[{"\"\<Pr4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.9413", ",", "2.54467", ",", "20.0539", ",", "0.202481", ",", 
        "12.4668", ",", "14.8137", ",", "0.296689", ",", "45.4643", ",", 
        "1.24285"}], "}"}]}], ",", 
     RowBox[{"\"\<Nd\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "22.6845", ",", "2.66248", ",", "19.6847", ",", "0.210628", ",", 
        "12.774", ",", "15.885", ",", "2.85137", ",", "137.903", ",", 
        "1.98486"}], "}"}]}], ",", 
     RowBox[{"\"\<Nd3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.961", ",", "2.52722", ",", "19.9339", ",", "0.199237", ",", 
        "12.12", ",", "14.1783", ",", "1.51031", ",", "30.8717", ",", 
        "1.47588"}], "}"}]}], ",", 
     RowBox[{"\"\<Pm\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "23.3405", ",", "2.5627", ",", "19.6095", ",", "0.202088", ",", 
        "13.1235", ",", "15.1009", ",", "2.87516", ",", "132.721", ",", 
        "2.02876"}], "}"}]}], ",", 
     RowBox[{"\"\<Pm3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "22.5527", ",", "2.4174", ",", "20.1108", ",", "0.185769", ",", 
        "12.0671", ",", "13.1275", ",", "2.07492", ",", "27.4491", ",", 
        "1.19499"}], "}"}]}], ",", 
     RowBox[{"\"\<Sm\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "24.0042", ",", "2.47274", ",", "19.4258", ",", "0.196451", ",", 
        "13.4396", ",", "14.3996", ",", "2.89604", ",", "128.007", ",", 
        "2.20963"}], "}"}]}], ",", 
     RowBox[{"\"\<Sm3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "23.1504", ",", "2.31641", ",", "20.2599", ",", "0.174081", ",", 
        "11.9202", ",", "12.1571", ",", "2.71488", ",", "24.8242", ",", 
        "0.954586"}], "}"}]}], ",", 
     RowBox[{"\"\<Eu\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "24.6274", ",", "2.3879", ",", "19.0886", ",", "0.1942", ",", 
        "13.7603", ",", "13.7546", ",", "2.9227", ",", "123.174", ",", 
        "2.5745"}], "}"}]}], ",", 
     RowBox[{"\"\<Eu2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "24.0063", ",", "2.27783", ",", "19.9504", ",", "0.17353", ",", 
        "11.8034", ",", "11.6096", ",", "3.87243", ",", "26.5156", ",", 
        "1.36389"}], "}"}]}], ",", 
     RowBox[{"\"\<Eu3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "23.7497", ",", "2.22258", ",", "20.3745", ",", "0.16394", ",", 
        "11.8509", ",", "11.311", ",", "3.26503", ",", "22.9966", ",", 
        "0.759344"}], "}"}]}], ",", 
     RowBox[{"\"\<Gd\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "25.0709", ",", "2.25341", ",", "19.0798", ",", "0.181951", ",", 
        "13.8518", ",", "12.9331", ",", "3.54545", ",", "101.398", ",", 
        "2.4196"}], "}"}]}], ",", 
     RowBox[{"\"\<Gd3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "24.3466", ",", "2.13553", ",", "20.4208", ",", "0.155525", ",", 
        "11.8708", ",", "10.5782", ",", "3.7149", ",", "21.7029", ",", 
        "0.645089"}], "}"}]}], ",", 
     RowBox[{"\"\<Tb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "25.8976", ",", "2.24256", ",", "18.2185", ",", "0.196143", ",", 
        "14.3167", ",", "12.6648", ",", "2.95354", ",", "115.362", ",", 
        "3.58324"}], "}"}]}], ",", 
     RowBox[{"\"\<Tb3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "24.9559", ",", "2.05601", ",", "20.3271", ",", "0.149525", ",", 
        "12.2471", ",", "10.0499", ",", "3.773", ",", "21.2773", ",", 
        "0.691967"}], "}"}]}], ",", 
     RowBox[{"\"\<Dy\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "26.507", ",", "2.1802", ",", "17.6383", ",", "0.202172", ",", 
        "14.5596", ",", "12.1899", ",", "2.96577", ",", "111.874", ",", 
        "4.29728"}], "}"}]}], ",", 
     RowBox[{"\"\<Dy3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "25.5395", ",", "1.9804", ",", "20.2861", ",", "0.143384", ",", 
        "11.9812", ",", "9.34972", ",", "4.50073", ",", "19.581", ",", 
        "0.68969"}], "}"}]}], ",", 
     RowBox[{"\"\<Ho\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "26.9049", ",", "2.07051", ",", "17.294", ",", "0.19794", ",", 
        "14.5583", ",", "11.4407", ",", "3.63837", ",", "92.6566", ",", 
        "4.56796"}], "}"}]}], ",", 
     RowBox[{"\"\<Ho3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "26.1296", ",", "1.91072", ",", "20.0994", ",", "0.139358", ",", 
        "11.9788", ",", "8.80018", ",", "4.93676", ",", "18.5908", ",", 
        "0.852795"}], "}"}]}], ",", 
     RowBox[{"\"\<Er\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.6563", ",", "2.07356", ",", "16.4285", ",", "0.223545", ",", 
        "14.9779", ",", "11.3604", ",", "2.98233", ",", "105.703", ",", 
        "5.92046"}], "}"}]}], ",", 
     RowBox[{"\"\<Er3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "26.722", ",", "1.84659", ",", "19.7748", ",", "0.13729", ",", 
        "12.1506", ",", "8.36225", ",", "5.17379", ",", "17.8974", ",", 
        "1.17613"}], "}"}]}], ",", 
     RowBox[{"\"\<Tm\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.1819", ",", "2.02859", ",", "15.8851", ",", "0.238849", ",", 
        "15.1542", ",", "10.9975", ",", "2.98706", ",", "102.961", ",", 
        "6.75621"}], "}"}]}], ",", 
     RowBox[{"\"\<Tm3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.3083", ",", "1.78711", ",", "19.332", ",", "0.136974", ",", 
        "12.3339", ",", "7.96778", ",", "5.38348", ",", "17.2922", ",", 
        "1.63929"}], "}"}]}], ",", 
     RowBox[{"\"\<Yb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.6641", ",", "1.9889", ",", "15.4345", ",", "0.257119", ",", 
        "15.3087", ",", "10.6647", ",", "2.98963", ",", "100.417", ",", 
        "7.56672"}], "}"}]}], ",", 
     RowBox[{"\"\<Yb2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.1209", ",", "1.78503", ",", "17.6817", ",", "0.15997", ",", 
        "13.3335", ",", "8.18304", ",", "5.14657", ",", "20.39", ",", 
        "3.70983"}], "}"}]}], ",", 
     RowBox[{"\"\<Yb3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.8917", ",", "1.73272", ",", "18.7614", ",", "0.13879", ",", 
        "12.6072", ",", "7.64412", ",", "5.47647", ",", "16.8153", ",", 
        "2.26001"}], "}"}]}], ",", 
     RowBox[{"\"\<Lu\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.9476", ",", "1.90182", ",", "15.2208", ",", "9.98519", ",", "15.1",
         ",", "0.261033", ",", "3.71601", ",", "84.3298", ",", "7.97628"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Lu3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.4628", ",", "1.68216", ",", "18.121", ",", "0.142292", ",", 
        "12.8429", ",", "7.33727", ",", "5.59415", ",", "16.3535", ",", 
        "2.97573"}], "}"}]}], ",", 
     RowBox[{"\"\<Hf\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.144", ",", "1.83262", ",", "15.1726", ",", "9.5999", ",", 
        "14.7586", ",", "0.275116", ",", "4.30013", ",", "72.029", ",", 
        "8.58154"}], "}"}]}], ",", 
     RowBox[{"\"\<Hf4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.8131", ",", "1.59136", ",", "18.4601", ",", "0.128903", ",", 
        "12.7285", ",", "6.76232", ",", "5.59927", ",", "14.0366", ",", 
        "2.39699"}], "}"}]}], ",", 
     RowBox[{"\"\<Ta\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.2024", ",", "1.77333", ",", "15.2293", ",", "9.37046", ",", 
        "14.5135", ",", "0.295977", ",", "4.76492", ",", "63.3644", ",", 
        "9.24354"}], "}"}]}], ",", 
     RowBox[{"\"\<Ta5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.1587", ",", "1.50711", ",", "18.8407", ",", "0.116741", ",", 
        "12.8268", ",", "6.31524", ",", "5.38695", ",", "12.4244", ",", 
        "1.78555"}], "}"}]}], ",", 
     RowBox[{"\"\<W\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.0818", ",", "1.72029", ",", "15.43", ",", "9.2259", ",", "14.4327",
         ",", "0.321703", ",", "5.11982", ",", "57.056", ",", "9.8875"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<W6\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.4936", ",", "1.42755", ",", "19.3763", ",", "0.104621", ",", 
        "13.0544", ",", "5.93667", ",", "5.06412", ",", "11.1972", ",", 
        "1.01074"}], "}"}]}], ",", 
     RowBox[{"\"\<Re\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.7621", ",", "1.67191", ",", "15.7189", ",", "9.09227", ",", 
        "14.5564", ",", "0.3505", ",", "5.44174", ",", "52.0861", ",", 
        "10.472"}], "}"}]}], ",", 
     RowBox[{"\"\<Os\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.1894", ",", "1.62903", ",", "16.155", ",", "8.97948", ",", 
        "14.9305", ",", "0.382661", ",", "5.67589", ",", "48.1647", ",", 
        "11.0005"}], "}"}]}], ",", 
     RowBox[{"\"\<Os4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.419", ",", "1.37113", ",", "15.2637", ",", "6.84706", ",", 
        "14.7458", ",", "0.165191", ",", "5.06795", ",", "18.003", ",", 
        "6.49804"}], "}"}]}], ",", 
     RowBox[{"\"\<Ir\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.3049", ",", "1.59279", ",", "16.7296", ",", "8.86553", ",", 
        "15.6115", ",", "0.417916", ",", "5.83377", ",", "45.0011", ",", 
        "11.4722"}], "}"}]}], ",", 
     RowBox[{"\"\<Ir3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.4156", ",", "1.34323", ",", "15.862", ",", "7.10909", ",", 
        "13.6145", ",", "0.204633", ",", "5.82008", ",", "20.3254", ",", 
        "8.27903"}], "}"}]}], ",", 
     RowBox[{"\"\<Ir4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.7058", ",", "1.30923", ",", "15.5512", ",", "6.71983", ",", 
        "14.2326", ",", "0.167252", ",", "5.53672", ",", "17.4911", ",", 
        "6.96824"}], "}"}]}], ",", 
     RowBox[{"\"\<Pt\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.0059", ",", "1.51293", ",", "17.7639", ",", "8.81174", ",", 
        "15.7131", ",", "0.424593", ",", "5.7837", ",", "38.6103", ",", 
        "11.6883"}], "}"}]}], ",", 
     RowBox[{"\"\<Pt2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.8429", ",", "1.32927", ",", "16.7224", ",", "7.38979", ",", 
        "13.2153", ",", "0.263297", ",", "6.35234", ",", "22.9426", ",", 
        "9.85329"}], "}"}]}], ",", 
     RowBox[{"\"\<Pt4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.9612", ",", "1.24813", ",", "15.9829", ",", "6.60834", ",", 
        "13.7348", ",", "0.16864", ",", "5.92034", ",", "16.9392", ",", 
        "7.39534"}], "}"}]}], ",", 
     RowBox[{"\"\<Au\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "16.8819", ",", "0.4611", ",", "18.5913", ",", "8.6216", ",", 
        "25.5582", ",", "1.4826", ",", "5.86", ",", "36.3956", ",", 
        "12.0658"}], "}"}]}], ",", 
     RowBox[{"\"\<Au1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "28.0109", ",", "1.35321", ",", "17.8204", ",", "7.7395", ",", 
        "14.3359", ",", "0.356752", ",", "6.58077", ",", "26.4043", ",", 
        "11.2299"}], "}"}]}], ",", 
     RowBox[{"\"\<Au3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.6886", ",", "1.2199", ",", "16.9029", ",", "6.82872", ",", 
        "12.7801", ",", "0.212867", ",", "6.52354", ",", "18.659", ",", 
        "9.0968"}], "}"}]}], ",", 
     RowBox[{"\"\<Hg\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "20.6809", ",", "0.545", ",", "19.0417", ",", "8.4484", ",", "21.6575",
         ",", "1.5729", ",", "5.9676", ",", "38.3246", ",", "12.6089"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Hg1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "25.0853", ",", "1.39507", ",", "18.4973", ",", "7.65105", ",", 
        "16.8883", ",", "0.443378", ",", "6.48216", ",", "28.2262", ",", 
        "12.0205"}], "}"}]}], ",", 
     RowBox[{"\"\<Hg2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "29.5641", ",", "1.21152", ",", "18.06", ",", "7.05639", ",", 
        "12.8374", ",", "0.284738", ",", "6.89912", ",", "20.7482", ",", 
        "10.6268"}], "}"}]}], ",", 
     RowBox[{"\"\<Tl\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "27.5446", ",", "0.65515", ",", "19.1584", ",", "8.70751", ",", 
        "15.538", ",", "1.96347", ",", "5.52593", ",", "45.8149", ",", 
        "13.1746"}], "}"}]}], ",", 
     RowBox[{"\"\<Tl1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.3985", ",", "1.4711", ",", "20.4723", ",", "0.517394", ",", 
        "18.7478", ",", "7.43463", ",", "6.82847", ",", "28.8482", ",", 
        "12.5258"}], "}"}]}], ",", 
     RowBox[{"\"\<Tl3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "30.8695", ",", "1.1008", ",", "18.3481", ",", "6.53852", ",", 
        "11.9328", ",", "0.219074", ",", "7.00574", ",", "17.2114", ",", 
        "9.8027"}], "}"}]}], ",", 
     RowBox[{"\"\<Pb\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "31.0617", ",", "0.6902", ",", "13.0637", ",", "2.3576", ",", "18.442",
         ",", "8.618", ",", "5.9696", ",", "47.2579", ",", "13.4118"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Pb2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.7886", ",", "1.3366", ",", "19.5682", ",", "0.488383", ",", 
        "19.1406", ",", "6.7727", ",", "7.01107", ",", "23.8132", ",", 
        "12.4734"}], "}"}]}], ",", 
     RowBox[{"\"\<Pb4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "32.1244", ",", "1.00566", ",", "18.8003", ",", "6.10926", ",", 
        "12.0175", ",", "0.147041", ",", "6.96886", ",", "14.714", ",", 
        "8.08428"}], "}"}]}], ",", 
     RowBox[{"\"\<Bi\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "33.3689", ",", "0.704", ",", "12.951", ",", "2.9238", ",", "16.5877", 
        ",", "8.7937", ",", "6.4692", ",", "48.0093", ",", "13.5782"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Bi3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "21.8053", ",", "1.2356", ",", "19.5026", ",", "6.24149", ",", 
        "19.1053", ",", "0.469999", ",", "7.10295", ",", "20.3185", ",", 
        "12.4711"}], "}"}]}], ",", 
     RowBox[{"\"\<Bi5\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "33.5364", ",", "0.91654", ",", "25.0946", ",", "0.39042", ",", 
        "19.2497", ",", "5.71414", ",", "6.91555", ",", "12.8285", ",", 
        RowBox[{"-", "6.7994"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Po\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "34.6726", ",", "0.700999", ",", "15.4733", ",", "3.55078", ",", 
        "13.1138", ",", "9.55642", ",", "7.02588", ",", "47.0045", ",", 
        "13.677"}], "}"}]}], ",", 
     RowBox[{"\"\<At\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.3163", ",", "0.68587", ",", "19.0211", ",", "3.97458", ",", 
        "9.49887", ",", "11.3824", ",", "7.42518", ",", "45.4715", ",", 
        "13.7108"}], "}"}]}], ",", 
     RowBox[{"\"\<Rn\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.5631", ",", "0.6631", ",", "21.2816", ",", "4.0691", ",", "8.0037",
         ",", "14.0422", ",", "7.4433", ",", "44.2473", ",", "13.6905"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Fr\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.9299", ",", "0.646453", ",", "23.0547", ",", "4.17619", ",", 
        "12.1439", ",", "23.1052", ",", "2.11253", ",", "150.645", ",", 
        "13.7247"}], "}"}]}], ",", 
     RowBox[{"\"\<Ra\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.763", ",", "0.616341", ",", "22.9064", ",", "3.87135", ",", 
        "12.4739", ",", "19.9887", ",", "3.21097", ",", "142.325", ",", 
        "13.6211"}], "}"}]}], ",", 
     RowBox[{"\"\<Ra2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.215", ",", "0.604909", ",", "21.67", ",", "3.5767", ",", "7.91342",
         ",", "12.601", ",", "7.65078", ",", "29.8436", ",", "13.5431"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<Ac\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.6597", ",", "0.589092", ",", "23.1032", ",", "3.65155", ",", 
        "12.5977", ",", "18.599", ",", "4.08655", ",", "117.02", ",", 
        "13.5266"}], "}"}]}], ",", 
     RowBox[{"\"\<Ac3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.1736", ",", "0.579689", ",", "22.1112", ",", "3.41437", ",", 
        "8.19216", ",", "12.9187", ",", "7.05545", ",", "25.9443", ",", 
        "13.4637"}], "}"}]}], ",", 
     RowBox[{"\"\<Th\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.5645", ",", "0.563359", ",", "23.4219", ",", "3.46204", ",", 
        "12.7473", ",", "17.8309", ",", "4.80703", ",", "99.1722", ",", 
        "13.4314"}], "}"}]}], ",", 
     RowBox[{"\"\<Th4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.1007", ",", "0.555054", ",", "22.4418", ",", "3.24498", ",", 
        "9.78554", ",", "13.4661", ",", "5.29444", ",", "23.9533", ",", 
        "13.376"}], "}"}]}], ",", 
     RowBox[{"\"\<Pa\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.8847", ",", "0.547751", ",", "23.2948", ",", "3.41519", ",", 
        "14.1891", ",", "16.9235", ",", "4.17287", ",", "105.251", ",", 
        "13.4287"}], "}"}]}], ",", 
     RowBox[{"\"\<U\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.0228", ",", "0.5293", ",", "23.4128", ",", "3.3253", ",", 
        "14.9491", ",", "16.0927", ",", "4.188", ",", "100.613", ",", 
        "13.3966"}], "}"}]}], ",", 
     RowBox[{"\"\<U3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.5747", ",", "0.52048", ",", "22.5259", ",", "3.12293", ",", 
        "12.2165", ",", "12.7148", ",", "5.37073", ",", "26.3394", ",", 
        "13.3092"}], "}"}]}], ",", 
     RowBox[{"\"\<U4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.3715", ",", "0.516598", ",", "22.5326", ",", "3.05053", ",", 
        "12.0291", ",", "12.5723", ",", "4.7984", ",", "23.4582", ",", 
        "13.2671"}], "}"}]}], ",", 
     RowBox[{"\"\<U6\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "34.8509", ",", "0.507079", ",", "22.7584", ",", "2.8903", ",", 
        "14.0099", ",", "13.1767", ",", "1.21457", ",", "25.2017", ",", 
        "13.1665"}], "}"}]}], ",", 
     RowBox[{"\"\<Np\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.1874", ",", "0.511929", ",", "23.5964", ",", "3.25396", ",", 
        "15.6402", ",", "15.3622", ",", "4.1855", ",", "97.4908", ",", 
        "13.3573"}], "}"}]}], ",", 
     RowBox[{"\"\<Np3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.7074", ",", "0.502322", ",", "22.613", ",", "3.03807", ",", 
        "12.9898", ",", "12.1449", ",", "5.43227", ",", "25.4928", ",", 
        "13.2544"}], "}"}]}], ",", 
     RowBox[{"\"\<Np4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.5103", ",", "0.498626", ",", "22.5787", ",", "2.96627", ",", 
        "12.7766", ",", "11.9484", ",", "4.92159", ",", "22.7502", ",", 
        "13.2116"}], "}"}]}], ",", 
     RowBox[{"\"\<Np6\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.0136", ",", "0.48981", ",", "22.7286", ",", "2.81099", ",", 
        "14.3884", ",", "12.33", ",", "1.75669", ",", "22.6581", ",", 
        "13.113"}], "}"}]}], ",", 
     RowBox[{"\"\<Pu\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.5254", ",", "0.499384", ",", "23.8083", ",", "3.26371", ",", 
        "16.7707", ",", "14.9455", ",", "3.47947", ",", "105.98", ",", 
        "13.3812"}], "}"}]}], ",", 
     RowBox[{"\"\<Pu3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.84", ",", "0.484938", ",", "22.7169", ",", "2.96118", ",", 
        "13.5807", ",", "11.5331", ",", "5.66016", ",", "24.3992", ",", 
        "13.1991"}], "}"}]}], ",", 
     RowBox[{"\"\<Pu4\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.6493", ",", "0.481422", ",", "22.646", ",", "2.8902", ",", 
        "13.3595", ",", "11.316", ",", "5.18831", ",", "21.8301", ",", 
        "13.1555"}], "}"}]}], ",", 
     RowBox[{"\"\<Pu6\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "35.1736", ",", "0.473204", ",", "22.7181", ",", "2.73848", ",", 
        "14.7635", ",", "11.553", ",", "2.28678", ",", "20.9303", ",", 
        "13.0582"}], "}"}]}], ",", 
     RowBox[{"\"\<Am\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.6706", ",", "0.483629", ",", "24.0992", ",", "3.20647", ",", 
        "17.3415", ",", "14.3136", ",", "3.49331", ",", "102.273", ",", 
        "13.3592"}], "}"}]}], ",", 
     RowBox[{"\"\<Cm\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.6488", ",", "0.465154", ",", "24.4096", ",", "3.08997", ",", 
        "17.399", ",", "13.4346", ",", "4.21665", ",", "88.4834", ",", 
        "13.2887"}], "}"}]}], ",", 
     RowBox[{"\"\<Bk\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.7881", ",", "0.451018", ",", "24.7736", ",", "3.04619", ",", 
        "17.8919", ",", "12.8946", ",", "4.23284", ",", "86.003", ",", 
        "13.2754"}], "}"}]}], ",", 
     RowBox[{"\"\<Cf\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "36.9185", ",", "0.437533", ",", "25.1995", ",", "3.00775", ",", 
        "18.3317", ",", "12.4044", ",", "4.24391", ",", "83.7881", ",", 
        "13.2674"}], "}"}]}]}], "|>"}]}], ";"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"c200754f-e783-4a3c-a23e-3b9224a70754"],

Cell["", "Text",ExpressionUUID->"23b347c5-89ad-4704-b448-63f0e20584b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["X-Ray Form Factor", "Subsection",ExpressionUUID->"ae6aebbc-605b-42f7-97e2-2839d0ae1633"],

Cell[TextData[{
 "The length ",
 Cell[BoxData[
  FormBox["gNM", TraditionalForm]],ExpressionUUID->
  "37fdf41f-999f-4c36-aed3-cc4eab9173de"],
 " of the diffraction vector ",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is expected in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "0f79a948-2a9d-41c2-9b9e-369f74e5b509"],
 "."
}], "Text",ExpressionUUID->"9755afdb-e98d-4208-abfe-f359bac18b11"],

Cell[TextData[{
 "Call rXFF like this: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"rXFF", "[", " ", 
    RowBox[{
     RowBox[{"lXFFData", "[", "\<\"Cu\"\>", "]"}], ",", 
     RowBox[{"||", 
      StyleBox["g",
       FontWeight->"Bold"], 
      StyleBox["||",
       FontWeight->"Plain"]}]}], 
    StyleBox[" ",
     FontWeight->"Plain"], 
    StyleBox["]",
     FontWeight->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "2073efd1-9774-4834-9c2f-a62f267dda26"],
 "."
}], "Text",ExpressionUUID->"0a4d8d7a-78be-4b28-be7e-11e369127080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rXFF", "[", 
   RowBox[{"lc9_", ",", "gNM_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ff", ",", "gAng", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gAng", "=", 
      FractionBox["gNM", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "4"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ff", "+=", 
        RowBox[{
         RowBox[{"lc9", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"2", "i"}], "+", "1"}], "\[RightDoubleBracket]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"lc9", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"2", "i"}], "+", "2"}], "\[RightDoubleBracket]"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["gAng", 
              RowBox[{"4", "\[Pi]"}]], ")"}], "2"]}], "]"}]}]}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ff", "+=", 
      RowBox[{"lc9", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ff", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"015fb7a8-7cbd-44f2-873a-a798068ced21"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",ExpressionUUID->"a5c73508-fc8f-4480-b6e1-3770f16e8751"],

Cell[TextData[{
 "The following shows the form factors for Cu and Al, plotted as a function \
of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "=", 
    RowBox[{"||", 
     StyleBox["q",
      FontWeight->"Bold"], "||"}]}], TraditionalForm]],ExpressionUUID->
  "27380159-2f44-4001-a8b7-e0825d24b3dd"],
 ", reciprocal plane spacing in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "e2878fcb-f15a-41e9-ab28-429b4c419671"],
 ". ",
 StyleBox["q ",
  FontSlant->"Italic"],
 "represents the diffraction angle: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Tan", "[", 
     RowBox[{"2", "\[Theta]"}], "]"}], "=", 
    FractionBox["q", 
     SubscriptBox["k", "0"]]}], TraditionalForm]],ExpressionUUID->
  "4441fa1d-a80d-46d2-846a-75d00614588b"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "0"], TraditionalForm]],ExpressionUUID->
  "8f0bee51-980f-4f04-b510-e59e2dda52e0"],
 " is the wave vector of the incident beam ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"||", 
      SubscriptBox["k", "0"], "||"}], "=", 
     FractionBox["1", "\[Lambda]"]}]}], TraditionalForm]],ExpressionUUID->
  "6c365185-627f-4e84-93ad-b7f74fcb8c91"],
 "). Al is lighter than Cu, but a larger atom. Therefore, it diffracts less \
effectively than Cu, but the efficacy decays slower with increasing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"q", "\[Congruent]"}], "||", 
    StyleBox["q",
     FontWeight->"Bold"], 
    StyleBox["||",
     FontWeight->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "0c42c08b-f439-4814-8ca1-5327fb4fd009"],
 " (meaning decreasing reciprocal plane spacing or increasing diffraction \
angle 2\[Theta]). A typical lattice plane spacing of 0.2 nm, typical in a \
crystal, would sample the functions at 5 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "0669998d-7df0-47a4-89d7-d5da3d3da48b"],
 "(vertical dashed line)."
}], "Text",ExpressionUUID->"c18fc1ae-7d6b-4a87-a357-dc3596207e64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mark", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "30"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineStyle", "=", 
   RowBox[{"{", 
    RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rXFF", "[", 
      RowBox[{
       RowBox[{"lXFFData", "[", "\"\<Cu\>\"", "]"}], ",", "q"}], "]"}], ",", 
     RowBox[{"rXFF", "[", 
      RowBox[{
       RowBox[{"lXFFData", "[", "\"\<Al\>\"", "]"}], ",", "q"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "100"}], "}"}], ",", 
   RowBox[{"AxesOrigin", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
   RowBox[{"Epilog", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", "lineStyle", "]"}], ",", "mark"}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"133cb0ef-08dc-457e-88c1-387808df2029"]
}, Closed]],

Cell[CellGroupData[{

Cell["Form Intensity Factor for Cubic Systems", "Subsubsection",ExpressionUUID->"3fc13f38-36c8-4f50-a127-36430b10bcf2"],

Cell[TextData[{
 "With a given set of",
 StyleBox[" hkl",
  FontSlant->"Italic"],
 " planes",
 StyleBox[", ",
  FontSlant->"Italic"],
 "the atom form factor will only be sampled at a small number of discrete \
diffraction vectors ",
 StyleBox["q. ",
  FontSlant->"Italic"],
 "The following function takes a plane ",
 StyleBox["hkl",
  FontSlant->"Italic"],
 " and returns a the corresponding diffraction ",
 StyleBox["intensity",
  FontSlant->"Italic"],
 " relative to the maximum, which occurs at 000. The intensity is obtained as \
the square of the amplitude. ",
 StyleBox["q",
  FontSlant->"Italic"],
 " is calculated from the equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "=", 
    FractionBox[
     SubscriptBox["a", "0"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["h", "2"], "+", 
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["l", "2"]}]]]}], TraditionalForm]],ExpressionUUID->
  "57650e12-a18e-4d7e-b828-5d6abc52d28a"],
 ". This relation applies only to ",
 StyleBox["cubic",
  FontSlant->"Italic"],
 " / Cartesian systems!"
}], "Text",ExpressionUUID->"58246825-e3a2-48af-80ae-46c323de4481"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rFFCubic", "[", "lg_List", "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox[
     RowBox[{" ", 
      FormBox[
       RowBox[{"rXFF", "[", 
        RowBox[{
         RowBox[{"lXFFData", "[", "\"\<Cu\>\"", "]"}], ",", 
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"lg", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"lg", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"lg", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "2"]}]], "a0"]}], "]"}],
       TraditionalForm]}], 
     FormBox[
      RowBox[{"xff", "[", 
       RowBox[{
        RowBox[{"lXFFData", "[", "\"\<Cu\>\"", "]"}], ",", "0"}], "]"}],
      TraditionalForm]], ")"}], "2"]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"d7861227-44be-4fbc-94c7-ac8d7b0bd553"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Debye\[Dash]Waller Factors", "Section",ExpressionUUID->"2c1e2ea3-b4aa-47b2-b8dd-a5c10a726f60"],

Cell[TextData[{
 "Atoms in crystals are not at rest. They oscillate about equilibrium \
positions. The frequency and amplitude of the oscillation depends on the mass \
",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "f65f12f4-4277-43fe-804c-ce9f0ecf0aaa"],
 " of the atom, the bonding forces from its environment, and the absolute \
temperature ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "53f1c580-0cd4-47d9-8978-a9bb7999a99c"],
 ". Generally, the oscillation magnitude and frequency will be anisotropic, \
i.e. vary with crystallographic direction. "
}], "Text",ExpressionUUID->"f438d87d-6d44-455a-89f1-b66328160b42"],

Cell["\<\
Compared to a hypothetical diffraction pattern obtained with atoms at rest, \
the disorder that an X-ray photon gets to see (as a \
\[OpenCurlyDoubleQuote]frozen phonon\[CloseCurlyDoubleQuote] snapshot) owing \
to the oscillation of atoms in real crystals leads to an attenuation of \
diffracted-beam intensities and a diffuse background. The effect is more \
pronounced for larger diffraction angles / smaller plane spacings because the \
attenuation of a diffracted beam with increasing deviation (\
\[OpenCurlyDoubleQuote]excitation error\[CloseCurlyDoubleQuote]) from the \
diffraction condition is more pronounced the  higher the order of the \
diffracted beam. The higher the order, i.e. the smaller the plane spacing, \
the smaller will be the \[OpenCurlyDoubleQuote]allowable\
\[CloseCurlyDoubleQuote] deviation from the exact diffraction (Bragg) \
condition.\
\>", "Text",ExpressionUUID->"4db28e52-0a68-48e5-bd57-6424f0501eb5"],

Cell[TextData[{
 "The amplitude (not: ",
 ButtonBox["intensity",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://bit.ly/3XJswXt"], None},
  ButtonNote->"https://bit.ly/3XJswXt"],
 ") of the diffracted beam is weakened by a factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"-", "M"}], "]"}], "<", "1"}], TraditionalForm]],ExpressionUUID->
  "d0439233-e42a-410d-9430-8c8e26b06527"],
 ", known as the ",
 StyleBox["Debye\[Dash]Waller Factor",
  FontSlant->"Italic"],
 ". ",
 ButtonBox["Generally",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://bit.ly/3XJswXt"], None},
  ButtonNote->"https://bit.ly/3XJswXt"],
 ", this factor can be generally introduced by replacing the atom-form factor \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "[", "q", "]"}], TraditionalForm]],ExpressionUUID->
  "e269bf84-4e60-497e-b585-e20e0a3c0ed1"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["f", "0"], "[", "q", "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", "M"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "cf59fc4a-e41f-4310-bbab-bcb757eebbee"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["f", "0"], "[", "q", "]"}], TraditionalForm]],
  ExpressionUUID->"28b3f201-0594-4855-9880-8fb03f2502df"],
 " is the atom-form factor absent vibration. The attenuation factor is known \
as the Debye\[Dash]Waller factor. It has the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Exp", "[", 
    RowBox[{"-", "M"}], "]"}], TraditionalForm]],ExpressionUUID->
  "c20e8e1f-359f-4654-bccd-f2fa10fcace7"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]", " ", 
         StyleBox["g",
          FontWeight->"Plain"]}], ")"}], "2"], 
      RowBox[{"\[LeftAngleBracket]", 
       SuperscriptBox[
        SubscriptBox["u", 
         StyleBox["g",
          FontWeight->"Bold"]], "2"], "\[RightAngleBracket]"}]}], "=", 
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Pi]", "2"], "(", 
         RowBox[{"2", 
          FractionBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Lambda]"]}], ")"}], "2"], 
       RowBox[{"\[LeftAngleBracket]", 
        SuperscriptBox[
         SubscriptBox["u", 
          StyleBox["g",
           FontWeight->"Bold"]], "2"], "\[RightAngleBracket]"}]}], "=", 
      RowBox[{":", 
       RowBox[{"B", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Lambda]"], ")"}], 
         "2"]}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6662afba-ba09-4b7b-9d1c-6a9a9440bb40"],
 ". (Your ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", " ", "\[Pi]"}], TraditionalForm]],ExpressionUUID->
  "1fbf5f4a-173f-4b18-b90f-e5d50f8044da"],
 "-s may vary. The form after the first equation sign is based on defining \
the wave number of the primary wave as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "0"], "=", 
    FractionBox["1", "\[Lambda]"]}], TraditionalForm]],ExpressionUUID->
  "32388db6-5379-4dce-8ae1-3470406a022c"],
 ", not ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"2", " ", "\[Pi]"}], "\[Lambda]"], TraditionalForm]],
  ExpressionUUID->"884fe204-dd53-4128-bcb2-3251cb477899"],
 ". The former is popular in crystallography, the latter is popular in \
solid-state physics.) ",
 Cell[BoxData[
  FormBox["g", TraditionalForm]],ExpressionUUID->
  "5c44a5c7-5d08-4512-afc7-522c1af8ea25"],
 " is the norm (with dimension of reciprocal length) of the diffraction \
vector ",
 Cell[BoxData[
  FormBox[
   StyleBox["g",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "2120a305-1946-4f15-964d-3a551c9698e1"],
 ". ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    SuperscriptBox[
     SubscriptBox["u", 
      StyleBox["g",
       FontWeight->"Bold"]], "2"], "\[RightAngleBracket]"}], 
   TraditionalForm]],ExpressionUUID->"41ca4117-6184-4999-b76b-afa0e9f4bd21"],
 " is the mean square of the displacement ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", 
    StyleBox["g",
     FontWeight->"Bold"]], TraditionalForm]],ExpressionUUID->
  "f4273a21-6175-4e3d-a9d1-fd352d319c8d"],
 " in the direction of ",
 Cell[BoxData[
  FormBox[
   StyleBox["g",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "b92474d1-a95e-41b0-b538-a92d047dc3b5"],
 ". Under the simplifying assumption of isotropic oscillation, only ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", "3"], TraditionalForm]],ExpressionUUID->
  "a91ce80a-6bdb-46bc-8e1b-40a2bd352e05"],
 " of the oscillation amplitude is (on the average) out of plane. Then, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{
     FractionBox["2", "3"], 
     SuperscriptBox["\[Pi]", "2"], 
     SuperscriptBox["g", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox["u", "2"], "\[RightAngleBracket]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"0eb3abfc-d264-4415-8aa8-df7af53b822c"],
 ". ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "8c7b8683-ba92-4b75-9136-aaf9b4ef4e6c"],
 " is known as ",
 StyleBox["temperature factor",
  FontSlant->"Italic"],
 " or ",
 StyleBox["Debye Parameter",
  FontSlant->"Italic"],
 " and \[Dash] sometimes \[Dash] get this \[Dash] also as the \
Debye\[Dash]Waller Factor."
}], "Text",ExpressionUUID->"fa513b15-864b-4453-8d6e-634f24ad7c27"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]],ExpressionUUID->
  "3b570eee-7dbb-495b-9dd9-b5da2bb6c5a9"],
 " depends not only on the mass, but also on the bonding environment of the \
atom, there is no general, unique way to assign Debye\[Dash]Waller factors to \
each atom species.  "
}], "Text",ExpressionUUID->"4d8eec40-5ceb-4c74-9a57-ea56a335fe6b"],

Cell[TextData[{
 "A further simplifying assumption is that the oscillation is ",
 StyleBox["harmonic",
  FontSlant->"Italic"],
 ", meaning that there is a linear force law and the potential energy of the \
oscillating atom depends in a parabolic way on the distance from the \
oscillation center. (If this were actually true, there would be no thermal \
expansion.) At low temperature, i.e. when ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "<", 
    SubscriptBox["\[Theta]", 
     StyleBox["D",
      FontSlant->"Plain"]]}], TraditionalForm]],ExpressionUUID->
  "1e77f27d-cdad-437f-8257-a1cf83c66fc5"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    StyleBox["D",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "58e15a93-18fa-453b-a491-1e1edfbae614"],
 " is the Debye temperature, part of the atom oscillators may be frozen. At \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ">", " ", 
    SubscriptBox["\[Theta]", 
     StyleBox["D",
      FontSlant->"Plain"]]}], TraditionalForm]],ExpressionUUID->
  "01022eb9-ba99-4411-b4e4-b44ac0a81e44"],
 ", all atoms oscillate. "
}], "Text",ExpressionUUID->"235ed50b-2c47-4a41-ad90-36dbeecc8128"],

Cell[TextData[{
 "The total energy ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]],ExpressionUUID->
  "a036a7b9-a12b-404a-846a-0eafc36abe5a"],
 " of a harmonic oscillator equals the maximum potential energy, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "=", 
    RowBox[{
     FractionBox["D", "2"], " ", 
     SuperscriptBox[
      SubscriptBox["u", "0"], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "448c2ae7-e8a5-4b1a-b44d-b9699e6b97bd"],
 ", where ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]],ExpressionUUID->
  "a6be1dd9-9425-4b83-8977-82b5866ce1a1"],
 " is the spring constant (bonding force). By the law of equi-partition, the \
total energy also equals ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["3", "2"], 
    StyleBox[
     SubscriptBox["k", "B"],
     FontSlant->"Italic"], "T"}], TraditionalForm]],ExpressionUUID->
  "98a282d1-a14a-44ca-ac05-ecdf93f976ca"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "6c30d1db-0f9f-41a0-a055-00a447a5a4ab"],
 " is the Boltzmann Constant. So, the magnitude ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "0"], TraditionalForm]],ExpressionUUID->
  "af21eefb-f1d0-40dc-bd07-b44e8ab589a8"],
 " (maximum absolute amplitude) of the oscillation will be proportional to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox["E"], "=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["3", "2"], 
       StyleBox[
        SubscriptBox["k", "B"],
        FontSlant->"Italic"], "T"}]], "\[Proportional]", 
     SqrtBox["T"]}]}], TraditionalForm]],ExpressionUUID->
  "4973dd3d-02de-4ec7-a920-f5531f087847"],
 ". For a sinusoidal oscillation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"u", "[", "t", "]"}], "=", 
    RowBox[{
     SubscriptBox["u", "0"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Omega]", " ", "t"}], "]"}]}]}], TraditionalForm]],
  ExpressionUUID->"c426b194-b604-461b-9e31-ebef8265c3a0"],
 ", the mean square amplitude is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox["u", "2"], "\[RightAngleBracket]"}], "=", 
    FractionBox[
     SuperscriptBox[
      SubscriptBox["u", "0"], "2"], "2"]}], TraditionalForm]],ExpressionUUID->
  "25f820f2-3b84-4c1e-ba08-cef61bd0eae1"],
 ". So, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     SuperscriptBox["u", "2"], "\[RightAngleBracket]"}], "\[Proportional]", 
    "T"}], TraditionalForm]],ExpressionUUID->
  "dcda27ad-5893-4125-b0a6-15c27085e7b1"],
 "."
}], "Text",ExpressionUUID->"6ab0ae4b-bfe7-4f43-889b-d4590a7edcb4"],

Cell[TextData[{
 "Further, the total energy ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]],ExpressionUUID->
  "0ea86d00-a993-4143-896c-6ceeb1fa7bda"],
 " of a harmonic oscillator is proportional to the mass ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "557f7665-95ff-4a5c-9d83-ed3b3824d777"],
 ". For a fixed total energy, therefore, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["u", "0"], "2"], "\[Proportional]", 
    FractionBox["1", "m"]}], TraditionalForm]],ExpressionUUID->
  "71859d66-e863-4c7a-9fb2-d4b0f0647fad"],
 ". Thus, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{
     FractionBox["2", "3"], 
     SuperscriptBox["\[Pi]", "2"], 
     SuperscriptBox["g", "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox["u", "2"], "\[RightAngleBracket]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4b8aaf8e-6a25-4ce5-9b09-1798e6f0d889"],
 " can be written as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{"\[Beta]", 
     RowBox[{
      FractionBox[
       RowBox[{"T", " "}], "m"], "\[CenterDot]", 
      SuperscriptBox["g", "2"]}]}]}], TraditionalForm]],ExpressionUUID->
  "ae5c54c4-f90c-40f7-a713-cbde6e9fd36f"],
 ", where \[Beta] is a parameter that represents the level of (harmonic) \
bonding forces acting on the considered atom in its specific position within \
the crystal structure. Evaluating values for the Debye\[Dash]Waller Factor of \
the same atom species bonded to different bonding partners in different \
coordination may provide data for the variation of bonding forces."
}], "Text",ExpressionUUID->"fd19f71c-4104-4f30-b941-58be08b29ada"],

Cell[CellGroupData[{

Cell["Debye\[Dash]Waller Factor Data", "Subsection",ExpressionUUID->"4cd42cec-6a19-4851-9cbf-6f1f4c4c95b5"],

Cell[TextData[{
 "The following data for ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "e00330ff-1bf3-4855-9d98-75a2db4db72a"],
 ", the Debye Parameter, are taken from an archival data ",
 ButtonBox["publication",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://journals.iucr.org/a/issues/1996/03/00/zh0008/zh0008_\
82472sup1.pdf"], None},
  ButtonNote->
   "https://journals.iucr.org/a/issues/1996/03/00/zh0008/zh0008_82472sup1.\
pdf"],
 " by L.-M. Peng, G. Ren, S. L. Dudarev and M. J. Whelan. The background \
theory is explained in ",
 ButtonBox["this paper",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.researchgate.net/publication/254306729_Debye-Waller_\
Factors_and_Absorptive_Scattering_Factors_of_Elemental_Crystals"], None},
  ButtonNote->
   "https://www.researchgate.net/publication/254306729_Debye-Waller_Factors_\
and_Absorptive_Scattering_Factors_of_Elemental_Crystals"],
 " by the same authors. The dimension of ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "43bf8ccd-7b09-487f-992c-3b9770c86d7b"],
 " is that of a squared length. To tell us the unit of their data for ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "0bafd0da-f0a0-47ac-b5cc-92a5b6045b09"],
 " in either one paper is, of course, infra dig for L.-M. Peng, G. Ren, S. L. \
Dudarev and M. J. Whelan. But hey, not much of a problem. ",
 StyleBox["I assume it\[CloseCurlyQuote]s in antiquated non-SI ",
  FontWeight->"Plain",
  FontColor->RGBColor[1, 0, 1]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalARing]", "2"], TraditionalForm]],
  FontWeight->"Plain",
  FontColor->RGBColor[1, 0, 1],ExpressionUUID->
  "2c44a033-1cdf-401e-b39d-5c5e360103df"],
 ". If it is actually is given in proper SI units, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", "2"], TraditionalForm]],ExpressionUUID->
  "0120ff0d-90b4-4674-aa46-4bb8c67e3cb8"],
 ", it is comforting to know that we won\[CloseCurlyQuote]t go wrong by more \
than a factor of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Exp", "[", "100", "]"}], "=", 
    SuperscriptBox["10", "43"]}], TraditionalForm]],ExpressionUUID->
  "0d1b77dc-6815-46ee-93fa-f8165c6133ed"],
 " in the beam intensity."
}], "Text",ExpressionUUID->"c5717a15-64dd-444a-8e28-d0d33096a24c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lBA2Data", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Cu-A1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1464"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1464"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1464"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1465"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1466"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1467"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1468"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1469"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1470"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1472"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1483"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1498"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1517"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1540"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1600"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1676"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1770"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1823"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1316"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1410"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1448"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1504"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1598"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1692"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.1880"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.2068"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.2256"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.2444"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.2632"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.2820"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.3008"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.3196"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.3384"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.3571"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.3759"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.3947"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.4135"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.4322"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.4510"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.4698"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.4886"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.5073"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.5261"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.5448"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.5505"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.5542"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.5636"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.5823"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.6011"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.6198"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.6385"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.6573"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.7041"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.7509"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.8443"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.9376"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "1.1238"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "1.3092"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "1.4937"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "1.6772"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "1.8596"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Ti-A3\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1662"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1662"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1663"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1663"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1663"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1664"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1664"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1665"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1666"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1667"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1673"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1682"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1693"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1707"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1741"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1786"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1840"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1871"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1904"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1940"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1955"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1978"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1491"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1579"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.1755"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.1930"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.2105"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.2281"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.2456"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.2632"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.2807"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.2982"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.3158"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.3333"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.3508"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.3684"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.3859"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.4034"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.4210"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.4385"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.4560"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.4735"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.4911"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.5086"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.5138"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.5173"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.5261"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.5436"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.5611"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.5786"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.5961"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.6136"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.6573"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.7010"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.7884"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.8757"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "1.0500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "1.2237"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "1.3969"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "1.5694"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "1.7412"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Cr-A2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1130"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1130"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1130"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1133"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1136"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1140"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1145"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1157"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1174"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1193"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1205"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1217"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1230"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1235"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1244"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1259"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1274"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.0857"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.0943"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.1028"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.1114"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.1200"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.1285"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.1371"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.1457"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.1542"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.1628"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.1714"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.1799"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.1885"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.1970"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.2056"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.2142"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.2227"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.2313"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.2398"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.2484"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.2510"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.2527"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.2569"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.2655"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.2740"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.2826"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.2912"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.2997"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.3211"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.3424"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.3851"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.4278"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "0.5130"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "0.5981"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "0.6829"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "0.7674"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "0.8517"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Fe-A2\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1200"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1200"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1200"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1200"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1201"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1201"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1202"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1203"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1204"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1208"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1214"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1222"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1232"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1258"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1290"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1330"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1353"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1377"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1403"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1414"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1431"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1461"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1493"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.1110"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.1221"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.1332"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.1443"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.1554"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.1664"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.1775"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.1886"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.1997"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.2108"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.2219"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.2330"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.2441"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.2552"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.2663"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.2774"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.2884"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.2995"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.3106"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.3217"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.3250"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.3272"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.3328"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.3438"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.3549"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.3660"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.3771"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.3881"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.4158"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.4435"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.4988"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.5540"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "0.6643"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "0.7744"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "0.8842"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "0.9936"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "1.1027"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Fe-A1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1547"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1547"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1547"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1548"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1549"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1550"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1551"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1552"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1554"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1555"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1566"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1582"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1602"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1627"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1689"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1769"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1867"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1922"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1982"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1429"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1467"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1524"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1619"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1715"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.1905"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.2095"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.2286"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.2476"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.2667"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.2857"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.3047"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.3238"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.3428"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.3618"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.3809"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.3999"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.4189"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.4379"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.4570"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.4760"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.4950"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.5140"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.5330"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.5520"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.5577"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.5615"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.5710"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.5900"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.6090"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.6280"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.6470"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.6660"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.7134"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.7608"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.8555"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.9501"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "1.1387"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "1.3267"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "1.5138"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "1.6999"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "1.8849"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Ni-A1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.0", ",", "0.1245"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", "0.1245"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.0", ",", "0.1245"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.1245"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.0", ",", "0.1245"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6.0", ",", "0.1246"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.0", ",", "0.1246"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8.0", ",", "0.1247"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.0", ",", "0.1248"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10.0", ",", "0.1248"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15.0", ",", "0.1253"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20.0", ",", "0.1259"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25.0", ",", "0.1267"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30.0", ",", "0.1277"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40.0", ",", "0.1302"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50.0", ",", "0.1334"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60.0", ",", "0.1373"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65.0", ",", "0.1395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70.0", ",", "0.1419"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"75.0", ",", "0.1445"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"77.0", ",", "0.1456"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80.0", ",", "0.1472"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"85.0", ",", "0.1502"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"90.0", ",", "0.1094"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100.0", ",", "0.1215"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"110.0", ",", "0.1337"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120.0", ",", "0.1458"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130.0", ",", "0.1580"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"140.0", ",", "0.1701"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150.0", ",", "0.1823"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"160.0", ",", "0.1944"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"170.0", ",", "0.2066"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"180.0", ",", "0.2187"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"190.0", ",", "0.2309"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200.0", ",", "0.2430"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"210.0", ",", "0.2551"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"220.0", ",", "0.2673"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"230.0", ",", "0.2794"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"240.0", ",", "0.2916"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250.0", ",", "0.3037"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"260.0", ",", "0.3158"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270.0", ",", "0.3280"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"280.0", ",", "0.3401"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"290.0", ",", "0.3522"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"293.0", ",", "0.3559"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"295.0", ",", "0.3583"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300.0", ",", "0.3644"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"310.0", ",", "0.3765"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"320.0", ",", "0.3886"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"330.0", ",", "0.4008"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"340.0", ",", "0.4129"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"350.0", ",", "0.4250"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"375.0", ",", "0.4553"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400.0", ",", "0.4856"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"450.0", ",", "0.5461"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500.0", ",", "0.6066"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"600.0", ",", "0.7273"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"700.0", ",", "0.8477"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800.0", ",", "0.9677"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"900.0", ",", "1.0873"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000.0", ",", "1.2064"}], "}"}]}], "}"}]}]}], "\n", 
    "|>"}]}], ";"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"f042a66f-034f-4697-a694-e64c8798ff5a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Debye\[Dash]Waller Factor", "Subsection",ExpressionUUID->"400c1fae-69e0-44d8-a08a-f8fbb914e813"],

Cell[TextData[{
 "Call rBA2T like this: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"rBA2T", " ", "[", 
    RowBox[{"BA2Data", "[", "\<\"Ti-A3\"\>", "]"}], "]"}], TraditionalForm]],
  ExpressionUUID->"fe5ea0c8-208d-434b-8268-e01b7653a2db"],
 "."
}], "Text",ExpressionUUID->"792cc771-0edd-40f2-9ae3-580d757746bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rBA2T", "[", "lBA2_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fDW", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "[", "lBA2", "]"}], ",", 
       RowBox[{
       "Throw", "[", "\"\<FE: Debye\[Dash]Waller data is not available.\>\"", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Convert", " ", "from", " ", 
       SuperscriptBox["\[CapitalARing]", "2"], "to", " ", 
       SuperscriptBox["nm", "2"], " ", "by", " ", "multiplying", " ", "with", 
       " ", 
       RowBox[{
        FractionBox["1", "100"], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"fDW", "=", " ", 
      RowBox[{"Interpolation", "[", "lBA2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fDW", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"b86c38c3-9ed3-4351-aac0-f2414682f8de"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",ExpressionUUID->"df7278e2-d6e9-4491-8e22-86a482505110"],

Cell[BoxData[
 RowBox[{"lBA2Data", " ", "is", " ", "in", " ", 
  RowBox[{
   SuperscriptBox["\[CapitalARing]", "2"], "!"}]}]], "Text",ExpressionUUID->\
"9c74d6b1-2eae-4267-b3a6-52d5b5ee22a8"],

Cell[BoxData[
 RowBox[{"rBA2T", "[", 
  RowBox[{"lBA2Data", "[", "\"\<Ni-A1\>\"", "]"}], "]"}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"5c2aba2d-2d52-4479-bf50-b8a48982ef0e"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rBA2T", "[", 
        RowBox[{"lBA2Data", "[", "\"\<Ni-A1\>\"", "]"}], "]"}], "[", "t", 
       "]"}], 
      SuperscriptBox["\[CapitalARing]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"rBA2T", "[", 
        RowBox[{"lBA2Data", "[", "\"\<Fe-A1\>\"", "]"}], "]"}], "[", "t", 
       "]"}], 
      SuperscriptBox["\[CapitalARing]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"rBA2T", "[", 
        RowBox[{"lBA2Data", "[", "\"\<Fe-A2\>\"", "]"}], "]"}], "[", "t", 
       "]"}], 
      SuperscriptBox["\[CapitalARing]", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", "1000"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"72108194-038e-40f7-8fc8-a8b6189651ca"],

Cell[TextData[{
 "In this work, I am using the definition of wave numbers (norms of wave \
vectors) that is popular in crystallography: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["k",
     FontWeight->"Plain"], "=", " ", 
    FractionBox["1", "\[Lambda]"]}], TraditionalForm]],ExpressionUUID->
  "aebb34cc-bdae-47c8-9bce-5cb869d33920"],
 ". In solid-state physics, and contrast, the definition would be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    FractionBox[
     RowBox[{"2", "\[Pi]"}], "\[Lambda]"]}], TraditionalForm]],ExpressionUUID->
  "198d985e-37a5-4ffb-a3b7-f27718ec7e23"],
 ". The factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Pi]"}], TraditionalForm]],ExpressionUUID->
  "813e1b3b-2a7a-49c7-a0a9-43ea5beb0fc9"],
 " propagates into the definition of what is called (but should not be \
called) the \[OpenCurlyDoubleQuote]reciprocal\[CloseCurlyDoubleQuote] \
lattice. This will make a difference when it comes to calculate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    SuperscriptBox[
     RowBox[{"B", "(", 
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Lambda]"], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"e265a077-1d29-44ed-bf00-1a264bda94cc"],
 ". With the definition I am using, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Lambda]"], "=", 
    FractionBox["g", "2"]}], TraditionalForm]],ExpressionUUID->
  "6521cf38-28ab-4a32-ac4b-0e7a54e4cc2d"],
 ". For a solid solid-state physicist, it would be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Lambda]"], "=", 
    FractionBox["g", 
     RowBox[{"4", "\[Pi]"}]]}], TraditionalForm]],ExpressionUUID->
  "a82ef989-7683-4441-a4af-090da2ad3715"],
 "."
}], "Text",ExpressionUUID->"4b579df4-2d3f-4dfe-b534-2f8dc4054e0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rDWF", "[", 
   RowBox[{"sDW_String", ",", "lG_", ",", 
    RowBox[{"rT_", ":", "293"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "g", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"rBA2T", "[", 
         RowBox[{"lBA2Data", "[", "sDW", "]"}], "]"}], "[", "rT", "]"}], 
       SuperscriptBox["\[CapitalARing]", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", "lG"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"b", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["g", "2"], ")"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "m"}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"a334eaf3-9cad-4ceb-b90c-b04498803702"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Primary Beam", "Section",ExpressionUUID->"34a4b8b3-11e0-4fe7-bad4-11859493e7cd"],

Cell["Primary beam wavelength, in units of nm.", "Text",ExpressionUUID->"e2f1659d-fdd8-4fe5-acda-590f4d394849"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rLambda", "=", "0.0178331"}], ";"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"6e6aaf51-cd65-4835-a3e9-b8bbde041de1"],

Cell[CellGroupData[{

Cell["Wave Number and Wave Vector", "Subsection",ExpressionUUID->"c60bc2a3-167e-4ba9-a859-ca65ffe7735e"],

Cell[TextData[{
 "Wave number in units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["nm", 
     RowBox[{"-", "1"}]], "."}], TraditionalForm]],ExpressionUUID->
  "001eacce-537e-4982-8332-d7c10cee71f7"],
 " No factor 2\[Pi] (we use the definition that is popular in \
crystallography). The wave vector is aligned with the z-axis of the \
coordinate system."
}], "Text",ExpressionUUID->"fddcbdd0-deb4-4b57-a0cc-323e48a4b4c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rK0", "=", 
   FractionBox["1", "rLambda"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lK0", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "rK0"}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"1449ab30-4ef9-4144-aaaf-e41e44fdbd62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polychromaticity", "Subsection",ExpressionUUID->"d2fa3041-3fd3-419d-b355-9e0775e57f52"],

Cell["\<\
Assumption: Primary photon energy follows normal distribution.\
\>", "Text",ExpressionUUID->"2b09aa06-53bd-4482-9fe2-dae38bdc1111"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Photons", ":", " ", 
    RowBox[{"p", "==", 
     FractionBox["e", "c"]}]}], "=", 
   RowBox[{"h", " ", "k"}]}], ",", " ", 
  RowBox[{
   RowBox[{"so", " ", "k"}], " ", "==", " ", 
   RowBox[{
    FractionBox["e", 
     RowBox[{"h", " ", "c"}]], ".", " "}]}]}]], "Text",ExpressionUUID->\
"9cd9e75e-9559-44af-bdc5-6f07cc35d9db"],

Cell["\<\
Normal distribution of energy implies normal distribution of wave number.\
\>", "Text",ExpressionUUID->"7a0458ba-2a73-4847-8d21-6eb0454835c6"],

Cell[CellGroupData[{

Cell["Standard Deviation of Wave Number Distribution", "Subsubsection",ExpressionUUID->"01e494c2-5681-47d2-98ac-99eb8da10df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rSigK", "=", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], "rK0"}]}], ";"}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"609f6ced-c74b-4e63-89fc-8301af46524a"],

Cell[TextData[{
 "Intensity factor related to energy / wave number distribution. Multiply \
density of normal distribution with ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"2", "\[Pi]"}]], TraditionalForm]],ExpressionUUID->
  "81501ac2-dfb3-48f7-864f-b16b20316d87"],
 ", so the factor equals 1 for the mean wave number. Chop off values smaller \
than ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", "\[Sigma]"}], TraditionalForm]],ExpressionUUID->
  "eda73214-b89a-4ddf-838f-f06026d05865"],
 "."
}], "Text",ExpressionUUID->"937ffd66-071d-4b29-bd33-7224bd7e7880"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rFE", "[", "ee_Real", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "ee", "]"}], ">", 
      RowBox[{"5", " ", "rSigK"}]}], ",", "0", ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", "rSigK", " ", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "rSigK"}], "]"}], ",", "ee"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"a98b6ee7-a385-4020-8bbe-7df285def8f4"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"rFE", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "3"}], ",", "0.003"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"9222ee09-b98f-4066-8799-554f81796cd8"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffraction Geometry", "Section",ExpressionUUID->"bc17e21e-6c5e-407d-8e6b-9fd525af91a5"],

Cell[CellGroupData[{

Cell["Detector Size \[Dash] Maximum Angle", "Subsubsection",ExpressionUUID->"f33b660c-cd25-4232-a8c7-3f378283b895"],

Cell["Maximum scattering angle captured by the pattern.", "Text",ExpressionUUID->"ab062836-24be-4986-8d33-95f9754e1137"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rAngMax", "=", 
   RowBox[{"0.6", " ", "Degree"}]}], ";"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"d0561e6a-9b09-4c18-8c1b-d1852b1dd17a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Excitation Error", "Subsection",ExpressionUUID->"b9b12a26-72d3-4fe1-9ea7-0d318bef5747"],

Cell["This section is currently not actively being used.", "Text",ExpressionUUID->"05079cea-fd15-447f-a607-9e6c9107c6e5"],

Cell[TextData[{
 "Angle between vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SubscriptBox["v", "1"]}], TraditionalForm]],ExpressionUUID->
  "b0d2531d-afd9-4b39-85ff-56027c3bdb84"],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "2"], TraditionalForm]],ExpressionUUID->
  "7daec352-85ea-4fe9-8539-3554c6a326a8"],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "3"], TraditionalForm]],ExpressionUUID->
  "85862751-9c87-4de2-b6c4-2107cb38cc0c"],
 "} and [001]: ArcCos[]"
}], "Text",ExpressionUUID->"1bf837cd-188e-4ae7-807f-2a0ac800dae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rBAng", "[", 
   RowBox[{"g_List", ",", "a0_", ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"ArcSin", "[", 
   RowBox[{
    FractionBox["\[Lambda]", 
     RowBox[{"2", " ", "a0"}]], 
    SqrtBox[
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["#", "2"], "&"}], "/@", "g"}], ")"}]}]]}], 
   "]"}]}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"0d9c400d-61dd-4d74-a157-b83c7568b8e6"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2.5", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", "]"}], ",", "x"}], "]"}]}], ",", 
     SuperscriptBox[
      RowBox[{"Sinc", "[", "x", "]"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], "]"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"2225150d-abcb-467a-ae0b-fa6b4648646f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffracted Intensity", "Section",ExpressionUUID->"4c29b97d-cb81-4556-b4e2-1cdb25b71824"],

Cell[CellGroupData[{

Cell["Reflection", "Subsection",ExpressionUUID->"af1616a9-5d10-4018-a1e0-0f12f0488881"],

Cell[TextData[{
 "For the given primary wave vector lK0 and a given plane normal or \
diffraction vector lS with some length and some orientation, calculate the \
outgoing wave vector lK, the angle r2Theta it makes with lK0, the excitation \
error, the x-y coordinates of the q-vector in the x-y-plane, and the \
intensity factor rFI. To do this, the function evaluates the distance of the \
rotated ",
 StyleBox["hkl",
  FontSlant->"Italic"],
 " plane normal from the Ewald sphere. From the distance, the intensity \
factor rFF related to the atom-form factor and the intensity factor rFI \
related to the non-monochromaticity (wavelength spread) is obtained via \
function rFE. Further, the coordinates of the corresponding ",
 StyleBox["q",
  FontSlant->"Italic"],
 " in the diffraction plane are calculated for later use."
}], "Text",ExpressionUUID->"bf4f8555-de4c-4239-a653-f6f840109691"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aDiff", "[", 
   RowBox[{"aGI_", ",", "lK0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lK", ",", "rEE", ",", "r2Theta", ",", "lXY", ",", "rFI"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lK", "=", 
      RowBox[{"lK0", "+", 
       RowBox[{"aGI", "[", "\"\<lGhklR\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r2Theta", "=", 
      RowBox[{"VectorAngle", "[", 
       RowBox[{"lK", ",", "lK0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rEE", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Norm", "[", "lK", "]"}], "-", 
        RowBox[{"Norm", "[", "lK0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lXY", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Cos", "[", "r2Theta", "]"}]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"aGI", "[", "\"\<lGhklR\>\"", "]"}], "\[LeftDoubleBracket]",
           "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"aGI", "[", "\"\<lGhklR\>\"", "]"}], "\[LeftDoubleBracket]",
           "2", "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rFI", " ", "=", 
      RowBox[{
       RowBox[{"rFE", "[", "rEE", "]"}], 
       RowBox[{"aGI", "[", "\"\<rFI\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<lK\>\"", "->", "lK"}], ",", 
        RowBox[{"\"\<lXY\>\"", "->", "lXY"}], ",", 
        RowBox[{"\"\<rFI\>\"", "->", "rFI"}]}], "|>"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"bef00173-37fb-4ed7-9cdc-2f32da3cc8dc"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phases and Structures", "Chapter",ExpressionUUID->"92c69c99-834d-4dd7-bf01-3474a48aa0c6"],

Cell[CellGroupData[{

Cell["Unit Cells", "Subchapter",
 CellGroupingRules->{
  "GroupTogetherGrouping", 
   10000.},ExpressionUUID->"a5a39318-7ec5-4105-ad5c-4fa6fd15df0b"],

Cell[TextData[{
 "From an abstract point of view, a crystal is a periodic repetition of a \
fixed \[OpenCurlyDoubleQuote]motif\[CloseCurlyDoubleQuote] in space. The \
motif can be a single atom or a group of atoms. Important is that this motif \
is attached to every lattice point in the same way \[Dash] in the same \
relative position to the lattice point (not necessarily ",
 StyleBox["on",
  FontSlant->"Italic"],
 " the lattice point) and in the same orientation. Owing to translation \
symmetry, the crystal structure is fully defined by specifying one repeat \
unit, which is called a ",
 StyleBox["unit cell",
  FontSlant->"Italic"],
 ". As mentioned, there are many possible valid choices for the crystal \
lattice and, correspondingly, for the unit cell. A valid specification must \
include the fundamental translations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "i"], TraditionalForm]],ExpressionUUID->
  "37608203-6e30-4bf2-9331-884d128a9e4b"],
 " that span the unit cell, the locations of the lattice points that the cell \
includes (e.g. 4 lattice points in the case of an FCC lattice), and \
information on the basis to be attached to every lattice point. \
(Mathematically, the crystal structure corresponds to a ",
 StyleBox["convolution",
  FontSlant->"Italic"],
 " of the lattice with the basis). Specifications of the bases must include \
the type of each constituent atom and its location relative to the lattice \
point."
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.907071846041533*^9, 
  3.907071852650776*^9}},ExpressionUUID->"a70baedb-dc32-4ef7-80b4-\
586cd4cd40a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffracted Beams \[Dash] or Reflections", "Subchapter",ExpressionUUID->"f14eba74-804f-400a-a31f-a8cd5b4688eb"],

Cell["\<\
The following theory is detailed at https://bit.ly/EMSE-228 (Case VPN!), \
specifically https://bit.ly/3IDHN8.\
\>", "Text",ExpressionUUID->"04942f41-c2ba-4de2-bc4e-cf0f5adb54df"],

Cell[TextData[{
 "When the ",
 ButtonBox["Bragg Condition",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://en.wikipedia.org/wiki/Bragg%27s_law"], None},
  ButtonNote->"https://en.wikipedia.org/wiki/Bragg%27s_law"],
 " is fulfilled, sets of (equally spaced) lattice planes can reflect the \
primary beam like semi-permeable mirrors. Each set of lattice planes in the \
crystal lattice is designated by a vector normal to the planes. By \
definition, the length of the normal vector is chosen to be the inverse of \
the respective lattice plane spacing. ",
 StyleBox["The entirety of all such-defined plane normals forms a ",
  FontColor->RGBColor[0.5, 0, 0.5]],
 StyleBox["lattice",
  FontSlant->"Italic",
  FontColor->RGBColor[0.5, 0, 0.5]],
 StyleBox["!",
  FontColor->RGBColor[0.5, 0, 0.5]],
 StyleBox[" ",
  FontColor->RGBColor[1, 0, 0]],
 "This is the lattice of plane normals, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "a0055365-b4d2-4e67-bc05-2f413ab42d74"],
 ". It is generally different from the \[OpenCurlyDoubleQuote]ordinary\
\[CloseCurlyDoubleQuote] lattice that describes translation symmetry and \
crystallographic directions, which we will, for distinction, from now on call \
the lattice of directions, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "3f4b4fd7-31bc-410e-968e-3403644fbe2e"],
 ".  "
}], "Text",ExpressionUUID->"cde24a6b-a8f3-4f7d-b66e-f3e0c98beb79"],

Cell[TextData[{
 "While images (with atomistic resolution) reveal ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "fe212ef6-adaf-410b-bde3-051cbcd5c54f"],
 ", diffraction patterns reveal ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "P"], TraditionalForm]],ExpressionUUID->
  "31b84fc0-6d96-4ee1-8616-6b4913fd1757"],
 "."
}], "Text",
 TextAlignment->Center,ExpressionUUID->"5e0aa8b1-7a30-478d-a8e2-a374b2d46e52"],

Cell[TextData[{
 "Therefore, to extract information from diffraction patterns that is similar \
to information you could get from images, you need to understand the ",
 StyleBox["relation",
  FontSlant->"Italic"],
 " between ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "e0f41e2b-7945-4416-ace5-4ed541c38909"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "fec624f2-19f3-446a-a342-f990244624a8"],
 ". In ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "c8c74d65-748c-417b-844f-7c0eccc7c61a"],
 ", the distances between lattice points are lengths. In ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "b549acac-983d-4e3f-b995-919350e79417"],
 ", in contrast, the distances between lattice points are ",
 StyleBox["reciprocal",
  FontSlant->"Italic"],
 " lengths. Generally, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "78a64d23-958a-45ab-a7d6-8ec12c7b9d73"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "d42d4b5a-9332-432c-a31f-5235edf4b147"],
 "  and coordinate vectors in these two systems are related by the so-called \
\[OpenCurlyDoubleQuote]metric\[CloseCurlyDoubleQuote] tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "ik"], TraditionalForm]],ExpressionUUID->
  "53a6e5f2-d6c6-4497-a0ff-fd30ea97db49"],
 ".  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "938525d4-1f68-4a6e-83bf-e2505fd80b8b"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "71ce107d-1def-46bf-87c4-b27dac1441d6"],
 " are \[OpenCurlyDoubleQuote]companion\[CloseCurlyDoubleQuote] lattices of \
each other. The ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "d96085ef-d61c-431d-b9a9-f513f1b42009"],
 " of a given ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "6a70b170-c422-474c-aa0e-acb94aa96b11"],
 " generally changes with the spacings and angles within of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "4fb1d431-cc31-4f2d-b4b0-49839fce1185"],
 ". if ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "0e4b8bd0-899d-4b49-a19a-d67faf63d52b"],
 " is being rotated, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "7ca16169-9802-4246-8b22-ec2ce9cdfdf0"],
 " rotates with it. "
}], "Text",ExpressionUUID->"9091518b-1664-4a52-9cb6-097963094850"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "43cb0cac-8ddb-4d3c-9ca2-3493623b2570"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "adc8bb14-6445-4c3a-b7ea-6cdd1e526386"],
 " fulfill a \[OpenCurlyDoubleQuote]reciprocity\[CloseCurlyDoubleQuote] \
relationship: The lattice of plane normals of a lattice of plane normals of a \
lattice of directions is identical with that lattice of directions. No typo. \
In other words: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["L", "p"], "[", 
     RowBox[{
      SuperscriptBox["L", "p"], "[", 
      SubscriptBox["L", "d"], "]"}], "]"}], "=", 
    SubscriptBox["L", "d"]}], TraditionalForm]],ExpressionUUID->
  "f9c1a997-6665-44b1-bb86-b1026422959b"],
 ". Well-known example: If ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "bb590308-93b9-49e5-b513-8de65c77499f"],
 " is an FCC (face-centered cubic) lattice, its ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "07219906-e341-4315-a5d5-1c0212d6cb8d"],
 " is a BCC (body-centered cubic) lattice. If ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "3b2c9daa-503c-47c9-815c-98ef98ad3210"],
 " is a BCC lattice, its ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "4ce2d23e-b4be-444d-ae57-b3744406a068"],
 " is an FCC lattice. Cu, for example, has the A1 structure, which can be \
described with and FCC lattice. Diffraction patterns of Cu crystallites, \
however, show spots that make a BCC pattern."
}], "Text",ExpressionUUID->"3a8d8390-a810-4d7a-ae3c-2d5ca7ef60da"],

Cell[TextData[{
 "Every reflection / diffracted beam in a diffraction pattern corresponds to \
a plane normal that can be described as a lattice vector of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "225b6dfa-aeab-46ab-b91f-37a8aaaa73e4"],
 ", i.e. a linear combination of the base vectors of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "3bc3694f-c6af-441e-9543-54938c9f9e02"],
 " with integer coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{"h", ",", "k", ",", "l"}], TraditionalForm]],ExpressionUUID->
  "cc815eee-52e9-4007-a954-15e164b68f7e"],
 ". Therefore, the reflections that appear in a diffraction pattern are \
usually indexed by the lattice point in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "98eea8a5-7fc9-48e6-8aac-1d83e42ec1ce"],
 " that represents the normal of the reflecting planes. Materials scientists \
talk about a \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"e2aea04e-1dd6-4faf-8825-339e750ec670"],
 " plane.\[CloseCurlyDoubleQuote] This is a loose term for an infinite set of \
equi-spaced lattice planes of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "aa7cd19b-fa57-4bc0-a0fc-ba36f1db7058"],
 " whose plane normal, described in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "78fe6f24-d9c7-4b67-bcc8-7c445b02bb13"],
 ", is the ",
 StyleBox["lattice",
  FontSlant->"Italic"],
 " vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"]}], "+", 
    RowBox[{"k", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"]}], "+", 
    RowBox[{"l", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "a2628018-a666-44bd-8714-15e80930441b"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"h", ",", "k", ",", 
    RowBox[{"l", "\[Element]", "\:2124"}]}], TraditionalForm]],ExpressionUUID->
  "a3e353a1-c858-4658-a783-8c7ef9462f67"],
 ", i.e. are ",
 StyleBox["integer",
  FontSlant->"Italic"],
 " numbers. The vectors ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "7f3541c5-42f2-419b-9946-03606ecde955"],
 " are the 3 base vectors of ",
 StyleBox["the",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "21d74f6c-d6e0-4a0a-ab31-6fc18c30ef43"],
 " that belongs to the given ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "445a7b9d-c0f9-4ab7-8f12-b6600de24664"],
 " (and rotates with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "39913dbc-8410-45fe-8409-366992f8afe8"],
 "if you rotate the crystal). The 3 base vectors ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "44f4d5f5-5692-420b-a46d-d8ccc1b321a3"],
 " of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "4812ab14-1e33-459b-93b3-647ffa9c4239"],
 " and the 3 base vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "k"], TraditionalForm]],ExpressionUUID->
  "ce9ba95c-78cc-4a4b-8504-677a7dd39857"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "0ea2d6d0-6379-4296-ad6b-f167f69687db"],
 " need to fulfil the relationship ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "decf3a4c-b6c3-4ce5-b8e6-f82a498bebe1"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"], "=", 
    RowBox[{
     RowBox[{"1", " ", "for", " ", "i"}], "=", 
     RowBox[{"k", " ", "and", " ", "0", " ", "otherwise", " ", 
      RowBox[{
       RowBox[{"(", "\<\"Kronecker Symbol\"\>", ")"}], ".", " "}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"a4434987-2f6a-4174-84c0-b8c9c84a600d"],
 " "
}], "Text",ExpressionUUID->"f531af17-e025-4093-87f3-fc6f2487c3bc"],

Cell[TextData[{
 "Note the different position of the indices. That the base vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "k"], TraditionalForm]],ExpressionUUID->
  "5641bf0c-babe-4821-9fda-83f70776250f"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "d1d683b8-75b0-4c82-a25f-56a1a0ddc590"],
 " carry a ",
 StyleBox["subscript",
  FontSlant->"Italic"],
 " indicates that these vectors are \[OpenCurlyDoubleQuote]ordinary,\
\[CloseCurlyDoubleQuote] \[OpenCurlyDoubleQuote]co-variant\
\[CloseCurlyDoubleQuote] vectors. They live in d-space, the space of \
directions. Their norm has the dimension of a length. The base vectors ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "e8f1a202-88c5-4094-88cb-3cc67097d06f"],
 " of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "f5a257fb-910d-4e6c-9642-b3f2aae0d1ad"],
 ", in contrast, are \[OpenCurlyDoubleQuote]contra-variant\
\[CloseCurlyDoubleQuote] vectors. They live in p-space, the space of plane \
normals. Their norm has the dimension of a ",
 StyleBox["reciprocal",
  FontSlant->"Italic"],
 " length. The approach we are taking here is generally applicable, including \
when the crystal system is non-cubic, i.e. the coordinate system is \
non-Cartesian. In cubic systems, specifically, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "i"], "||", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "i"]}], TraditionalForm]],ExpressionUUID->
  "333a591b-e8c5-4c71-aa59-43922bd95366"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"||", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "||"}], "=", 
    RowBox[{"||", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], 
     SuperscriptBox["||", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "afbd557d-22a6-4602-8ea3-26feb2b7da03"],
 ". In non-cubic systems, however,the relationship between the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "5a290c22-80d0-41f2-9c05-02c536f08651"],
 "and the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "cb72d844-02ba-436f-a2f5-a280ed239045"],
 " is generally more complicated."
}], "Text",ExpressionUUID->"6de8080a-e84b-46ae-aa14-f83c539eb633"],

Cell[TextData[{
 "In the literature, information on lattice of crystal structures is often \
provided in terms of the 3 base vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "k"], TraditionalForm]],ExpressionUUID->
  "b6dcb2c4-47c3-4144-ac27-724bf2f9ea89"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "8c4013ee-58da-4013-bc95-0d4f46caab9e"],
 ". The lengths ",
 Cell[BoxData[
  FormBox[
   RowBox[{"||", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "k"], "||"}], TraditionalForm]],ExpressionUUID->
  "dfd5e8b9-29a8-44fb-b7a3-98654efb643b"],
 " of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "k"], TraditionalForm]],ExpressionUUID->
  "6dedd8dd-61d7-485f-a505-67c62635c396"],
 " are designated as \[OpenCurlyDoubleQuote] lattice parameters\
\[CloseCurlyDoubleQuote] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", ",", "b", ",", "c"}], TraditionalForm]],ExpressionUUID->
  "f55a3053-7a47-490a-965b-93a52ee71e41"],
 ", respectively. The angles they make pairwise with each other are denoted \
as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
    RowBox[{"\[Gamma]", "."}]}], TraditionalForm]],ExpressionUUID->
  "7a0f8886-fb4b-4eb1-b71c-7adcc39b171e"],
 " More precisely, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[Congruent]", 
    SubscriptBox["\|01d711", "1"], "\[Congruent]", 
    RowBox[{"\[Angle]", "(", 
     RowBox[{
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "2"], ",", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "3"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"9553875d-1dab-43b7-8d2c-76b54ccc86ab"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "\[Congruent]", 
    SubscriptBox["\|01d711", "2"], "\[Congruent]", 
    RowBox[{"\[Angle]", "(", 
     RowBox[{
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "3"], ",", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "1"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"2a260d04-6c1d-49be-b867-c32458e15ed2"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "\[Congruent]", 
    SubscriptBox["\|01d711", "3"], "\[Congruent]", 
    RowBox[{
     RowBox[{"\[Angle]", "(", 
      RowBox[{
       SubscriptBox[
        StyleBox["g",
         FontWeight->"Bold"], "1"], ",", 
       SubscriptBox[
        StyleBox["g",
         FontWeight->"Bold"], "2"]}], ")"}], "."}]}], TraditionalForm]],
  ExpressionUUID->"f916cf3b-ced9-4cda-a9f6-193f5b7ca0f9"],
 " "
}], "Text",ExpressionUUID->"32fed579-e05f-4fc9-9114-55a9c3138a09"],

Cell[TextData[{
 "There are different ways of calculating the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "682b1d9b-0d97-41a4-8fa9-981dff9b5f0d"],
 " from given ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "k"], TraditionalForm]],ExpressionUUID->
  "bf307dda-e041-47cf-bcbb-acccdfe7ac6e"],
 ". Here, recalling the requirement ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "7650b112-47c4-45c1-9fab-b682074b43a5"],
 ", we just let Mathematica solve the matrix equation (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "1"], ",", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "2"], ",", 
    StyleBox[
     SubscriptBox["g", 
      StyleBox["3",
       FontWeight->"Plain"]],
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "f96bef6c-7b26-4c56-8585-a6f8946d667d"],
 ")\[CenterDot](",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "1"], ",", 
      SuperscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "2"], ",", 
      SuperscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "3"]}], 
     StyleBox[")",
      FontWeight->"Bold"]}], "=", 
    SubscriptBox[
     StyleBox["Id",
      FontWeight->"Plain"], "3"]}], TraditionalForm]],ExpressionUUID->
  "064fe864-3377-4c9f-910c-bba7de30e765"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Id", "3"], " ", "is", " ", "the", " ", "unit", " ", 
    "matrix", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], " ", "in", " ", "Wolfram", 
      " ", "Language"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "79a98d6f-d4e9-4bb0-80fe-5c1f585c7a97"],
 " in 3 dimensions."
}], "Text",ExpressionUUID->"03a144af-f03a-4167-900e-ffc28c1f30cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Choice of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "7b1b60bb-4700-4825-a1bc-3483232610b2"]
}], "Subchapter",ExpressionUUID->"f681df66-eed6-4e3c-a940-fba05c9464da"],

Cell[TextData[{
 "The choice of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["L", "d"], " "}], TraditionalForm]],ExpressionUUID->
  "0dffffaf-f301-4ed7-9aef-9a7ab164dc7b"],
 "is not unique. (Equivalently, one can say that Alexa stop the choice of the \
unit cell is not unique.) On the contrary. There is an infinite variety of \
equally valid choices to describe the translation symmetry of a crystal by a \
lattice ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "366d5259-61fd-4ba0-b82b-af6dd1efe1b8"],
 " spanned by three independent fundamental translations ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "1"], ",", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "2"], ",", 
    StyleBox[
     SubscriptBox["g", 
      StyleBox["3",
       FontWeight->"Plain"]],
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "4b17ca3b-6a95-4e4d-ba54-d5ff712c6f4f"],
 ". Most of the time, we make one of the two following choices: "
}], "Text",ExpressionUUID->"12bf7855-be8b-4b93-8740-df83e396c370"],

Cell["\<\
Choice 1: The smallest unit cell that exhibits the full point symmetry of the \
crystal structure. To exhibit that symmetry, it may be necessary that the \
unit cell includes several lattice points.\
\>", "Item",ExpressionUUID->"0e46bfcf-9c45-480a-b215-9216023378c2"],

Cell["\<\
Choice 2: A \[OpenCurlyDoubleQuote]primitive\[CloseCurlyDoubleQuote] unit \
cell: a cell with the smallest possible volume. Cap this implies that a \
primitive of unit cell includes only one lattice point.\
\>", "Item",ExpressionUUID->"defbf6eb-05f9-4321-8fcc-637a84be7d55"],

Cell[TextData[{
 "Example: The A1 structure of Cu. ",
 StyleBox["Choice 1",
  FontSlant->"Italic"],
 ": The structure can be described using an FCC (face-centered cubic \
lattice): ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "1"], TraditionalForm]],ExpressionUUID->
  "a69b6d99-af9b-442a-8246-3c418b3b8bea"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", ",", "0", ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"edd532d6-e296-427f-b2ca-f180f6408c22"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "69eb95a2-f495-46b9-86ae-481e2e84482f"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "1", ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"05702f91-bb47-43a5-8160-594bc41dc400"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "3"], TraditionalForm]],ExpressionUUID->
  "cac041db-25ff-478a-8554-038d05544661"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0", ",", "0", ",", "1"}], ")"}], "."}], TraditionalForm]],
  ExpressionUUID->"c2e7d7f5-0106-4c10-9dc0-de11132d48af"],
 " To describe the A1 structure\[CloseCurlyQuote]s translation symmetry \
correctly, this unit cell needs to include 4 lattice points:  one in (0,0,0) \
and one in the center of each one the three adjacent cube faces: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"40404b33-1513-45d8-81b1-6bfa93e55932"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e4da8cc1-1188-4ab8-bbb5-e0ecf4c26cc0"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "df50b1ac-0928-4dec-a14e-6ed928550663"],
 ". The actual crystal structure is obtained by placing ",
 StyleBox["one atom",
  FontSlant->"Italic"],
 " into each lattice point. (Other FCC crystal structures, e.g. that of Si, \
can have several atoms per lattice point, e.g. 2 atoms per lattice point in \
the case of Si, none of them necessarily sitting ",
 StyleBox["on",
  FontSlant->"Italic"],
 " the lattice point.) ",
 StyleBox["Choice 2",
  FontSlant->"Italic"],
 ": The smallest unit cell that exhibits the full point symmetry of the A1 \
structure of Cu is the FCC unit cell. This cell includes 4 lattice points: \
one in (0,0,0), and one in the center of each one the three adjacent cube \
faces: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "1"], TraditionalForm]],ExpressionUUID->
  "cb55e2df-d633-446e-9790-c8c1bec68af6"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"a116524d-e6b2-4d1a-9a41-c4acd3e56d83"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "21d05646-d61d-4ad9-a741-a5f75f9d1345"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "70c4146b-b198-4150-8621-0fbb3c4fe05a"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "3"], TraditionalForm]],ExpressionUUID->
  "72ebd95d-c31b-4e81-902a-b1d466a923c6"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "7c7c1921-95b1-4f82-9ac4-5067b1e43f2d"],
 ". From this cell, however, the full symmetry, e.g. the 4-fold rotation axis \
of the structure is not obvious."
}], "Text",ExpressionUUID->"97aa8421-3902-4be0-a2c0-a47a8831cbf7"],

Cell[TextData[{
 "From a mathematical point of view, Choice 1 and Choice 2 are equally valid. \
They are not even the only choices. There is an infinite number of \
alternative choices which arise from the first ones by choosing unit cells \
constituting multiple adjacent primitive or FCC cells. Now, if diffraction \
patterns show ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "bcf84e6a-df29-4be7-939e-e429417e6a9e"],
 " and if different ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "6f888ed5-aa5d-4eab-94c6-4ef73dfa690c"],
 " have different ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "7e3c89d8-dbd3-4ee3-b4e4-c1112ed55e81"],
 ", how can this be consistent in describing the unique diffraction pattern \
that the crystal actually produces? The answer is that lattices who is unit \
cell contains several lattice points, e.g. FCC lattices, cannot produce a \
diffracted beam for each lattice point of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "a5283f2c-ef34-4635-9612-190cc72201c3"],
 ". In other words, lattice planes with certain indices cannot produce \
diffracted beams. The rules for certain beams not to show up are known as \
\[OpenCurlyDoubleQuote]extinction rules.\[CloseCurlyDoubleQuote] The \
extinction rules for the FCC lattice, for example, state that only those \
reflections (read lattice points of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "afe5dc1d-f97c-4ff9-af2b-231f15018bb1"],
 ") can appear for which either all indices odd or all indices are even. Ring \
diffraction parents from Cu, for example, show (111)-type rings and \
(200)-type rings, but no (123)-type rings. If, on the other hand, we decide \
to describe the crystal structure with a primitive lattice, then all lattice \
points of the corresponding ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "6a0fdc19-ef07-4c75-9d85-0b2d1d4ba805"],
 " can produce visible reflections."
}], "Text",ExpressionUUID->"b8cdb74f-64b6-47a8-b61f-5cdb90d34ece"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit-Cell Diffracted-Beam Amplitude \[Dash]\[NonBreakingSpace]\
\[OpenCurlyDoubleQuote]Structure Factor\[CloseCurlyDoubleQuote]", "Subchapter",\
ExpressionUUID->"6661257d-8a9a-4842-b9cb-2136b3003f5b"],

Cell[CellGroupData[{

Cell["\[OpenCurlyDoubleQuote]Structure Factor\[CloseCurlyDoubleQuote]", \
"Section",ExpressionUUID->"8b7fb2b2-03b1-41ae-b66a-54cb42902b03"],

Cell[TextData[{
 "Mathematically, the effect of choosing different lattices ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "ed065d47-8eee-4d2e-8db1-d53137a76198"],
 " and, consequently, obtaining different ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "9e2e3288-7aff-47f8-8325-e3c3d87515ba"],
 ", can be described by the so-called \[CloseCurlyDoubleQuote]Structure \
Factor\[CloseCurlyDoubleQuote] (not a good name \[Dash] should be \
\[OpenCurlyDoubleQuote]Unit-Cell Diffracted-Beam Amplitude\
\[CloseCurlyDoubleQuote]):"
}], "Text",ExpressionUUID->"d482c8f9-0e83-4c8e-95f0-9cf94fbc9afb"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "8e766941-3bf5-4097-9027-e137fa29b290"],
 "[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "]:=",
 Cell[BoxData[
  UnderoverscriptBox["\[Sum]", 
   RowBox[{
    StyleBox["j",
     FontSlant->"Italic"], "=", "1"}], "N"]],ExpressionUUID->
  "2681008c-bb7b-4f37-b5b8-7423abadcd7a"],
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     SubscriptBox["f", "j"], "[", 
     RowBox[{"||", 
      StyleBox["g",
       FontWeight->"Bold"], 
      StyleBox["||",
       FontWeight->"Bold"]}], 
     StyleBox[" ",
      FontWeight->"Bold"], "]"}]}], TraditionalForm]],ExpressionUUID->
  "f8696fc7-67b5-4b81-9f02-fbd60b336d75"],
 "\[CenterDot]Exp[2",
 "\[Pi]",
 " i ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["g",
     FontWeight->"Bold"], 
    StyleBox["\[CenterDot]",
     FontWeight->"Bold"], 
    SubscriptBox[
     StyleBox["r",
      FontWeight->"Bold"], "j"]}], TraditionalForm]],ExpressionUUID->
  "53d16533-b48d-4c75-83ad-479e6a40273d"],
 "]"
}], "Text",
 TextAlignment->Center,ExpressionUUID->"36cf0441-e807-4588-87e3-6c2cf47f1a53"],

Cell[TextData[{
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " =  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"]}], "+", 
    RowBox[{"k", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"]}], "+", 
    RowBox[{"l", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "a88800db-1169-4a7c-949c-3e2f8f2d2d11"],
 " \[Element] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "8d67d5ce-d041-46ad-b98c-dc78d4e096a7"],
 " is the normal of the reflecting planes. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "j"], TraditionalForm]],ExpressionUUID->
  "76aff88d-ea6b-4ea2-b7b8-5d53503ab681"],
 "is the position of atom number ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "7bcb4da6-d149-4248-a7b7-4679daa31f47"],
 " \[Dash] in coordinates of the unit cell spanned by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "1"], ",", 
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "2"], ",", 
    StyleBox[
     SubscriptBox["g", 
      StyleBox["3",
       FontWeight->"Plain"]],
     FontWeight->"Bold"]}], TraditionalForm]],ExpressionUUID->
  "6c35972d-f1f6-419e-ae06-6d05a4191c49"],
 " \[Element] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "8e04efbb-1e23-4e53-9645-ca97b7ec6bfd"],
 ". ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "j"], TraditionalForm]],ExpressionUUID->
  "daf0d6c0-5bbf-4e66-b497-08a6073fba8c"],
 Cell[BoxData[
  FormBox[
   RowBox[{"[", "||"}], TraditionalForm]],ExpressionUUID->
  "7722e8fa-d1ad-40f7-a523-b88e3d8bc7bc"],
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{"g", "||"}], " ", "]"}],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "4b951541-584b-4361-8a21-7e4e53034745"],
 " is the diffraction strength of atom number ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "d812d5bd-1574-410e-805d-6b9fc265f2dd"],
 ". It depends on the diffraction angle, represented by ",
 Cell[BoxData[
  FormBox[
   StyleBox["g",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "36e415ad-251e-4203-9ae2-1c4555a9425e"],
 ". Since the dependence of an individual atom\[CloseCurlyQuote]s diffraction \
strength not only depends on the atomic number (high ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "16815b5b-8d66-4ea6-92de-d14bd328f0eb"],
 " implies strong diffraction), but also on the lateral extension (\
\[OpenCurlyDoubleQuote]form\[CloseCurlyDoubleQuote]) of the atom, this is \
also called the \[OpenCurlyDoubleQuote]atom form factor.\
\[CloseCurlyDoubleQuote] For X-ray diffraction, atom form factors are \
tabulated (see below). The sum extends over all ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "c8dd6f4a-5959-42fe-8732-949009d27c59"],
 " atoms in the unit cell. ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "e8ba754b-7f5c-4c75-81de-49900d620c81"],
 "[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "] describes the superposition of diffracted waves from atoms with different \
diffraction strength and in different locations within the unit cell, thus \
carrying different phase shifts. Being a wave ",
 StyleBox["amplitude",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "a584411d-2cba-425d-8458-15e01c9e17c5"],
 "[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "] is generally complex-valued. The diffracted ",
 StyleBox["intensity",
  FontSlant->"Italic"],
 " of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"d8f18041-63f8-48e0-a715-b175a8d5256a"],
 " reflection output by one unit cell is obtained by taking the ",
 StyleBox["square",
  FontSlant->"Italic"],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{"S", "[", 
     StyleBox["g",
      FontWeight->"Bold"], "]"}], 
    SuperscriptBox["|", "2"]}], TraditionalForm]],ExpressionUUID->
  "9770090a-c9e3-4c69-aeb4-7c5f8be66581"],
 "."
}], "Text",ExpressionUUID->"4af93bdc-e998-4ff5-9fe9-ea460ad7950b"],

Cell[TextData[{
 "For example, let\[CloseCurlyQuote]s describe the A1 structure of Cu with an \
FCC lattice. For this lattice, we have for lattice points per unit cell, \
namely in (0,0,0), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"6d595c61-c2c0-4956-b2f0-fa857f2c03e8"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "db31ace4-ca28-46f3-b168-efde0de050a0"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "dcb52f8d-ac15-466d-b856-f1aa326b6894"],
 ". What is the unit-cell intensity of the (111) reflection, i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["g",
     FontWeight->"Bold"], " ", "=", 
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"], "+", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"], "+", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "13f64bff-06c1-4a99-82db-3961bd070f3b"],
 "? ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "j"], "[", 
    StyleBox["g",
     FontWeight->"Bold"], "]"}], TraditionalForm]],ExpressionUUID->
  "92138494-4583-4141-af2e-059d09f61d1d"],
 " is the same for all four atoms, since they are all Cu atoms. Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "j"], "[", 
     RowBox[{"||", 
      StyleBox["g",
       FontWeight->"Bold"], 
      StyleBox["||",
       FontWeight->"Bold"]}], "]"}], "=", 
    RowBox[{":", "f"}]}], TraditionalForm]],ExpressionUUID->
  "69b84d02-122c-4d2a-9e54-adb2a13ff12b"],
 ". Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "a05f261f-0ae4-43f7-9b1d-797a2ebccaa8"],
 ", (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"]}], "+", 
    RowBox[{"k", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"]}], "+", 
    RowBox[{"l", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "445a9f3e-59a3-4476-ab17-f36c94a6f9d5"],
 ") \[CenterDot] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"u", "\[CenterDot]", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "1"]}], "+", 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "2"]}], "+", 
     RowBox[{"w", "\[CenterDot]", 
      SubscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "b9dbe915-8929-49ab-83f9-a0c16f0246c3"],
 ") = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", " ", "u"}], "+", 
    RowBox[{"k", " ", "v"}], "+", 
    RowBox[{"l", " ", "w"}]}], TraditionalForm]],ExpressionUUID->
  "66c4b167-921b-4437-a077-3c856ad8ce1d"],
 ", just like an ordinary dot (scalar) product in a Cartesian coordinate \
system (which we do ",
 StyleBox["not",
  FontSlant->"Italic"],
 " assume here). Thus, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["g",
      FontWeight->"Bold"], "\[CenterDot]", 
     StyleBox["r",
      FontWeight->"Bold"]}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "41cac32b-07ad-4e2f-8c46-dd62aca01be4"],
 " for each of the atoms in  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"2c98d30e-3565-479b-881e-705e7a4d8191"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "c5c065cc-6b8f-49ab-b66e-25b780623bbc"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "6721bb5c-4462-4a77-8f09-12cd6ba9008a"],
 ". For the atom in (0,0,0), ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["g",
      FontWeight->"Bold"], "\[CenterDot]", 
     StyleBox["r",
      FontWeight->"Bold"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "2e91a7b4-e876-479b-acda-d19f00aaa5c3"],
 ". Thus, ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "9ee20f2f-cc12-4f43-ac7c-29d6182ecafc"],
 "[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "]",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"=", 
       RowBox[{
        RowBox[{"S", "[", 
         StyleBox["g",
          FontWeight->"Bold",
          FontSlant->"Italic"], "]"}], "=", 
        RowBox[{
         RowBox[{"f", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"i", " ", "\[CenterDot]", "0"}]}], "]"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"Exp", "[", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"i", " ", "\[CenterDot]", "1"}]}]}]}]}]}]}], ")"}], "]"}],
     "=", 
    RowBox[{"4", 
     RowBox[{"f", "."}]}]}], TraditionalForm]],ExpressionUUID->
  "16df2c8b-d58c-46b5-8f3c-98fd45535fb5"],
 "  So, we can expect a diffracted-beam intensity of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"16", 
     SuperscriptBox["f", "2"]}], " ", ">", " ", "0"}], TraditionalForm]],
  ExpressionUUID->"1088b212-7323-4955-ae28-00b54d7fde8a"],
 "."
}], "Text",ExpressionUUID->"bfcb4087-419f-46e9-affb-0df4be38e54f"],

Cell[TextData[{
 "However, if we try the same analysis for a (123) reflection, i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["g",
     FontWeight->"Bold"], " ", "=", 
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"], "+", 
     RowBox[{"2", 
      SuperscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "2"]}], "+", 
     RowBox[{"3", 
      SuperscriptBox[
       StyleBox["g",
        FontWeight->"Bold"], "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "56bdf841-50bf-41ca-915e-c19c81f88f76"],
 ",",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[" ",
     FontWeight->"Bold"], 
    RowBox[{
     RowBox[{
      RowBox[{
       StyleBox["g",
        FontWeight->"Bold"], "\[CenterDot]", 
       StyleBox["r",
        FontWeight->"Bold"]}], "=", 
      FractionBox["3", "2"]}], ",", 
     FractionBox["5", "2"], ",", "2"}]}], TraditionalForm]],ExpressionUUID->
  "7a65080f-fd7b-4bfd-91d4-7d321158283b"],
 " for the atoms in  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0"}], ")"}], TraditionalForm]],
  ExpressionUUID->"b5b8043c-adce-4225-9df0-858e60319b32"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "070750ae-36e6-4ad9-a615-02970d7cddb6"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", 
     FractionBox["1", "2"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "8c40fd5a-ee6f-4db1-929a-b8c855faf06a"],
 ". For the atom in (0,0,0), again, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["g",
      FontWeight->"Bold"], "\[CenterDot]", 
     StyleBox["r",
      FontWeight->"Bold"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "83231c58-c4df-4c6e-b075-d3bb64645e52"],
 ". This means that the sum in the expression for S[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "] now contains two terms in which the Exp function is it renovated for an \
odd multiple of 2\[Pi] i, yielding \[Dash]1, and two terms word is evaluate \
it for an even multiple of 2\[Pi] i, yielding +1. The result is zero. \
Therefore, although ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "1"], "+", 
    RowBox[{"2", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"]}], "+", 
    RowBox[{"3", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "4f326612-badf-424e-b932-f56834724aca"],
 " is a lattice point of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "a60262a5-8bd1-4fdc-9f97-70264c18f860"],
 ", no (123) reflection (or diffracted beam) can be expected to appear in the \
fraction patterns. Systematic evaluation of the expression for the S[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "] reveals that in order to obtain a beam of non-vanishing intensity, the \
indices must either be all odd or all even."
}], "Text",ExpressionUUID->"eacf2dd0-c78e-44ee-9541-fd969e060006"],

Cell["\<\
With the above definition of the Debye\[Dash]Waller factor, the effect of \
thermal oscillations on the diffracted amplitude of one unit cell containing \
any number of equal or different atoms can be included in the structure \
factor as \
\>", "Text",ExpressionUUID->"327a5cae-bf74-467b-b3d8-49d5cda71a50"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "a0ce7e07-47dd-4572-8163-62117047ed78"],
 "[",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "]:=",
 Cell[BoxData[
  UnderoverscriptBox["\[Sum]", 
   RowBox[{
    StyleBox["j",
     FontSlant->"Italic"], "=", "1"}], "N"]],ExpressionUUID->
  "6a4e6ec4-62b3-464e-8425-5cbf1ddc6ef0"],
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     SubscriptBox["f", "j"], "[", 
     RowBox[{"||", 
      StyleBox["g",
       FontWeight->"Bold"], 
      StyleBox["||",
       FontWeight->"Bold"]}], 
     StyleBox[" ",
      FontWeight->"Bold"], "]"}]}], TraditionalForm]],ExpressionUUID->
  "b1df61f8-a59f-4bad-be66-e1e120446771"],
 "\[CenterDot]Exp[-M]\[CenterDot]Exp[2\[Pi] i ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["g",
     FontWeight->"Bold"], 
    StyleBox["\[CenterDot]",
     FontWeight->"Bold"], 
    SubscriptBox[
     StyleBox["r",
      FontWeight->"Bold"], "j"]}], TraditionalForm]],ExpressionUUID->
  "0f48e80d-c042-43d9-a21e-9e966fc41f1f"],
 "]"
}], "Text",
 TextAlignment->Center,ExpressionUUID->"3f3d6d96-69f0-4984-bb3f-b05ee0d2757d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Factor \[Dash] Implementation", "Section",ExpressionUUID->"dbff5c4e-1223-42b8-9cc5-fda0e661f4ca"],

Cell[TextData[{
 "With complete information about the unit cell, we calculate the intensity \
modulation owing to the structure factor, i.e. the square of the structure \
factor, for a list of different reflections, i.e lattice vectors ",
 StyleBox["g",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " =  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "1"]}], "+", 
    RowBox[{"k", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "2"]}], "+", 
    RowBox[{"l", "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "3"]}]}], TraditionalForm]],ExpressionUUID->
  "a8d46d59-77cd-4f03-91f3-75ba81874bf2"],
 " \[Element] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "30b5c496-0580-4286-9ee4-d884cd7b619c"],
 ". "
}], "Text",ExpressionUUID->"d6b46a1a-b7f3-4d5e-9bf8-a823e618b775"],

Cell[TextData[{
 "The following function accepts 4 arguments, an association representing a \
unit cell, a list of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], " ", ")"}], TraditionalForm]],
  ExpressionUUID->"edefd1b1-0cbe-45fc-a9dc-f0eccbe3d5ef"],
 " indices, a string that identifies a set of temperature\[Dash]Debye-Waller \
data, and an absolute temperature. It outputs an association that contains \
the following data:"
}], "Text",ExpressionUUID->"4b7099ea-ee5b-4ebd-92bd-63c06d919e64"],

Cell[" The same list of index sets that was input as \
\[OpenCurlyDoubleQuote]lHKLs\[CloseCurlyDoubleQuote].", "Item",ExpressionUUID->\
"98f68ae6-5127-46af-bb41-958c8132e918"],

Cell[TextData[{
 "The corresponding ",
 Cell[BoxData[
  FormBox[
   StyleBox["g",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "9c82262b-f496-495b-9e0c-6033baef02f2"],
 " vectors as \"lGhkl\", described as components in the Cartesian system \
(while the indices describe ",
 Cell[BoxData[
  FormBox[
   StyleBox["g",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "639a2f38-7d1c-4730-ad43-76f4701b975e"],
 " vectors in the system of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "714941ed-484f-4463-ae8e-374133b943f5"],
 ")."
}], "Item",ExpressionUUID->"4f472639-8fd9-44f4-98a4-78242b622bb1"],

Cell[TextData[{
 "The length ",
 Cell[BoxData[
  FormBox[
   RowBox[{"||", 
    StyleBox["g",
     FontWeight->"Bold"], 
    StyleBox["||",
     FontWeight->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "fa89baa4-8b36-4f92-9f60-e4599b80b681"],
 " of these vectors as \"rGhkl,\" corresponding to the inverse plane spacing \
(in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "d2a9c764-96d9-4e43-8343-62fcf5cc994f"],
 "). "
}], "Item",ExpressionUUID->"72c775fa-1388-4353-a694-ab70ee33d7c7"],

Cell["The real value of the X-ray form factor as \"rFF.\" ", "Item",ExpressionUUID->"f9aaecac-d06c-4764-88e4-c1fe22022566"],

Cell["\<\
The complex-valued structure factor as \"cSF,\" which includes the form \
factor and the Debye-Waller Factors as factors.\
\>", "Item",ExpressionUUID->"6b7b7335-e5a5-4858-827d-c2a657d31676"],

Cell[CellGroupData[{

Cell[TextData[{
 "The real-valued intensity factor \[OpenCurlyDoubleQuote]rSFI\
\[CloseCurlyDoubleQuote] that describes how the structure factor modulates \
the intensity of the respective ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", " ", 
    RowBox[{"h", " ", "k", " ", "l"}], " ", ")"}], TraditionalForm]],
  ExpressionUUID->"78455126-dab6-4404-bb20-bf8e2322a196"],
 " reflection. This factor corresponds to the squared absolute of the \
complex-valued form factor times the squared Debye\[Dash]Waller Factor."
}], "Item",ExpressionUUID->"573a1a91-3cd8-4a27-9662-2c14d9cfb12d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lSF", "[", 
   RowBox[{"aUC_", ",", "lHKLs_", ",", "sDW_", ",", 
    RowBox[{"rT_", ":", "298"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "lHKLSF", ",", "lHKL", ",", "lg", ",", "rg", ",", "lr", ",", "cSF", ",", 
      "rfHKL", ",", "lPos", ",", "rFF", ",", "rDW", ",", "lLPt", ",", "sEl"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Empty", " ", "list", " ", "of", " ", "associations", " ", "of", " ", 
      "hkl", " ", "and", " ", "structure", " ", 
      RowBox[{"factors", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lHKLSF", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Iterate", " ", "over", " ", "all", " ", "reflections", " ", "in", " ", 
       "the", " ", "list", " ", 
       RowBox[{"lHKLs", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Current", " ", "plane", " ", 
        RowBox[{"normal", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"lHKL", "=", 
         RowBox[{
         "lHKLs", "\[LeftDoubleBracket]", "ihkl", "\[RightDoubleBracket]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"cSF", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Get", " ", "plane", " ", "normal", " ", 
          RowBox[{"(", 
           RowBox[{"g", "-", "vector"}], ")"}], " ", "in", " ", "Cartesian", 
          " ", 
          RowBox[{"coordinates", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{"lg", "=", 
         RowBox[{
          RowBox[{"aUC", "[", "\"\<lLp\>\"", "]"}], ".", "lHKL"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Get", " ", "spatial", " ", "frequency", " ", "as", " ", "length", 
          " ", "of", " ", 
          RowBox[{"lg", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rg", "=", 
         RowBox[{"Norm", "[", "lg", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Iterate", " ", "over", " ", "all", " ", "atoms", " ", "in", " ", 
           "the", " ", "basis"}], ",", " ", 
          RowBox[{
          "aUC", Cell[
           "[\"",ExpressionUUID->"77218a59-a136-4479-a676-aeb440f87fdc"], 
           "lBas", "\"\<]. \>"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Do", " ", "this", " ", "as", " ", "outer", " ", "loop", " ", "so", 
          " ", "we", " ", 
          RowBox[{"don", "'"}], "t", " ", "have", " ", "to", " ", "get", " ", 
          "the", " ", "form", " ", "factor", " ", "so", " ", 
          RowBox[{"frequently", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"sEl", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"aUC", "[", "\"\<lBas\>\"", "]"}], 
              "\[LeftDoubleBracket]", "iats", "\[RightDoubleBracket]"}], "[", 
             "\"\<sEl\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rFF", "=", " ", 
            FormBox[
             RowBox[{"rXFF", "[", " ", 
              RowBox[{
               RowBox[{"lXFFData", "[", "sEl", "]"}], ",", "rg"}], 
              StyleBox[" ",
               FontWeight->"Plain"], 
              StyleBox["]",
               FontWeight->"Plain"]}],
             TraditionalForm]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rDW", "=", "1"}], ";", "\[IndentingNewLine]", 
           StyleBox[
            RowBox[{"rDW", "=", 
             RowBox[{"rDWF", "[", 
              RowBox[{"sDW", ",", "rg", ",", "rT"}], "]"}]}],
            FontSize->12], 
           StyleBox[";",
            FontSize->12], "\[IndentingNewLine]", 
           RowBox[{"lPos", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"aUC", "[", "\"\<lBas\>\"", "]"}], 
              "\[LeftDoubleBracket]", "iats", "\[RightDoubleBracket]"}], "[", 
             "\"\<lPos\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Iterate", " ", "over", " ", "all", " ", "lattice", " ", 
              "points"}], ",", " ", 
             RowBox[{
             "aUC", Cell[
              "[\"",ExpressionUUID->"bb894605-e5e3-4f0f-9882-bcbef55fb6c1"], 
              "lPts", "\"\<]. \>"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"lLPt", "=", 
               RowBox[{
                RowBox[{"aUC", "[", "\"\<lPts\>\"", "]"}], 
                "\[LeftDoubleBracket]", "ipts", "\[RightDoubleBracket]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"lr", "=", 
               RowBox[{"lLPt", "+", "lPos"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"cSF", "+=", 
               RowBox[{"rFF", " ", "rDW", " ", 
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
                  RowBox[{"lr", ".", "lHKL"}]}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"ipts", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"aUC", "[", "\"\<lPts\>\"", "]"}], "]"}]}], "}"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"iats", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"aUC", "[", "\"\<lBas\>\"", "]"}], "]"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Only", " ", "keep", " ", "reflections", " ", "of", " ", "non"}], 
          "-", 
          RowBox[{"vanishing", " ", 
           RowBox[{"intensity", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "[", 
            SuperscriptBox[
             RowBox[{"Abs", "[", "cSF", "]"}], "2"], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"lHKLSF", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lHKLSF", ",", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<lHKL\>\"", "->", "lHKL"}], ",", 
               RowBox[{"\"\<lGhkl\>\"", "->", "lg"}], ",", 
               RowBox[{"\"\<rGhkl\>\"", "->", "rg"}], ",", 
               RowBox[{"\"\<rFF\>\"", "->", "rFF"}], ",", 
               RowBox[{"\"\<rDW\>\"", "->", "rDW"}], ",", 
               RowBox[{"\"\<SF\>\"", "->", 
                RowBox[{"Chop", "[", "cSF", "]"}]}], ",", 
               RowBox[{"\"\<rSFI\>\"", "->", 
                RowBox[{"Chop", "[", 
                 SuperscriptBox[
                  RowBox[{"Abs", "[", "cSF", "]"}], "2"], "]"}]}]}], "|>"}]}],
             "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ihkl", ",", 
         RowBox[{"Length", "[", "lHKLs", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "lHKLSF", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"cf21060c-460f-4cb9-878b-5eaaf633ee37"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Structures", "Subchapter",ExpressionUUID->"e8ba8802-daaf-4bd9-8c79-237c466f68c3"],

Cell[CellGroupData[{

Cell["Cu", "Section",ExpressionUUID->"9cffb08f-5ab1-40e3-a292-b4ff0bc9ff70"],

Cell["\<\
Copper has the A1 structure, which is usually described by FCC lattice. The \
unit cell can be described by the following \
\[OpenCurlyDoubleQuote]association,\[CloseCurlyDoubleQuote] formulated in a \
way that it will be easily expandable to other crystal systems:\
\>", "Text",ExpressionUUID->"7fdeda8c-84e2-4c9e-8473-72a4dafc1db8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCCu", "=", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<lLd\>\"", "->", 
       RowBox[{"a0", " ", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
      RowBox[{"\"\<lPts\>\"", "->", 
       RowBox[{"a0", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "2"], ",", 
            FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["1", "2"], ",", 
            FractionBox["1", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "2"], ",", "0", ",", 
            FractionBox["1", "2"]}], "}"}]}], "}"}]}]}], ",", 
      RowBox[{"\"\<lBas\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<sEl\>\"", "->", "\"\<Cu\>\""}], ",", 
          RowBox[{"\"\<lPos\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"\"\<rOcc\>\"", "->", "1.0"}]}], "|>"}], " ", "}"}]}]}], 
     "|>"}], "/.", 
    RowBox[{"a0", "->", "0.3615"}]}]}], ";"}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"996c1f03-f2c3-41bb-aaf8-91898acee417"],

Cell[TextData[{
 "Here, \[OpenCurlyDoubleQuote]lLd\[CloseCurlyDoubleQuote] is the lattice ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "fbb4521f-7693-4603-9d78-e9820cb94cb8"],
 ", given a list of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "059409e1-24f9-4583-9e0f-7cf93684443e"],
 ", described in a Cartesian coordinate system. The fundamental translations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "30d30b20-f51b-417c-9da4-d4298a1a402b"],
 "of the FCC lattice actually span a Cartesian coordinate system, where each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "10fe6c54-e0a1-4749-a6fe-74f2f762f7a9"],
 " has the length of the lattice parameter ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "0"], TraditionalForm]],ExpressionUUID->
  "808eb382-f8a9-413b-9c96-32c5600b0e0d"],
 "=0.3615 nm. We can recall one of them, e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "92eeeb32-c10c-46c0-a4b8-0aec78543269"],
 ", like this:"
}], "Text",ExpressionUUID->"3ff25d4b-1ce7-46ca-8c1f-5fca94cece7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCCu", "[", "\"\<lLd\>\"", "]"}], "\[LeftDoubleBracket]", "2", 
   "\[RightDoubleBracket]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"b33b3d7a-9e8e-4ebe-9bfb-517a47831e8f"],

Cell[TextData[{
 "In aUCCu, meaning \[OpenCurlyDoubleQuote]association \[Dash] unit cell \
\[Dash] Cu,\[CloseCurlyDoubleQuote] \[OpenCurlyDoubleQuote]lPts,\
\[CloseCurlyDoubleQuote] meaning \[OpenCurlyDoubleQuote]list \[Dash] (lattice \
points\[CloseCurlyDoubleQuote] is a list of lattice points included in the \
unit cell. Their coordinates are given relative to the coordinate system \
established by the unit cell. There are four lattice point included, one in \
the origin and one in the center of each cube face adjacent to the origin. \
The basis, thus the group of atoms to be attached to each lattice point, is \
included as a list \[OpenCurlyDoubleQuote]lBas\[CloseCurlyDoubleQuote] of \
atoms. Each atom is described by an association. In this association, \
\[OpenCurlyDoubleQuote]sEl\[CloseCurlyDoubleQuote] is the name (string) of \
the element, \[OpenCurlyDoubleQuote]lPos\[CloseCurlyDoubleQuote] is the \
position relative to the lattice point, expressed as a list of three \
coordinates in the coordinate system of the cell, and the real number \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote] is an occupancy factor. \
The occupancy factor can be used to describe alloys in the sense of solid \
solutions. For example, consider a hypothetical alloy with the crystal \
structure of copper, but 2% of all atoms are Al. Then, we would specify two \
atoms, both in the position {0,0,0}, one with \[OpenCurlyDoubleQuote]sEl\
\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "ab0a1183-4acc-4e43-9592-845535b74b08"],
 "\[CloseCurlyDoubleQuote]Cu\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "2fc6de50-0dfb-4d55-8bab-d1212f5fa44b"],
 "0.98, the other one with \[OpenCurlyDoubleQuote]sEl\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "1c9e56b2-06f3-4bfc-a38f-58f607502bcd"],
 "\[CloseCurlyDoubleQuote]Al\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "784ba9c2-54ae-4832-b8fa-28b9235fd10a"],
 "0.02.  Generally, the list of atoms that constitute the basis can be as \
long as we wish.  For pure Cu, of course, there is only one atom. It\
\[CloseCurlyQuote]s position \[OpenCurlyDoubleQuote]lPos\
\[CloseCurlyDoubleQuote] is indicated as {0,0,0}. However, that is only one \
possible choice. Any other position of the Cu atoms relative to the lattice \
points would work as well (as long as it is the same for each lattice \
point)."
}], "Text",ExpressionUUID->"6b676614-1df7-4c51-9157-283680533874"],

Cell[TextData[{
 "What is not yet included in aUCCu is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "89d0a7d0-6f01-49c0-b9d5-785d60b903ab"],
 ". We first need to calculate it, requiring ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "1317ac82-c4d3-4aa3-b90b-8c0620961d64"],
 ", and then add it to aUCCu:"
}], "Text",ExpressionUUID->"239ac4ba-8d33-4d0d-a89a-ba6d783f3e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"aUCCu", ",", 
    RowBox[{"\"\<lLp\>\"", "->", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{
       RowBox[{"aUCCu", "[", "\"\<lLd\>\"", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"ca254e32-4a76-4b11-8a59-ebf48f00dcc4"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s see what ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "12253e93-9016-47d9-a9b1-849747e0cc59"],
 " looks like."
}], "Text",ExpressionUUID->"a6e583a2-1e50-4f1b-86af-6a17a148cdc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCCu", "[", "\"\<lLp\>\"", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"a180744b-24c7-4133-a04d-1eee76d1ee97"],

Cell[TextData[{
 "The diagonal of this matrix shows the norms of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "5a819316-f235-4c4b-b55d-b12fb577ab3a"],
 " in units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["nm", 
     RowBox[{"-", "1"}]], "."}], TraditionalForm]],ExpressionUUID->
  "2713e1c8-8b34-4b9a-85dc-c5bdcfc167b7"],
 " Let\[CloseCurlyQuote]s verify that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "bedc29d3-1646-4269-bf50-6e3af0056c70"],
 " is fulfilled."
}], "Text",ExpressionUUID->"a69fbdc4-c694-4ff1-befa-288d9fec8336"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCCu", "[", "\"\<lLp\>\"", "]"}], ".", 
   RowBox[{"aUCCu", "[", "\"\<lLd\>\"", "]"}]}], "==", 
  RowBox[{"IdentityMatrix", "[", "3", "]"}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"0a58cf16-f9ba-4a66-9848-815e1da61143"],

Cell[TextData[{
 "Create a list of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"f11a455f-5dd0-40aa-b9dd-4ce56b44cdd3"],
 " reflections with indices \[LessEqual] 5. The call to DeleteCases deletes \
{0,0,0}, as we don\[CloseCurlyQuote]t want to see an overly bright central \
spot in the diffraction patterns later."
}], "Text",ExpressionUUID->"cf6ef08e-5aeb-4559-92a0-871f99b4e6fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iHKL", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lHKLs", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", "k", ",", "l"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"0602f5b9-71ed-41eb-b9bf-86be2814827a"],

Cell["Get structure factor data at room temperature.", "Text",ExpressionUUID->"17702847-02b4-4e27-8845-66e520c74b5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lSFCu", "=", 
   RowBox[{"lSF", "[", 
    RowBox[{"aUCCu", ",", "lHKLs", ",", " ", "\"\<Cu-A1\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"8da88dc7-596d-480e-810c-6faa62df41ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ti", "Section",ExpressionUUID->"c1d86bd4-fa76-400b-9849-8faeda7f3944"],

Cell[TextData[{
 "The titanium alloy ",
 ButtonBox["Ti-6Al-4V",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://en.wikipedia.org/wiki/Ti-6Al-4V"], None},
  ButtonNote->"https://en.wikipedia.org/wiki/Ti-6Al-4V"],
 " generally includes two phases (spatially distinct microscopic regions) of \
different crystal structures (and potentially different composition). They \
are known as alpha-phase and beta-phase. The crystal structure of alpha is \
HCP (hexagonal-close-packed), while that of beta is BCC (body-centered \
cubic). "
}], "Text",ExpressionUUID->"93b4fe56-f4c0-4c2a-b5f5-4fcd0e908625"],

Cell[CellGroupData[{

Cell["Alpha", "Subsection",ExpressionUUID->"92bee894-8384-4316-b872-79a7085d8180"],

Cell["aUCTiAlpha stands for \[OpenCurlyDoubleQuote]association \[Dash] unit \
cell \[Dash] Ti-Alpha.\[CloseCurlyDoubleQuote] ", "Text",ExpressionUUID->\
"c12a752e-7c4d-4561-9156-3d2e86e676a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCTiAlpha", "=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<lLd\>\"", "->", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a0", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], ",", 
             RowBox[{"-", 
              FractionBox[
               SqrtBox["3"], "2"]}], ",", "0"}], "}"}]}], ",", 
          RowBox[{"a0", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"c0", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}], " ",
       ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<lPts\>\"", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "3"], ",", 
           FractionBox["2", "3"], ",", 
           FractionBox["1", "4"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["2", "3"], ",", 
           FractionBox["1", "3"], ",", 
           FractionBox["3", "4"]}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<lBas\>\"", "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Ti\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.90"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Al\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.06"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<V\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.04"}]}], "|>"}]}], " ", "}"}]}]}],
      "|>"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "->", "0.2928"}], ",", 
      RowBox[{"c0", "->", "0.4679"}]}], "}"}]}]}], ";"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"d6b786eb-babd-45ec-8c1b-b4d734aebb7b"],

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]lLd\[CloseCurlyDoubleQuote] is the lattice ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "6e946f12-c2c9-4a33-9a34-277758bc1963"],
 ", given a list of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "b122318c-26c8-46f2-8c49-ba3f82e70253"],
 ", described in a Cartesian coordinate system. The fundamental translations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "41983a3c-5554-4e4a-8e9b-807d6f8663f7"],
 "of the HCP lattice actually span an oblique coordinate system, where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "1"], TraditionalForm]],ExpressionUUID->
  "39bd7f10-e8f5-45c3-9cb9-5a25e6579e18"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "dae24ab3-7a28-4d50-9c98-2fda3971e741"],
 " have the length of the lattice parameter ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "0"], TraditionalForm]],ExpressionUUID->
  "7bbce239-c988-4b9c-862c-667a497a6557"],
 "=0.2928 nm and make an angle of 120\[Degree]. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "3"], TraditionalForm]],ExpressionUUID->
  "4d2d96f6-f6bd-43c7-8972-651eeba8cae4"],
 " has the length of the lattice parameter ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "0"], "=", 
    RowBox[{"0.4679", " ", "nm"}]}], TraditionalForm]],ExpressionUUID->
  "e83c5919-e2c7-4284-b9a5-2ceb61e7f9fa"],
 " and makes 90\[Degree] angles with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "1"], TraditionalForm]],ExpressionUUID->
  "fa03f7c5-f4df-4a57-aa91-d6dfde420640"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "d4e79f56-6821-4ab3-bfd7-1dd873331d33"],
 ". By crystallographic convention, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["g",
      FontWeight->"Bold"], "2"], " ", "is", " "}], TraditionalForm]],
  ExpressionUUID->"c57d98d5-67c0-4d96-bc23-2854fed01a0e"],
 " chosen parallel to the x-axis of the Cartesian coordinate system. The ",
 StyleBox["columns",
  FontSlant->"Italic"],
 " of the matrix lLd are the components of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "de69393f-ebcb-49a0-a11f-adb61f848757"],
 " in the Cartesian coordinate system. Dot-multiplying lLd with a lattice \
direction/point (u,v,w) will resolve it in the coordinates of the Cartesian \
frame. We can recall lLd like this: "
}], "Text",ExpressionUUID->"05c1ae40-0b55-4933-918b-68fb1bd3409f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "aUCTiAlpha", "\[LeftDoubleBracket]", "\"\<lLd\>\"", 
   "\[RightDoubleBracket]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"b3fd8cd5-83bd-45ee-b6a8-53b450840af1"],

Cell["\<\
\[OpenCurlyDoubleQuote]lPts,\[CloseCurlyDoubleQuote] meaning \
\[OpenCurlyDoubleQuote]list \[Dash] lattice points,\[CloseCurlyDoubleQuote] \
is the list of lattice points included in the unit cell. Their coordinates \
are given relative to the coordinate system established by the unit cell. \
There are 2 lattice points included in the \[OpenCurlyDoubleQuote]hexagonal\
\[CloseCurlyDoubleQuote] unit cell we set up here. The basis, thus the group \
of atoms to be attached to each lattice point, is included as a list \
\[OpenCurlyDoubleQuote]lBas\[CloseCurlyDoubleQuote] of atoms. There is only 1 \
atom position in the basis. To model the composition Ti-6Al-4V, a Ti atom, a \
Al atom, and a V atom are assumed to sit in each position with corresponding \
occupancy. Each atom is described by an association. In this association, \
\[OpenCurlyDoubleQuote]sEl\[CloseCurlyDoubleQuote] is the name (string) of \
the element, \[OpenCurlyDoubleQuote]lPos\[CloseCurlyDoubleQuote] is the \
position relative to the lattice point, expressed as a list of three \
coordinates in the coordinate system of the cell, and the real number \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote] is the occupancy factor. \
\
\>", "Text",ExpressionUUID->"196bd9a2-7c0f-439f-a48d-c91c006d85b6"],

Cell[TextData[{
 "What is not yet included in aUCTiAlpha is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "3509dc35-5826-4001-8263-553cdee83080"],
 ". We first need to calculate it, requiring ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "73703021-ee4d-4baf-be24-8f76c3802510"],
 ", and then add it to aUCTiAlpha. Transposition is needed so that lLp \
behaves in the same way as lLd, namely that lLp.(h,k,l) will resolve the \
plane normal (h,k,l) in the Cartesian frame. (Without transposition, this \
would be obtained by (h,k,l).lLp, owing to m.v == v.Transpose[m].)"
}], "Text",ExpressionUUID->"d9c0122a-2e4a-49b7-bed3-8796a5fd5334"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"aUCTiAlpha", ",", 
    RowBox[{"\"\<lLp\>\"", "->", 
     RowBox[{"Transpose", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{
        RowBox[{"aUCTiAlpha", "[", "\"\<lLd\>\"", "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"c442432f-99f2-4c69-a495-3cf8793f3f7f"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s see what ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "6b007807-7eea-4b8b-90bc-c25b78b79802"],
 " looks like."
}], "Text",ExpressionUUID->"8905f18f-ad8e-4139-834f-c6e2baca1951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCTiAlpha", "[", "\"\<lLp\>\"", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"278c8dd6-91e7-45f7-880a-018e1d645f1c"],

Cell[TextData[{
 "Create a list of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"a04d926b-d072-45f5-b517-9a795d1b407e"],
 " reflections with indices \[LessEqual] iHKL=4.  The call to DeleteCases \
deletes {0,0,0}, as we don\[CloseCurlyQuote]t want to see an overly bright \
central spot in the diffraction patterns later."
}], "Text",ExpressionUUID->"e0820102-b316-46ed-b283-86a930279eae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iHKL", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lHKLs", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", "k", ",", "l"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"c72e8d2a-dd36-4223-972b-5329d355cce4"],

Cell["Get structure factor data.", "Text",ExpressionUUID->"39b01bb3-5e30-459c-9555-7b93031e0301"],

Cell[BoxData[
 RowBox[{"lSFTiAlpha", "=", 
  RowBox[{"lSF", "[", 
   RowBox[{"aUCTiAlpha", ",", "lHKLs", ",", "\"\<Ti-A3\>\""}], 
   "]"}]}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"c9354936-1b1d-4bde-af9e-c3413fc03097"],

Cell[BoxData[{
 RowBox[{"Select", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<lHKL\>\"", "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<lHKL\>\"", "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<lHKL\>\"", "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<lHKL\>\"", "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<lHKL\>\"", "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "&"}]}], "]"}]}], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"6b0dc8ea-9c60-4aaa-ba29-ed931248bdae"],

Cell["Sort by plane spacing.", "Text",ExpressionUUID->"3f7b085a-b4fd-4c5c-b1a8-0fbd6688097e"],

Cell[BoxData[
 RowBox[{"SortBy", "[", 
  RowBox[{"lSFTiAlpha", ",", 
   RowBox[{
    RowBox[{"#", "[", "\"\<rGhkl\>\"", "]"}], "&"}]}], "]"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"2c58827c-c527-4009-a2c2-a265ef7384ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Beta", "Subsection",ExpressionUUID->"78d994e5-60fe-417a-bf90-420961959096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCTiBeta", "=", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<lLd\>\"", "->", 
       RowBox[{"a0", " ", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
      RowBox[{"\"\<lPts\>\"", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<lBas\>\"", "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Ti\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.90"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Al\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.06"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<V\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.04"}]}], "|>"}]}], " ", "}"}]}]}],
      "|>"}], "/.", 
    RowBox[{"a0", "->", "0.323"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.92274364579557*^9, 3.9227436460300903`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"4cc7ba87-b4ff-4bd9-ac95-6bd0c6e45c28"],

Cell[TextData[{
 "Here, \[OpenCurlyDoubleQuote]lLd\[CloseCurlyDoubleQuote] is the lattice ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "2d954eef-c38c-4547-a7b2-e34d6d4e42ba"],
 ", given a list of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "76fba380-1275-4687-80c7-bbc836262266"],
 ", described in a Cartesian coordinate system. The fundamental translations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "456144a7-0b81-443e-a21c-db9e702796c4"],
 "of the BCC lattice actually span a Cartesian coordinate system, where each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "8122f5d9-3014-4fd1-939c-11e87ee2c3a6"],
 " has the length of the lattice parameter ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "0"], TraditionalForm]],ExpressionUUID->
  "2067024a-2aa6-4885-8be9-089ebef27efb"],
 "=0.323 nm. We can recall one of them, e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "be1241e6-907b-4045-b165-3b5a83c4c6d2"],
 ", like this:"
}], "Text",ExpressionUUID->"ecd2e5c1-8d88-4dbf-ada2-00ca7e65378d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCTiBeta", "[", "\"\<lLd\>\"", "]"}], "\[LeftDoubleBracket]", 
   "2", "\[RightDoubleBracket]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"52322a5e-f4f6-496e-a9f9-bf1a678730ce"],

Cell[TextData[{
 "In aUCTiBeta, meaning \[OpenCurlyDoubleQuote]association \[Dash] unit cell \
\[Dash] Ti,\[CloseCurlyDoubleQuote] \[OpenCurlyDoubleQuote]lPts,\
\[CloseCurlyDoubleQuote] meaning \[OpenCurlyDoubleQuote]list \[Dash] (lattice \
points\[CloseCurlyDoubleQuote] is a list of lattice points included in the \
unit cell. Their coordinates are given relative to the coordinate system \
established by the unit cell. There are four lattice point included, one in \
the origin and one in the center of each cube face adjacent to the origin. \
The basis, thus the group of atoms to be attached to each lattice point, is \
included as a list \[OpenCurlyDoubleQuote]lBas\[CloseCurlyDoubleQuote] of \
atoms. Each atom is described by an association. In this association, \
\[OpenCurlyDoubleQuote]sEl\[CloseCurlyDoubleQuote] is the name (string) of \
the element, \[OpenCurlyDoubleQuote]lPos\[CloseCurlyDoubleQuote] is the \
position relative to the lattice point, expressed as a list of three \
coordinates in the coordinate system of the cell, and the real number \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote] is an occupancy factor. \
The occupancy factor can be used to describe alloys in the sense of solid \
solutions. For example, consider a hypothetical alloy with the crystal \
structure of copper, but 2% of all atoms are Al. Then, we would specify two \
atoms, both in the position {0,0,0}, one with \[OpenCurlyDoubleQuote]sEl\
\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "71279d75-f063-4f64-ab85-1d6c0fd342cd"],
 "\[CloseCurlyDoubleQuote]Cu\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "513dceb1-f6b2-47eb-ba75-f0894ce25b0c"],
 "0.98, the other one with \[OpenCurlyDoubleQuote]sEl\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "a87d10cc-f33f-483c-b056-7abbc033cac8"],
 "\[CloseCurlyDoubleQuote]Al\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]rOcc\[CloseCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["->", TraditionalForm]],ExpressionUUID->
  "958c0255-0f06-4524-a919-46338c147d0f"],
 "0.02.  Generally, the list of atoms that constitute the basis can be as \
long as we wish.  For pure Cu, of course, there is only one atom. It\
\[CloseCurlyQuote]s position \[OpenCurlyDoubleQuote]lPos\
\[CloseCurlyDoubleQuote] is indicated as {0,0,0}. However, that is only one \
possible choice. Any other position of the Cu atoms relative to the lattice \
points would work as well (as long as it is the same for each lattice \
point)."
}], "Text",ExpressionUUID->"d2737406-9446-455b-b3b1-8ab152157fd7"],

Cell[TextData[{
 "What is not yet included in aUCTiBeta is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "c146415e-b8a7-48ff-8630-5f4924f94f2c"],
 ". We first need to calculate it, requiring ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "0dd27f90-549c-4564-b914-8ba2d3f9a704"],
 ", and then add it to aUCTiBeta:"
}], "Text",ExpressionUUID->"ac5b836b-29df-4d2b-beb1-499304275793"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"aUCTiBeta", ",", 
    RowBox[{"\"\<lLp\>\"", "->", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{
       RowBox[{"aUCTiBeta", "[", "\"\<lLd\>\"", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"dc431b93-97a1-4d0d-8e2b-8633395ff3ca"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s see what ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "c1f4bda6-f00d-423d-af54-8507d2950c80"],
 " looks like."
}], "Text",ExpressionUUID->"583a5012-19d4-48f4-af6b-d39a20f6e0e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCTiBeta", "[", "\"\<lLp\>\"", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"02e2c434-909c-4318-8c32-7c9272bfee14"],

Cell[TextData[{
 "The diagonal of this matrix shows the norms of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "76d0d9cc-9a0d-4ab0-a36e-001275c92476"],
 " in units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["nm", 
     RowBox[{"-", "1"}]], "."}], TraditionalForm]],ExpressionUUID->
  "33930f73-6152-45bc-82c3-8c54a70950e8"],
 " Let\[CloseCurlyQuote]s verify that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "dc232b29-937f-4b56-9506-0892376b4ede"],
 " is fulfilled."
}], "Text",ExpressionUUID->"39e97277-3063-4a13-9e9a-1c32d02a3ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCTiBeta", "[", "\"\<lLp\>\"", "]"}], ".", 
   RowBox[{"aUCTiBeta", "[", "\"\<lLd\>\"", "]"}]}], "==", 
  RowBox[{"IdentityMatrix", "[", "3", "]"}]}]], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"bd49c567-60d4-48fd-a0c0-23626188ac4a"],

Cell[TextData[{
 "Create a list of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"5784d9d1-f629-4b1e-a5f6-fdfcf94ed78b"],
 " reflections with indices \[LessEqual] 5.  The call to DeleteCases deletes \
{0,0,0}, as we don\[CloseCurlyQuote]t want to see an overly bright central \
spot in the diffraction patterns later."
}], "Text",ExpressionUUID->"31babde8-03f9-4127-ba2e-0d6d972a1401"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iHKL", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lHKLs", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", "k", ",", "l"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"a6df6d80-4ee5-461a-9e3e-8a227ca49c0f"],

Cell["Get structure factor data.", "Text",ExpressionUUID->"d759411d-30fe-4d08-8a22-965742833be8"],

Cell[BoxData[
 RowBox[{"lSFTiBeta", "=", 
  RowBox[{"lSF", "[", 
   RowBox[{"aUCTiBeta", ",", "lHKLs", ",", "\"\<Ti-A3\>\""}], 
   "]"}]}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"a46b1df5-06ac-4aeb-8b71-8bff9c88f597"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Austenite", "Section",ExpressionUUID->"95f5efd3-3814-488e-877b-2b4c7506a51f"],

Cell["Austenite has the A1 structure, like Cu.", "Text",ExpressionUUID->"50892568-d25b-43ab-89f2-2ec32bd2f114"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCAust", "=", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<lLd\>\"", "->", 
       RowBox[{"a0", " ", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
      RowBox[{"\"\<lPts\>\"", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "2"], ",", "0", ",", 
           FractionBox["1", "2"]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<lBas\>\"", "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Fe\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.70"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Cr\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.18"}]}], "|>"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<sEl\>\"", "->", "\"\<Ni\>\""}], ",", 
           RowBox[{"\"\<lPos\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<rOcc\>\"", "->", "0.12"}]}], "|>"}]}], " ", "}"}]}]}],
      "|>"}], "/.", 
    RowBox[{"a0", "->", "0.3600"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.922743862163157*^9, 3.9227438622600517`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"dd9fd867-d397-4a82-a6e4-31e164de376c"],

Cell[TextData[{
 "Here, \[OpenCurlyDoubleQuote]lLd\[CloseCurlyDoubleQuote] is the lattice ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "d"], TraditionalForm]],ExpressionUUID->
  "d1f09a20-51bb-4bbf-87b4-02f6eb2d8b5c"],
 ", given a list of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "41f8b01c-ea92-42e6-b5ce-2f32178b53b6"],
 ", described in a Cartesian coordinate system. The fundamental translations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "5b59ae71-c81d-47bc-aed6-3677971086b8"],
 "of the FCC lattice actually span a Cartesian coordinate system, where each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "ecd1c232-06ff-4414-bafd-5427c6492da0"],
 " has the length of the lattice parameter ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "0"], TraditionalForm]],ExpressionUUID->
  "5ffc2970-7e10-4ff0-bba3-ebe8ce36e3d0"],
 "=0.3615 nm. We can recall one of them, e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "2"], TraditionalForm]],ExpressionUUID->
  "dc7903e7-6cda-44af-90ad-00cc8732a439"],
 ", like this:"
}], "Text",ExpressionUUID->"0e16aa0f-9eb7-40de-acb1-4b454e931267"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCAust", "[", "\"\<lLd\>\"", "]"}], "\[LeftDoubleBracket]", "2", 
   "\[RightDoubleBracket]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"b5abd95f-1d27-4840-9e83-6c7829734139"],

Cell[TextData[{
 "What is not yet included in aUCAust is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "0f0e5ab1-4b7d-49a1-93c7-f06d7fe19e3b"],
 ". We first need to calculate it, requiring ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "ceb404db-ca07-43f3-8c80-a0de86786611"],
 ", and then add it to aUCAust:"
}], "Text",ExpressionUUID->"43a3a9ef-5ecb-48d6-9981-e238765ddc6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"aUCAust", ",", 
    RowBox[{"\"\<lLp\>\"", "->", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{
       RowBox[{"aUCAust", "[", "\"\<lLd\>\"", "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"ea8f5cc1-01f9-4b8b-acd7-de8708c4f6fa"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s see what ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["L", "p"], TraditionalForm]],ExpressionUUID->
  "2b6181ca-d2eb-4d25-a2de-a9619dc5554f"],
 " looks like."
}], "Text",ExpressionUUID->"11f955ff-26e7-4fd0-afd5-e46af1cf3b78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aUCAust", "[", "\"\<lLp\>\"", "]"}], "//", "MatrixForm"}]], "Input",\

 CellLabel->"In[68]:=",ExpressionUUID->"fba067fc-42f9-4fd6-bb76-5fbcae4d4e4a"],

Cell[TextData[{
 "The diagonal of this matrix shows the norms of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["g",
     FontWeight->"Bold"], "i"], TraditionalForm]],ExpressionUUID->
  "395874e6-060f-4709-8f0c-1135c546f184"],
 " in units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["nm", 
     RowBox[{"-", "1"}]], "."}], TraditionalForm]],ExpressionUUID->
  "4f772e69-dbf4-457f-ab11-4d4395504433"],
 " Let\[CloseCurlyQuote]s verify that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "i"], "\[CenterDot]", 
     SubscriptBox[
      StyleBox["g",
       FontWeight->"Bold"], "k"]}], "=", 
    SuperscriptBox[
     SubscriptBox["\[Delta]", "k"], "i"]}], TraditionalForm]],ExpressionUUID->
  "e1e905ee-84ec-422b-8922-23e95e53a19b"],
 " is fulfilled."
}], "Text",ExpressionUUID->"af300645-deda-47bc-bf6e-4e1196e4015a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aUCAust", "[", "\"\<lLp\>\"", "]"}], ".", 
   RowBox[{"aUCAust", "[", "\"\<lLd\>\"", "]"}]}], "==", 
  RowBox[{"IdentityMatrix", "[", "3", "]"}]}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"94225b4d-cdf2-41b8-83ea-456792abdfef"],

Cell[TextData[{
 "Create a list of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "k", " ", "l"}], ")"}], TraditionalForm]],
  ExpressionUUID->"023ad4e8-ef0b-4f77-afec-83cc498e1c9a"],
 " reflections with indices \[LessEqual] 5. The call to DeleteCases deletes \
{0,0,0}, as we don\[CloseCurlyQuote]t want to see an overly bright central \
spot in the diffraction patterns later."
}], "Text",ExpressionUUID->"b18c42d2-c2ec-4be0-8ccc-2fb2b4d8b31d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iHKL", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lHKLs", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", "k", ",", "l"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"-", "iHKL"}], ",", "iHKL"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"05a8ca48-982d-404e-ab58-fce0a7869514"],

Cell["Get structure factor data at room temperature.", "Text",ExpressionUUID->"2c5992b4-47a4-4be5-883d-43a8e6a5d312"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lSFAust", "=", 
   RowBox[{"lSF", "[", 
    RowBox[{"aUCAust", ",", "lHKLs", ",", " ", "\"\<Fe-A1\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"fee00ff6-4b8e-4148-8ac2-5475e114a030"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Microstructure", "Chapter",ExpressionUUID->"0471f7cb-dbe4-488d-b03e-6b5cba62118b"],

Cell[CellGroupData[{

Cell["Random Orientations", "Section",ExpressionUUID->"45a223e8-e051-42c2-90a6-d74cb56ea063"],

Cell[CellGroupData[{

Cell["Random Unit Vector", "Subsection",ExpressionUUID->"48225956-0b47-44ce-b538-e8a6107e8996"],

Cell[TextData[{
 "Imagine a uniform random distribution of points over the surface of the \
earth, idealized as a sphere. Their longitudes \[Phi] will be equally \
distributed. However, the latitudes will not be equally distributed. They \
will be distributed proportionally to Cos[\[Theta]]. Based on this insight, \
the following function produces ",
 StyleBox["randomly",
  FontSlant->"Italic"],
 " oriented unit vectors with ",
 StyleBox["uniform",
  FontSlant->"Italic"],
 " distribution."
}], "Text",
 CellChangeTimes->{{3.907071306023221*^9, 
  3.907071306644697*^9}},ExpressionUUID->"1a794595-2980-443f-a9bc-\
cd21b57e5926"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eRnd", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Theta]", ",", "\[Xi]", ",", "s"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Xi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"Sign", "[", "s", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["\[Xi]", "2"]}]], 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["\[Xi]", "2"]}]], 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "\[Xi]"}], "}"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"b6068f96-5fca-4567-a9db-5d8079d41531"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random Orientation", "Subsection",ExpressionUUID->"566185c7-84e2-4080-9275-74587b2290eb"],

Cell[TextData[{
 "Cartesian frames with ",
 StyleBox["uniformly distributed",
  FontSlant->"Italic"],
 " random orientations can be produced by generating two independent random \
unit vectors and taking cross products thereof."
}], "Text",
 CellChangeTimes->{
  3.907071327928175*^9},ExpressionUUID->"eb2d9291-a251-489a-9b17-\
05a5483b888f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oRnd", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e1", "=", 
      RowBox[{"eRnd", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e2", "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{"e1", ",", 
         RowBox[{"eRnd", "[", "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e3", "=", 
      RowBox[{"Cross", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"1aa15f04-25bc-48ca-be99-3e71e56c8395"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grain Size Distribution", "Section",ExpressionUUID->"22af09ae-9717-4a04-9c05-abff1469e405"],

Cell[TextData[{
 "Grain size distribution. Grain volume scales with ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "3"], TraditionalForm]],ExpressionUUID->
  "38c25735-8dc4-4afd-9776-2ff373ce55bc"],
 ". Grain radius cannot be negative. A Normal Distribution is probably not a \
great model. "
}], "Text",ExpressionUUID->"01b12c0c-eaf4-409d-986b-00bc74a23263"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"10", ",", "2"}], "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "20"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], "]"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"f18d2c6e-2e77-42f5-b01f-be3d5a0e3371"],

Cell["\<\
A better model, which e.g. fits empirically to grain sizes in sand, is a \
Weibull distribution.\
\>", "Text",ExpressionUUID->"2b160b18-104b-4c78-86cf-68ce3c0b648b"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lineStyleMean", "=", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lineStyleStdv", "=", 
       RowBox[{"{", 
        RowBox[{"Thin", ",", "Blue", ",", "Dashed"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"scal", " ", 
        RowBox[{"Mean", "[", 
         RowBox[{"WeibullDistribution", "[", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]", "=", 
       RowBox[{"scal", " ", 
        RowBox[{"StandardDeviation", "[", 
         RowBox[{"WeibullDistribution", "[", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"muMark", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "1"}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stdvMinusMark", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]", "-", "\[Sigma]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]", "-", "\[Sigma]"}], ",", "1"}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stdvPlusMark", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]", "+", "\[Sigma]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Mu]", "+", "\[Sigma]"}], ",", "1"}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "scal"], 
             RowBox[{"PDF", "[", 
              RowBox[{
               RowBox[{"WeibullDistribution", "[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
               FractionBox["x", "scal"]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"10", " ", "scal"}]}], "}"}], ",", 
            RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "800"}], "}"}], ",", "All"}], "}"}]}], ",", 
            
            RowBox[{"PlotLabel", "->", "\"\<PDF\>\""}], ",", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"CDF", "[", 
             RowBox[{
              RowBox[{"WeibullDistribution", "[", 
               RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
              FractionBox["x", "scal"]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"10", " ", "scal"}]}], "}"}], ",", 
            RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "800"}], "}"}], ",", "All"}], "}"}]}], ",", 
            
            RowBox[{"PlotLabel", "->", "\"\<CDF\>\""}], ",", 
            RowBox[{"ImageSize", "->", "Medium"}], ",", 
            RowBox[{"Epilog", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", "lineStyleMean", "]"}], ",", 
               "muMark", ",", 
               RowBox[{"Directive", "[", "lineStyleStdv", "]"}], ",", 
               "stdvMinusMark", ",", "stdvPlusMark"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<\[Mu] = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"\[Mu]", "//", "N"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"Alignment", "->", "Center"}]}], "]"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "2"}], "}"}], ",", "1", ",", "20"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "2"}], "}"}], ",", "1", ",", "4"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scal", ",", "100"}], "}"}], ",", "10", ",", " ", "500"}], 
    "}"}]}], "]"}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"1d74f320-4769-423b-9b91-99a1f679c321"],

Cell["Define grain-size-related intensity factor.", "Text",ExpressionUUID->"e0bed04b-ef94-4c4a-a357-bb58b527764d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rRandomRadius", "[", 
   RowBox[{"scale_", ",", "width_", ",", "shape_"}], "]"}], ":=", 
  RowBox[{"scale", " ", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"WeibullDistribution", "[", 
     RowBox[{"shape", ",", "width"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"2ff61354-bb47-4691-b625-5f4b4eb9ca61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rRandomVolume", "[", "wbd_Association", "]"}], ":=", 
  RowBox[{
   FractionBox["4", "3"], "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"rRandomRadius", "[", 
     RowBox[{
      RowBox[{"wbd", "[", "\"\<Scale\>\"", "]"}], ",", 
      RowBox[{"wbd", "[", "\"\<Width\>\"", "]"}], ",", 
      RowBox[{"wbd", "[", "\"\<Shape\>\"", "]"}]}], "]"}], "3"]}]}]], "Input",\

 CellLabel->"In[78]:=",ExpressionUUID->"ba20ad21-fdda-42e7-92d2-e2a83a577bae"],

Cell["Show typical values.", "Text",ExpressionUUID->"21e14132-6afc-48d7-9f3d-d9ea19486205"],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rRandomRadius", "[", 
         RowBox[{"100", ",", "2", ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "100000"}], "}"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rRandomVolume", "[", 
         RowBox[{"100", ",", "2", ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "100000"}], "}"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], "]"}]], "Input",\

 CellLabel->"In[79]:=",ExpressionUUID->"6a852f78-4088-4e5d-9eb1-82c68b92ef35"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffraction Simulation", "Chapter",ExpressionUUID->"4b756d97-d55b-4cf0-9f18-985c814e9581"],

Cell[CellGroupData[{

Cell["Graphics", "Section",ExpressionUUID->"126eb2f6-5351-4689-8e5d-f17472b2551e"],

Cell[CellGroupData[{

Cell["Pixel Resolution", "Subsection",ExpressionUUID->"8ba54490-3a68-4684-9571-a92a52340a12"],

Cell["\<\
To place the origin on a pixel and facilitate inversion symmetry, the \
dimension of the field of view is an odd number. Beam convergence is modeled \
by convoluting with a Gau\[SZ] matrix. However, this operation shrinks the \
pixel dimensions of the resulting pattern by the mask dimension mDim. \
Therefore, we first determine mDim, then choose a correspondingly larger \
iDim, so that the author resulting image is the desired dimension. \
\>", "Text",ExpressionUUID->"b84085be-28c9-497b-851f-96d8fb37c758"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mDim", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"iDim", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["2", "n"], "+", "1", "+", 
    RowBox[{"2", "mDim"}]}], "/.", 
   RowBox[{"n", "->", "11"}]}]}]}], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"95656b05-7b43-4c53-afc4-ebc813426fa7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Field of View", "Subsection",ExpressionUUID->"09a063a1-947f-4bcf-9642-9c80cd42750b"],

Cell[TextData[{
 "We need to choose a \[OpenCurlyDoubleQuote]field of view\
\[CloseCurlyDoubleQuote] for the diffraction pattern. All reflections with a \
distance from the center larger than ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["rQ", "max"], TraditionalForm]],ExpressionUUID->
  "90b021ec-829f-4c68-add3-1079e26a2ecd"],
 " will be discarded. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["rQ", "max"], TraditionalForm]],ExpressionUUID->
  "f12949d9-dc6f-497f-8108-166607598440"],
 " is specified in units of of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "f29fa4e3-3635-4f99-94ff-713644d8c8bc"],
 ". ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["rQ", "pad"], TraditionalForm]],ExpressionUUID->
  "68173ba9-8fa4-4d71-a869-b1bac8e0c4c4"],
 " is a padding factor, so that the reflections do not reach or (because of \
rounding) exceed the field of view. If you choose ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["rQ", "pad"], TraditionalForm]],ExpressionUUID->
  "14791463-1930-4ba0-81a5-ab8595938ee7"],
 " smaller, the pattern will look smaller on the same field of view."
}], "Text",ExpressionUUID->"f886ecf0-48a3-4f98-9eb4-f68b3aa9f995"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rQmax", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rQpad", "=", "0.8"}], ";"}]}], "Input",
 CellChangeTimes->{{3.917124609859177*^9, 3.91712462237846*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"a6c6ff2b-021f-4a90-a402-40ec623dccd9"],

Cell[TextData[{
 "Assign pixel to a vector ",
 StyleBox["q.",
  FontWeight->"Bold",
  FontSlant->"Italic"]
}], "Text",ExpressionUUID->"ea61257d-df1e-496a-83e5-ec5edf341d95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lQik", "[", 
   RowBox[{"q_List", ",", "rQmax_"}], "]"}], ":=", 
  RowBox[{"Round", "[", 
   RowBox[{"rQpad", " ", "q", " ", 
    FractionBox["iDim", 
     RowBox[{"2", "rQmax"}]]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.917124600458884*^9, 3.91712462638624*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"16bfdc0e-0260-4127-a4d3-d868b0ab77e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Markers", "Subsection",ExpressionUUID->"2fe41022-396a-4274-886f-e57e21bf0ad2"],

Cell[TextData[{
 "Draw center and 1 ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["nm", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "6a8a1767-b43f-41b7-b0c9-24ab24b50267"],
 " scale marker lines in a diffraction pattern."
}], "Text",ExpressionUUID->"efbbe4f1-6bd9-4927-9abd-f8a330d36623"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vLines", "::", "usage"}], "=", 
    "\"\<Draw lines in an image. Assume odd pixel dimensions, origin in the \
center, x- and y-range [-1,+1]. lrSegs is list of line segment lists, each \
containing a pair of start coordinates and a pair of end coordinates, and, \
optional, a brightness level in [0,1].\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vLines", "[", 
   RowBox[{"ima_", ",", "lrSegs_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "imadj", ",", "dat", ",", "iDimX", ",", "iDimY", ",", "rBrite", ",", 
      "liSeg1", ",", "liSeg2", ",", "liDSeg", ",", "ix", ",", "iy"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imadj", "=", 
      RowBox[{"ima", "//", "ImageAdjust"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dat", "=", 
      RowBox[{"ImageData", "[", "imadj", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"iDimX", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"dat", ",", "2"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iDimY", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"dat", ",", "2"}], "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EvenQ", "[", "iDimX", "]"}], "||", 
        RowBox[{"EvenQ", "[", "iDimY", "]"}]}], ",", 
       RowBox[{"Throw", "[", "\"\<Odd dimensions expected!\>\"", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iXY", "[", "xy_List", "]"}], ":=", 
      RowBox[{"Round", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"iDimX", "-", "1"}], "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
             "xy", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}]}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"iDimY", "-", "1"}], "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
             "xy", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ")"}]}], "+", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "lrSegs", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"liSeg1", "=", 
         RowBox[{"iXY", "[", 
          RowBox[{
           RowBox[{
           "lrSegs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"liSeg2", "=", 
         RowBox[{"iXY", "[", 
          RowBox[{
           RowBox[{
           "lrSegs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"liDSeg", "=", 
         RowBox[{"liSeg2", "-", "liSeg1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "lrSegs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}], "==", "3"}], ",", 
          RowBox[{"rBrite", "=", 
           RowBox[{
            RowBox[{
            "lrSegs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"rBrite", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "liDSeg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ">", 
           RowBox[{
           "liDSeg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ix", "=", "0"}], ",", 
            RowBox[{"ix", "<", 
             RowBox[{
             "liDSeg", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"dat", "\[LeftDoubleBracket]", 
                RowBox[{"ix", "+", 
                 RowBox[{
                 "liSeg1", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"ix", " ", 
                  FractionBox[
                   RowBox[{
                   "liDSeg", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "liDSeg", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]]}], "]"}], "+", 
                RowBox[{
                "liSeg1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "=", 
              "rBrite"}], ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"iy", "=", "0"}], ",", 
            RowBox[{"iy", "<", 
             RowBox[{
             "liDSeg", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"iy", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"dat", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"iy", 
                  FractionBox[
                   RowBox[{
                   "liDSeg", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "liDSeg", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]]}], "]"}], "+", 
                RowBox[{
                "liSeg1", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"iy", "+", 
               RowBox[{
               "liSeg1", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "=", 
             "rBrite"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"Image", "[", "dat", "]"}], "//", "ImageAdjust"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"aaa2f212-5c54-4f47-b234-f84adf28ba24"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loop", "Section",ExpressionUUID->"6bc44fd5-94ad-4494-aacf-6707b4558110"],

Cell["Here is where you start an actual run. ", "Text",ExpressionUUID->"18e2075a-a22a-4f53-b662-9622d1043dd9"],

Cell[CellGroupData[{

Cell["Run Parameters", "Subsection",ExpressionUUID->"5d769583-a2bf-490f-8f22-fe7abf7f03cf"],

Cell["\<\
Each saved diffractogram will be accompanied by JSON-LD (JavaScript object \
notation for Linking Data) files, which includes the underlying parameters in \
text format. The parameters are collected in a list of Mathematica rules. \
Eventually the list will be exported to json files in the default directory.\
\>", "Text",
 CellChangeTimes->{{3.9262123750607777`*^9, 
  3.926212386643045*^9}},ExpressionUUID->"4acfb8a7-ffab-47bc-bd3d-\
1525f49fc916"],

Cell["", "Text",
 CellChangeTimes->{
  3.9262124875929728`*^9},ExpressionUUID->"23874a2d-2f63-47fa-b963-\
76f54d94a523"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sampleID", " ", "=", " ", "\"\<SampleID\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"recipeID", " ", "=", " ", "\"\<Recipe\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"beamlineID", " ", "=", " ", "\"\<Beamline\>\""}], ";"}], "  ", 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Write", " ", "out", " ", "a", " ", "JSON"}], "-", "LD"}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Define", " ", "the", " ", "JSON"}], "-", 
    RowBox[{"LD", " ", "context"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"context", " ", "=", " ", 
    RowBox[{"{", "\n", "  ", 
     RowBox[{"\"\<@context\>\"", " ", "->", " ", 
      RowBox[{"{", "\n", "    ", 
       RowBox[{
        RowBox[{
        "\"\<@vocab\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<value\>\"", " ", "->", " ", "\"\<https://schema.org/value\>\""}],
         ",", "\n", "    ", 
        RowBox[{
        "\"\<description\>\"", " ", "->", " ", 
         "\"\<https://schema.org/description\>\""}], ",", "\n", "    ", 
        RowBox[{
        "\"\<unit\>\"", " ", "->", " ", 
         "\"\<https://schema.org/unitText\>\""}], ",", "\n", "    ", 
        RowBox[{
        "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
         "\"\<https://schema.org/alternativeIdentifier\>\""}], ",", "\n", 
        "    ", 
        RowBox[{
        "\"\<Alpha-Ti\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<Austenite\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<Beta-Ti\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<PhaseFracAlpha\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<PhaseFracAust\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<PhaseFracBeta\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<Phases\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<SizeDistrAust\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<SizeDistrTiAlpha\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<SizeDistrTiBeta\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<Texture\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}], ",", 
        "\n", "    ", 
        RowBox[{
        "\"\<GrainMorphology\>\"", " ", "->", " ", 
         "\"\<https://cwrusdle.bitbucket.io/Ontology/sample.owl\>\""}]}], 
       "\n", "  ", "}"}]}], "\n", "}"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "the", " ", "data"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data1", " ", "=", " ", 
    RowBox[{"{", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<ID Sample\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<Identifier\>\""}], ",",
          "\n", "    ", 
         RowBox[{
         "\"\<description\>\"", " ", "->", " ", 
          "\"\<The unique sample ID.\>\""}], ",", "\n", "    ", 
         RowBox[{"\"\<value\>\"", " ", "->", " ", "sampleID"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], ",", 
         "\n", "    ", 
         RowBox[{
         "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
          "\"\<sample ID\>\""}]}], "\n", "  ", "}"}]}], ",", "\n", "  ", "\n",
       "  ", 
      RowBox[{"\"\<Phases\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<Phases\>\""}], ",", 
         "\n", "    ", 
         RowBox[{"\"\<Austenite\>\"", " ", "->", " ", 
          RowBox[{"{", "\n", "      ", 
           RowBox[{
            RowBox[{"\"\<SizeDistrAust\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Size distribution of Austenite grains\>\""}], ",", "\n", 
               "        ", 
               RowBox[{
               "\"\<value\>\"", " ", "->", " ", 
                "\"\<\\\"Weibull 140--10.0--1.5\\\"\>\""}], ",", "\n", 
               "        ", 
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<GrainSizeDistAust\>\""}]}], "\n", "      ", "}"}]}], ",",
             "\n", "      ", 
            RowBox[{"\"\<PhaseFracAust\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Phase fraction of Austenite phase\>\""}], ",", "\n", 
               "        ", 
               RowBox[{"\"\<value\>\"", " ", "->", " ", "rPhaseFracAust"}], 
               ",", "\n", "        ", 
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<AustFrac\>\""}]}], "\n", "      ", "}"}]}]}], "\n", 
           "    ", "}"}]}], ",", "\n", "    ", 
         RowBox[{"\"\<Alpha-Ti\>\"", " ", "->", " ", 
          RowBox[{"{", "\n", "      ", 
           RowBox[{
            RowBox[{"\"\<SizeDistrTiAlpha\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Size distribution of Alpha-Ti grains\>\""}], ",", "\n", 
               "        ", 
               RowBox[{
               "\"\<value\>\"", " ", "->", " ", 
                "\"\<\\\"Weibull 125--2--2\\\"\>\""}], ",", "\n", "        ", 
               
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<GrainSizeDistAlpha\>\""}]}], "\n", "      ", "}"}]}], 
            ",", "\n", "      ", 
            RowBox[{"\"\<PhaseFracAlpha\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Phase fraction of Alpha-Ti phase\>\""}], ",", "\n", 
               "        ", 
               RowBox[{"\"\<value\>\"", " ", "->", " ", "rPhaseFracAlpha"}], 
               ",", "\n", "        ", 
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<PhaseFracAlphainTi64\>\""}]}], "\n", "      ", "}"}]}]}],
            "\n", "    ", "}"}]}], ",", "\n", "    ", 
         RowBox[{"\"\<Beta-Ti\>\"", " ", "->", " ", 
          RowBox[{"{", "\n", "      ", 
           RowBox[{
            RowBox[{"\"\<SizeDistrTiBeta\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Size distribution of Beta-Ti grains\>\""}], ",", "\n", 
               "        ", 
               RowBox[{
               "\"\<value\>\"", " ", "->", " ", 
                "\"\<\\\"Weibull 140--10.0--1.5\\\"\>\""}], ",", "\n", 
               "        ", 
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<GrainSizeDistBeta\>\""}]}], "\n", "      ", "}"}]}], ",",
             "\n", "      ", 
            RowBox[{"\"\<PhaseFracBeta\>\"", " ", "->", " ", 
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{
               "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<description\>\"", " ", "->", " ", 
                "\"\<Phase fraction of Beta-Ti phase\>\""}], ",", "\n", 
               "        ", 
               RowBox[{"\"\<value\>\"", " ", "->", " ", "rPhaseFracBeta"}], 
               ",", "\n", "        ", 
               RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
               ",", "\n", "        ", 
               RowBox[{
               "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
                "\"\<PhaseFracBeta\>\""}]}], "\n", "      ", "}"}]}]}], "\n", 
           "    ", "}"}]}]}], "\n", "  ", "}"}]}], ",", "\n", "  ", 
      RowBox[{"\"\<Microstructural Features\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{"\"\<Texture\>\"", " ", "->", " ", 
         RowBox[{"{", "\n", "      ", 
          RowBox[{
           RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}],
            ",", "\n", "      ", 
           RowBox[{
           "\"\<description\>\"", " ", "->", " ", 
            "\"\<Texture of the sample\>\""}], ",", "\n", "      ", 
           RowBox[{"\"\<value\>\"", " ", "->", " ", "\"\<Uniform\>\""}], ",", 
           "\n", "      ", 
           RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], ",", 
           "\n", "      ", 
           RowBox[{
           "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
            "\"\<SampleTexture\>\""}]}], "\n", "    ", "}"}]}], "\n", "  ", 
        "}"}]}]}], "\n", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data2", " ", "=", " ", 
    RowBox[{"{", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<ID Recipe\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<Identifier\>\""}], ",",
          "\n", "    ", 
         RowBox[{
         "\"\<description\>\"", " ", "->", " ", 
          "\"\<The unique sample ID.\>\""}], ",", "\n", "    ", 
         RowBox[{"\"\<value\>\"", " ", "->", " ", "recipeID"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], ",", 
         "\n", "    ", 
         RowBox[{
         "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
          "\"\<recipe ID\>\""}]}], "\n", "  ", "}"}]}], ",", "\n", "\n", "  ", 
      RowBox[{"\"\<Wavelength\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
         ",", "\n", "    ", 
         RowBox[{
         "\"\<description\>\"", " ", "->", " ", 
          "\"\<The wavelength of the primary beam\>\""}], ",", "\n", "    ", 
         RowBox[{"\"\<value\>\"", " ", "->", " ", "rLambda"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<nm\>\""}], ",", 
         "\n", "    ", 
         RowBox[{
         "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
          "\"\<lambda\>\""}]}], "\n", "  ", "}"}]}], ",", "\n", "\n", "  ", 
      RowBox[{"\"\<Relative wavelength spread\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
         ",", "\n", "    ", 
         RowBox[{
         "\"\<description\>\"", " ", "->", " ", 
          "\"\<The wavelength spread of the primary beam\>\""}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<value\>\"", " ", "->", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "3"}]}]}], ",", "\n", "    ", 
         RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], ",", 
         "\n", "    ", 
         RowBox[{
         "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
          "\"\<lambdaSpread\>\""}]}], "\n", "  ", "}"}]}], ",", "\n", "  ", 
      "\n", "   ", 
      RowBox[{"\"\<Number of Grains\>\"", " ", "->", " ", 
       RowBox[{"{", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], 
         ",", "\n", "    ", 
         RowBox[{
         "\"\<description\>\"", " ", "->", " ", 
          "\"\<The number of grains\>\""}], ",", "\n", "    ", 
         RowBox[{"\"\<value\>\"", " ", "->", " ", "nGrains"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], ",", 
         "\n", "    ", 
         RowBox[{
         "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
          "\"\<NGrains\>\""}]}], "\n", "  ", "}"}]}]}], "\n", "  ", "}"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Combine", " ", "context", " ", "and", " ", "data", " ", "into", " ", 
     "JSON"}], "-", 
    RowBox[{"LD", " ", "structure"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"sampleJSON", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"context", ",", " ", "data1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"recipeJSON", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"context", ",", " ", "data2"}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9262124751576147`*^9, 3.926212483780643*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"b31e2216-77c3-4d44-ad41-b7480d505c2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffraction Pattern Setup", "Subsection",ExpressionUUID->"33cba029-0c1a-4c83-8278-fd310a95306c"],

Cell[TextData[{
 "For each grain, I calculate a diffraction pattern. First, I create an empty \
square array. Then, I add delta functions with a height representing the \
intensity of the reflections. Subsequently, the delta functions are \
convoluted with a Gauss matrix representing the distribution of the \
incident-beam wave vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "0"], "."}], TraditionalForm]],ExpressionUUID->
  "c82553aa-93a5-486a-b08c-a02715051e2b"],
 " In a further step, to be implemented later, I can convolute the pattern \
with a second Gauss matrix representing the Fourier transform of the particle \
",
 StyleBox["shape",
  FontSlant->"Italic"],
 ". The patterns of he individual grains are then added up to yield the final \
pattern."
}], "Text",ExpressionUUID->"815813ee-a4ec-4ac7-83d8-4ceba2f76e60"],

Cell[CellGroupData[{

Cell["Repetitions", "Subsubsection",ExpressionUUID->"3c56f625-89a1-471a-97fa-223c4153c25e"],

Cell["Number of repetitions.", "Text",ExpressionUUID->"4f24f892-de25-4c7b-98e7-02716db567ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nGrains", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<NGrains\>\"", "\[Rule]", "nGrains"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.922743873438075*^9, {3.92621256366958*^9, 3.926212564083515*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"1e4a051c-da09-416f-9195-6716a3567cbd"],

Cell["Number of patterns to be generated.", "Text",ExpressionUUID->"86594c0c-09c4-4f69-b5d8-0daa6732dbd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nPatterns", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<NPatterns\>\"", "\[Rule]", "nPatterns"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.922743875969624*^9, 3.922743876142455*^9}, {
  3.9262125678439693`*^9, 3.926212568128395*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"7aa63087-6845-47b3-8348-a818257ff997"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phases Setup", "Subsection",ExpressionUUID->"f72edc14-e132-453e-a253-afb6a010a168"],

Cell["\<\
From the list of structure factors of each phase/structure under \
consideration, create a reduced list that only contains the diffraction \
vectors lGhkl and an intensity factor rFI, initially equal to rSFI, the \
intensity modulation owing to structure factor. In the loop below, the lGhkl \
will be randomly rotated and rFI will be modified by further factors \
impacting diffracted-beam intensity, especially the \
\[OpenCurlyDoubleQuote]excitation error.\[CloseCurlyDoubleQuote]\
\>", "Text",ExpressionUUID->"2fae1f5c-a2bd-4ff0-887d-f22fa704164d"],

Cell[CellGroupData[{

Cell["Grain-Size Distributions", "Subsubsection",ExpressionUUID->"74090aa0-591b-43e2-ab1c-9b5e42de961e"],

Cell["\<\
Use Diff-Sim-Helper-PSD to generate the following list of associations, each \
specifying a Weibull distribution for the grain size of a phase.\
\>", "Text",ExpressionUUID->"2d878872-5dbb-43c4-ac88-dfe5d288ecc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lGSD", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Scale\>\"", "\[Rule]", "1000.`"}], ",", 
       RowBox[{"\"\<Width\>\"", "\[Rule]", "20.`"}], ",", 
       RowBox[{"\"\<Shape\>\"", "\[Rule]", "1.03`"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Scale\>\"", "\[Rule]", "291.`"}], ",", 
       RowBox[{"\"\<Width\>\"", "\[Rule]", "20.`"}], ",", 
       RowBox[{"\"\<Shape\>\"", "\[Rule]", "3.18`"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Scale\>\"", "\[Rule]", "176.`"}], ",", 
       RowBox[{"\"\<Width\>\"", "\[Rule]", "20.`"}], ",", 
       RowBox[{"\"\<Shape\>\"", "\[Rule]", "6.44`"}]}], 
      "\[RightAssociation]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"aGSDAust", ",", "aGSDTiAlpha", ",", "aGSDTiBeta"}], "}"}], "=", 
   "lGSD"}], ";"}]}], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"a6540806-4184-4b0b-bcc3-fc2893ea124a"],

Cell["\<\
Define plotting function: Provide a list of associations, each specifying a \
Weibull distribution, and generate a list of plots.\
\>", "Text",ExpressionUUID->"f446ce7e-fdf5-41b8-977d-fc0ec8a4d7d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lpGSPDF", "[", 
   RowBox[{"lGSD_List", ",", 
    RowBox[{"rmax_", ":", "1500"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "lP", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"List", " ", "of", " ", 
      RowBox[{"plots", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lP", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "lGSD", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"lP", ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{
              "lGSD", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "[", "\"\<Scale\>\"", "]"}]], 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"WeibullDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "lGSD", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "[", "\"\<Width\>\"", "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "lGSD", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "[", "\"\<Shape\>\"", "]"}]}], 
               "]"}], ",", 
              FractionBox["x", 
               RowBox[{
                RowBox[{
                "lGSD", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "[", "\"\<Scale\>\"", "]"}]]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"10", " ", 
              RowBox[{
               RowBox[{
               "lGSD", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                "[", "\"\<Scale\>\"", "]"}]}]}], "}"}], ",", 
           RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "rmax"}], "}"}], ",", "All"}], "}"}]}], ",", 
           
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", 
              RowBox[{"Hue", "[", 
               FractionBox["i", 
                RowBox[{"Length", "[", "lGSD", "]"}]], "]"}]}], "}"}]}], ",", 
           
           RowBox[{"PlotLabel", "->", "\"\<PDF\>\""}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "lP", "]"}]}]}], "]"}]}]], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"d3a80637-a0ed-432d-9e79-9051c15baace"],

Cell["Show the current grain-size distributions.", "Text",ExpressionUUID->"50f5c9ad-61c5-4bd2-9f17-87409e72e4cb"],

Cell[BoxData[
 RowBox[{"lpGSPDF", "[", 
  RowBox[{"lGSD", ",", "1500"}], "]"}]], "Input",
 CellLabel->
  "In[102]:=",ExpressionUUID->"951f3c4c-91e8-48a4-b4e4-1ac1269a3176"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Gamma]-316L", "Subsubsection",ExpressionUUID->"bd7f87c1-570d-4279-b0dd-bd7339ac9336"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lGIAust", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<lGhkl\>\"", "->", 
         RowBox[{"#", "[", "\"\<lGhkl\>\"", "]"}]}], ",", 
        RowBox[{"\"\<rFI\>\"", "->", 
         RowBox[{"#", "[", "\"\<rSFI\>\"", "]"}]}]}], "|>"}], "&"}], ",", 
     "lSFAust"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rFSAust", "[", "]"}], ":=", 
   RowBox[{"rRandomVolume", "[", "aGSDAust", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<SizeDistrAust\>\"", "\[Rule]", 
     RowBox[{"\"\<Weibull \>\"", "<>", 
      RowBox[{"ToString", "[", "aGSDAust", "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"501845a2-3b8d-4ba4-834c-2d9585fe2474"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Alpha] -Ti", "Subsubsection",ExpressionUUID->"011f10a5-9d43-4ff3-a344-dea4993dc5cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lGITiAlpha", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<lGhkl\>\"", "->", 
         RowBox[{"#", "[", "\"\<lGhkl\>\"", "]"}]}], ",", 
        RowBox[{"\"\<rFI\>\"", "->", 
         RowBox[{"#", "[", "\"\<rSFI\>\"", "]"}]}]}], "|>"}], "&"}], ",", 
     "lSFTiAlpha"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rFSTiAlpha", "[", "]"}], ":=", 
   RowBox[{"rRandomVolume", "[", "aGSDTiAlpha", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<SizeDistrTiAlpha\>\"", "\[Rule]", 
     RowBox[{"\"\<Weibull \>\"", "<>", 
      RowBox[{"ToString", "[", "aGSDTiAlpha", "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"f93f791a-a94c-49c1-a248-4230e871d0b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta]-Ti", "Subsubsection",ExpressionUUID->"2d5b5c77-1a89-4d83-a047-1bd659ee262a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lGITiBeta", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<lGhkl\>\"", "->", 
         RowBox[{"#", "[", "\"\<lGhkl\>\"", "]"}]}], ",", 
        RowBox[{"\"\<rFI\>\"", "->", 
         RowBox[{"#", "[", "\"\<rSFI\>\"", "]"}]}]}], "|>"}], "&"}], ",", 
     "lSFTiBeta"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rFSTiBeta", "[", "]"}], ":=", 
   RowBox[{"rRandomVolume", "[", "aGSDTiBeta", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<SizeDistrTiBeta\>\"", "\[Rule]", 
     RowBox[{"\"\<Weibull \>\"", "<>", 
      RowBox[{"ToString", "[", "aGSDTiBeta", "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"e99c6949-5e64-4edc-84c5-75a65a265216"]
}, Closed]],

Cell[CellGroupData[{

Cell["Phase Fractions", "Subsubsection",ExpressionUUID->"1f26e320-407e-425d-9209-dfcd9cb77c16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rPhaseFracAust", "=", "0.00"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rPhaseFracAlphaInTi64", "=", "1.00"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<PhaseFracAust\>\"", "\[Rule]", "rPhaseFracAust"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rPhaseFracTi64", "=", 
   RowBox[{"1.00", "-", "rPhaseFracAust"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{
    "\"\<\!\(\*StyleBox[\"rPhaseFracTi64\", \"Code\"]\)\>\"", "\[Rule]", 
     StyleBox["rPhaseFracTi64", "Code"]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rPhaseFracAlpha", "=", 
   RowBox[{"rPhaseFracAlphaInTi64", " ", "rPhaseFracTi64"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<PhaseFracAlpha\>\"", "\[Rule]", "rPhaseFracAlpha"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rPhaseFracBeta", "=", 
   RowBox[{"1", "-", "rPhaseFracAlpha", " ", "-", "rPhaseFracAust"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<PhaseFracBeta\>\"", "\[Rule]", "rPhaseFracBeta"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rPhaseFracTotal", "=", 
   RowBox[{
   "rPhaseFracAust", "+", "rPhaseFracAlpha", "+", "rPhaseFracBeta"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"lJSON", ",", 
    RowBox[{"\"\<PhaseFracTotal\>\"", "\[Rule]", "rPhaseFracTotal"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"<|", 
  RowBox[{
   RowBox[{"\"\<rPhaseFracAust\>\"", "->", "rPhaseFracAust"}], 
   StyleBox[",", "Code"], 
   RowBox[{
    RowBox[{
     StyleBox["\"\<\>", "Code"], "rPhaseFracTi64", "\"\<\>"}], "->", 
    "rPhaseFracTi64"}], ",", 
   RowBox[{
   "\"\<rPhaseFracAlphaInTi64\!\(\*StyleBox[\"\\\"\<\>\", \"Code\"]\)\>", 
    StyleBox["->", "Code"], 
    StyleBox["rPhaseFracAlphaInTi64", "Code"]}], 
   StyleBox[",", "Code"], 
   RowBox[{"\"\<PhaseFracAlpha\>\"", "\[Rule]", "rPhaseFracAlpha"}], ",", 
   RowBox[{"\"\<PhaseFracBeta\>\"", "\[Rule]", "rPhaseFracBeta"}]}], 
  "|>"}]}], "Input",
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[112]:=",ExpressionUUID->"b1483028-accd-4c60-8e58-5e2674182e3c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loop Code", "Subsection",ExpressionUUID->"7d6632a6-14a3-4775-b9ee-e736498733d5"],

Cell[CellGroupData[{

Cell["Interactive Version", "Subsubsection",ExpressionUUID->"5363efab-ff9f-4489-b705-ce5b6b7a4e39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xInteractive", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rMaxDelta", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lDeltaMax", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Create", " ", "blank", " ", "diffraction", " ", 
           RowBox[{"pattern", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"lDP", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "iDim"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "iDim"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Each", " ", "iteration", " ", "corresponds", " ", "to", " ", 
              "1", " ", 
              RowBox[{"grain", ".", " ", 
               RowBox[{"Time", ":", " ", 
                RowBox[{"40", " ", 
                 RowBox[{"ms", "."}]}]}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Randomly", " ", "choose", " ", "a", " ", 
              RowBox[{"structure", " ", "/", " ", 
               RowBox[{"phase", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rPhaseSelect", "=", 
               RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rPhaseSelect", "<", "rPhaseFracAust"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"lGI", "=", "lGIAust"}], ";", 
                  RowBox[{"rFS", "=", 
                   RowBox[{"rFSAust", "[", "]"}]}]}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"rPhaseSelect", ">", 
                    RowBox[{"1", "-", "rPhaseFracAlpha"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"lGI", "=", "lGITiAlpha"}], ";", 
                    RowBox[{"rFS", "=", 
                    RowBox[{"rFSTiAlpha", "[", "]"}]}]}], ")"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"lGI", "=", "lGITiBeta"}], ";", 
                    RowBox[{"rFS", "=", 
                    RowBox[{"rFSTiBeta", "[", "]"}]}]}], ")"}]}], "]"}], 
                 ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"Create", " ", "random", " ", 
                RowBox[{"rotation", "."}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"lo", "=", 
               RowBox[{"oRnd", "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Apply", " ", "the", " ", "rotation", " ", "to", " ", "the", 
                " ", "diffraction", " ", "vectors", " ", "in", " ", 
                RowBox[{"lGI", ".", " ", "Call"}], " ", "the", " ", "rotated",
                 " ", "vectors", " ", 
                RowBox[{"lGhklR", ".", " ", "Keep"}], " ", "the", " ", 
                "intensity", " ", 
                RowBox[{"factors", "."}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"lGIR", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<lGhklR\>\"", "->", 
                    RowBox[{"lo", ".", 
                    RowBox[{"#", "[", "\"\<lGhkl\>\"", "]"}]}]}], ",", 
                    RowBox[{"\"\<rFI\>\"", "->", 
                    RowBox[{"#", "[", "\"\<rFI\>\"", "]"}]}]}], "|>"}], "&"}],
                  ",", "lGI"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"For", " ", "each", " ", "lGhklR"}], ",", " ", 
                RowBox[{
                 RowBox[{"get", " ", "diffracted"}], "-", 
                 RowBox[{"wave", " ", "vector", " ", 
                  StyleBox["K",
                   FontWeight->"Bold"], " ", "and", " ", "diffracted", " ", 
                  RowBox[{"intensity", "."}]}]}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"lKI", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"aDiff", "[", 
                   RowBox[{"#", ",", "lK0"}], "]"}], "&"}], ",", "lGIR"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "Prune", " ", "the", " ", "list", " ", "to", " ", "keep", " ",
                  "only", " ", "reflections", " ", Cell[
                 "||G||",ExpressionUUID->
                  "c7db6ad4-8d6f-47f0-aed5-eaec68e19c9b"]}], "<", " ", 
                RowBox[{"rQmax", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
              
              RowBox[{"lKIP", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"lKI", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    SuperscriptBox["#", "2"]}], "&"}], "@", 
                    RowBox[{"(", 
                    RowBox[{"#", "[", "\"\<lXY\>\"", "]"}], ")"}]}], "<", 
                   SuperscriptBox["rQmax", "2"]}], "&"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Prune", " ", "the", " ", "list", " ", "to", " ", "keep", " ", 
                "only", " ", "intense", " ", 
                RowBox[{"reflections", "."}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"lKIPP", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"lKIP", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<rFI\>\"", "]"}], ">", "0"}], 
                  "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"Iterate", " ", "over", " ", "list", " ", "of", " ", 
                RowBox[{"reflections", "."}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"One", " ", 
                 RowBox[{"iteration", ":", " ", 
                  RowBox[{"0.9", " ", 
                   RowBox[{"ms", "."}]}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Integer", " ", 
                 RowBox[{"coordinates", "."}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lxy", "=", 
                  RowBox[{"lQik", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "lKIPP", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "[", "\"\<lXY\>\"", "]"}], ",",
                     "rQmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "Add", " ", "intensity", " ", "factor", " ", "times", " ", 
                    "grain"}], "-", 
                   RowBox[{
                   "size", " ", "factor", " ", "rFS", " ", "as", " ", "Delta",
                     " ", "Function", " ", "to", " ", "pixel", " ", 
                    RowBox[{"value", "."}]}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"lDP", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "lxy", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    FractionBox[
                    RowBox[{"iDim", "-", "1"}], "2"]}], 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{
                    "lxy", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "+", 
                    FractionBox[
                    RowBox[{"iDim", "-", "1"}], "2"]}], 
                   "\[RightDoubleBracket]"}], "+=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "lKIPP", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "[", "\"\<rFI\>\"", "]"}], 
                   "rFS"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", 
                  RowBox[{"Length", "[", "lKIPP", "]"}]}], "}"}]}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nGrains"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rMaxDelta", "=", 
            RowBox[{"Max", "[", "lDP", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Maximum value of delta peaks: \>\"", ",", "rMaxDelta"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lDeltaMax", ",", "rMaxDelta"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Convolve", " ", "the", " ", "Delta", " ", "Functions", " ", 
             "with", " ", "point", " ", "spread", " ", "function", " ", "for",
              " ", "incident", " ", "beam", " ", 
             RowBox[{"directions", "."}]}], " ", "*)"}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Preliminary", " ", 
             RowBox[{"model", ":", " ", 
              RowBox[{"Gau\[SZ]", " ", 
               RowBox[{"Distribution", "."}]}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"0.28", " ", 
              RowBox[{"s", ".", " ", 
               RowBox[{"C", "++"}]}], " ", "may", " ", "not", " ", "be", " ", 
              
              RowBox[{"faster", ".", " ", 
               RowBox[{"https", ":"}]}]}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"github", ".", "com"}], "/", "jdupuy"}], "/", 
              RowBox[{"dj_fft", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Convolve Max = \>\"", ",", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"ListConvolve", "[", 
               RowBox[{
                RowBox[{"GaussianMatrix", "[", 
                 RowBox[{"{", 
                  RowBox[{"mDim", ",", "4"}], "}"}], "]"}], ",", " ", "lDP"}],
                "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"iDP", "=", 
            RowBox[{
             RowBox[{"Image", "[", 
              RowBox[{"ListConvolve", "[", 
               RowBox[{
                RowBox[{"GaussianMatrix", "[", 
                 RowBox[{"{", 
                  RowBox[{"mDim", ",", "4"}], "}"}], "]"}], ",", " ", "lDP"}],
                "]"}], "]"}], "//", "ImageAdjust"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Write", " ", "to", " ", 
             RowBox[{"file", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"sNum", "=", 
            RowBox[{"ToString", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Leading", " ", 
             RowBox[{"zeros", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "1000"}], ",", 
             RowBox[{"sNum", "=", 
              RowBox[{"\"\<0\>\"", "<>", "sNum"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "100"}], ",", 
             RowBox[{"sNum", "=", 
              RowBox[{"\"\<0\>\"", "<>", "sNum"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "10"}], ",", 
             RowBox[{"sNum", "=", 
              RowBox[{"\"\<0\>\"", "<>", "sNum"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "sOutputFolder", "<>", "sBaseName", "<>", "\"\<-\>\"", "<>", 
              "sNum", "<>", "\"\<.tiff\>\""}], ",", "iDP", ",", 
             RowBox[{"ImageEncoding", "->", "\"\<LZW\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "sOutputFolder", "<>", "sBaseName", "<>", "\"\<-\>\"", "<>", 
              "sNum", "<>", "\"\<.jpg\>\""}], ",", "iDP"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "sOutputFolder", "<>", "sBaseName", "<>", "\"\<-\>\"", "<>", 
              "sNum", "<>", "\"\<.json\>\""}], ",", "lJSON"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Add", " ", "line", " ", "markers", " ", "to", " ", 
             RowBox[{"image", "."}]}], " ", "*)"}], 
           RowBox[{"imgLin", "=", 
            RowBox[{"vLines", "[", 
             RowBox[{"iDP", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.01"}], ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.01", ",", "0"}], "}"}], ",", "0.5"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "0.01"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0.01"}], "}"}], ",", "0.5"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.95", ",", 
                    RowBox[{"0.9", "-", 
                    FractionBox["1", 
                    RowBox[{"2", "rQmax"}]]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.95", ",", 
                    RowBox[{"0.9", "+", 
                    FractionBox["1", 
                    RowBox[{"2", "rQmax"}]]}]}], "}"}], ",", "0.5"}], "}"}]}],
                "}"}]}], "]"}]}]}], ",", "imgLin"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nPatterns"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Maximum of maximum values of delta peaks: \>\"", ",", " ", 
        RowBox[{"Max", "[", "lDeltaMax", "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"1183348c-8f9e-474d-a87c-48662099130f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Speed Version", "Subsubsection",ExpressionUUID->"c81201cf-ff3e-4ed2-a68c-c58594508827"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xSpeed", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{"Parallelize", "[", "\n", 
     RowBox[{"Do", "[", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "blank", " ", "diffraction", " ", 
        RowBox[{"pattern", "."}]}], " ", "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"lDP", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "iDim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "iDim"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"Do", "[", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Each", " ", "iteration", " ", "corresponds", " ", "to", " ", "1", 
           " ", 
           RowBox[{"grain", ".", " ", 
            RowBox[{"Time", ":", " ", 
             RowBox[{"40", " ", 
              RowBox[{"ms", "."}]}]}]}]}], " ", "*)"}], "\n", 
         RowBox[{"(*", " ", 
          RowBox[{"Randomly", " ", "choose", " ", "a", " ", 
           RowBox[{"structure", " ", "/", " ", 
            RowBox[{"phase", "."}]}]}], " ", "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"rPhaseSelect", "=", 
            RowBox[{"RandomReal", "[", "]"}]}], ";", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rPhaseSelect", "<", "rPhaseFracAust"}], ",", "\n", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lGI", "=", "lGIAust"}], ";", 
               RowBox[{"rFS", "=", 
                RowBox[{"rFSAust", "[", "]"}]}]}], ")"}], ",", "\n", 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rPhaseSelect", ">", 
                 RowBox[{"1", "-", "rPhaseFracAlpha"}]}], ",", "\n", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"lGI", "=", "lGITiAlpha"}], ";", 
                  RowBox[{"rFS", "=", 
                   RowBox[{"rFSTiAlpha", "[", "]"}]}]}], ")"}], ",", "\n", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"lGI", "=", "lGITiBeta"}], ";", 
                  RowBox[{"rFS", "=", 
                   RowBox[{"rFSTiBeta", "[", "]"}]}]}], ")"}]}], "]"}], 
              ")"}]}], "]"}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{"Create", " ", "random", " ", 
             RowBox[{"rotation", "."}]}], " ", "*)"}], "\n", 
           RowBox[{"lo", "=", 
            RowBox[{"oRnd", "[", "]"}]}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Apply", " ", "the", " ", "rotation", " ", "to", " ", "the", " ", 
             "diffraction", " ", "vectors", " ", "in", " ", 
             RowBox[{"lGI", ".", " ", "Call"}], " ", "the", " ", "rotated", 
             " ", "vectors", " ", 
             RowBox[{"lGhklR", ".", " ", "Keep"}], " ", "the", " ", 
             "intensity", " ", 
             RowBox[{"factors", "."}]}], " ", "*)"}], "\n", 
           RowBox[{"lGIR", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<lGhklR\>\"", "->", 
                  RowBox[{"lo", " ", ".", " ", 
                   RowBox[{"#", "[", "\"\<lGhkl\>\"", "]"}]}]}], ",", 
                 RowBox[{"\"\<rFI\>\"", "->", 
                  RowBox[{"#", "[", "\"\<rFI\>\"", "]"}]}]}], "|>"}], "&"}], 
              ",", "lGI"}], "]"}]}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "For", " ", "each", " ", "lGhklR", " ", "get", " ", 
              "diffracted"}], "-", 
             RowBox[{
             "wave", " ", "vector", " ", "K", " ", "and", " ", "diffracted", 
              " ", 
              RowBox[{"intensity", "."}]}]}], " ", "*)"}], "\n", 
           RowBox[{"lKI", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"aDiff", "[", 
                RowBox[{"#", ",", "lK0"}], "]"}], "&"}], ",", "lGIR"}], 
             "]"}]}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Prune", " ", "the", " ", "list", " ", "to", " ", "keep", " ", 
              "only", " ", "reflections"}], " ", "||", "G", "||", 
             RowBox[{"<", " ", 
              RowBox[{"rQmax", "."}]}]}], " ", "*)"}], "\n", 
           RowBox[{"lKIP", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"lKI", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Plus", "@@", 
                   RowBox[{"(", 
                    RowBox[{"#", "^", "2"}], ")"}]}], "&"}], "@", 
                 RowBox[{"(", 
                  RowBox[{"#", "[", "\"\<lXY\>\"", "]"}], ")"}]}], "<", 
                RowBox[{"rQmax", "^", "2"}]}], "&"}]}], "]"}]}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Prune", " ", "the", " ", "list", " ", "to", " ", "keep", " ", 
             "only", " ", "intense", " ", 
             RowBox[{"reflections", "."}]}], " ", "*)"}], "\n", 
           RowBox[{"lKIPP", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"lKIP", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<rFI\>\"", "]"}], ">", "0"}], "&"}]}], 
             "]"}]}], ";", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{"Iterate", " ", "over", " ", "list", " ", "of", " ", 
             RowBox[{"reflections", "."}]}], " ", "*)"}], "\n", 
           RowBox[{"Do", "[", "\n", 
            RowBox[{"(*", " ", 
             RowBox[{"One", " ", 
              RowBox[{"iteration", ":", " ", 
               RowBox[{"0.9", " ", 
                RowBox[{"ms", "."}]}]}]}], " ", "*)"}], "\n", 
            RowBox[{"(*", " ", 
             RowBox[{"Integer", " ", 
              RowBox[{"coordinates", "."}]}], " ", "*)"}], "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"lxy", "=", 
               RowBox[{"lQik", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"lKIPP", "[", 
                   RowBox[{"[", "ii", "]"}], "]"}], "[", "\"\<lXY\>\"", "]"}],
                  ",", "rQmax"}], "]"}]}], ";", "\n", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "Add", " ", "intensity", " ", "factor", " ", "times", " ", 
                 "grain"}], "-", 
                RowBox[{
                "size", " ", "factor", " ", "rFS", " ", "as", " ", "Delta", 
                 " ", "Function", " ", "to", " ", "pixel", " ", 
                 RowBox[{"value", "."}]}]}], " ", "*)"}], "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"lDP", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"lxy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{"iDim", "/", "2"}]}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"lxy", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"iDim", "/", "2"}]}], "]"}], "]"}], "+=", 
               RowBox[{
                RowBox[{
                 RowBox[{"lKIPP", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "[", "\"\<rFI\>\"", "]"}], 
                "rFS"}]}]}], ",", "\n", 
             RowBox[{"{", 
              RowBox[{"ii", ",", 
               RowBox[{"Length", "[", "lKIPP", "]"}]}], "}"}]}], "]"}]}], ",",
           "\n", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nGrains"}], "}"}]}], "]"}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convolve", " ", "the", " ", "Delta", " ", "Functions", " ", "with", 
          " ", "point", " ", "spread", " ", "function", " ", "for", " ", 
          "incident", " ", "beam", " ", 
          RowBox[{"directions", "."}]}], " ", "*)"}], " ", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"Weibull", " ", 
          RowBox[{"Distribution", "."}]}], " ", "*)"}], "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"0.28", " ", 
           RowBox[{"s", ".", " ", 
            RowBox[{"C", "++"}]}], " ", "may", " ", "not", " ", "be", " ", 
           RowBox[{"faster", ".", " ", 
            RowBox[{"https", ":"}]}]}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"github", ".", "com"}], "/", "jdupuy"}], "/", 
           RowBox[{"dj_fft", "."}]}]}], " ", "*)"}], "\n", 
        RowBox[{"iDP", "=", 
         RowBox[{"Image", "[", 
          RowBox[{"ListConvolve", "[", 
           RowBox[{
            RowBox[{"GaussianMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"mDim", ",", "4"}], "}"}], "]"}], ",", " ", "lDP"}], 
           "]"}], "]"}]}], ";", "\n", 
        RowBox[{"min", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"ImageData", "[", "iDP", "]"}], "]"}]}], ";", "\n", 
        RowBox[{"max", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"ImageData", "[", "iDP", "]"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Print", " ", "out", " ", "the", " ", "max", " ", "and", " ", "min", 
          " ", 
          RowBox[{"intensity", "."}]}], " ", "*)"}], "\n", 
        RowBox[{"data3", " ", "=", " ", 
         RowBox[{"{", "\n", "  ", 
          RowBox[{
           RowBox[{"\"\<maxIntensity\>\"", " ", "->", " ", 
            RowBox[{"{", "\n", "    ", 
             RowBox[{
              RowBox[{
              "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], ",",
               "\n", "    ", 
              RowBox[{
              "\"\<description\>\"", " ", "->", " ", 
               "\"\<The maximum value of intensity in the \
diffractogram.\>\""}], ",", "\n", "    ", 
              RowBox[{"\"\<value\>\"", " ", "->", " ", "max"}], ",", "\n", 
              "    ", 
              RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
              ",", "\n", "    ", 
              RowBox[{
              "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
               "\"\<intensityMax\>\""}]}], "\n", "  ", "}"}]}], ",", "\n", 
           "\n", "  ", 
           RowBox[{"\"\<minIntensity\>\"", " ", "->", " ", 
            RowBox[{"{", "\n", "    ", 
             RowBox[{
              RowBox[{
              "\"\<@type\>\"", " ", "->", " ", "\"\<PropertyValue\>\""}], ",",
               "\n", "    ", 
              RowBox[{
              "\"\<description\>\"", " ", "->", " ", 
               "\"\<The minimum value of intensity in the \
diffractogram.\>\""}], ",", "\n", "    ", 
              RowBox[{"\"\<value\>\"", " ", "->", " ", "min"}], ",", "\n", 
              "    ", 
              RowBox[{"\"\<unitText\>\"", " ", "->", " ", "\"\<Null\>\""}], 
              ",", "\n", "    ", 
              RowBox[{
              "\"\<alternativeIdentifier\>\"", " ", "->", " ", 
               "\"\<intensityMin\>\""}]}], "\n", "  ", "}"}]}]}], "\n", 
          "}"}]}], ";", "\n", "\n", 
        RowBox[{"resultJSON", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"context", ",", " ", "data3"}], "]"}]}], ";", "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"sOutputFolder", "<>", 
           RowBox[{"ToString", "[", "sampleID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "recipeID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "beamlineID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
              "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
             "}"}], "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.tiff\>\""}], ",", 
          "iDP", ",", 
          RowBox[{"ImageEncoding", "->", "\"\<LZW\>\""}], ",", 
          RowBox[{"\"\<BitDepth\>\"", "->", "32"}]}], "]"}], ";", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"sOutputFolder", "<>", 
           RowBox[{"ToString", "[", "sampleID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "recipeID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "beamlineID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
              "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
             "}"}], "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.json\>\""}], ",", 
          "resultJSON"}], "]"}], ";", "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"sOutputFolder", "<>", 
           RowBox[{"ToString", "[", "sampleID", "]"}], "<>", 
           "\"\<.json\>\""}], ",", " ", "sampleJSON"}], "]"}], ";", "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"sOutputFolder", "<>", 
           RowBox[{"ToString", "[", "recipeID", "]"}], "<>", 
           "\"\<.json\>\""}], ",", " ", "recipeJSON"}], "]"}]}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nPatterns"}], "}"}]}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.926212435597555*^9},
 CellLabel->
  "In[124]:=",ExpressionUUID->"678cdefa-52cc-4b91-9baf-30569acb62a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loop Execution", "Subsection",ExpressionUUID->"57351ab8-9ddd-4bb4-b8e6-fe63bfcae2fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"bInteractive", ",", 
    RowBox[{"xInteractive", "[", "]"}], ",", " ", 
    RowBox[{"xSpeed", "[", "]"}]}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"633090a1-a62f-4609-b11f-0cb77639a3d0"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save Version", "Title",ExpressionUUID->"85b79d37-30ac-44be-b21e-b3a94d0ae993"],

Cell["\<\
To minimize tracking of irrelevant information, we save a copy of the current \
notebook in \[OpenCurlyDoubleQuote]Readable\[CloseCurlyDoubleQuote] format. \
To further reduce tracking irrelevant changes, we first ensure that all \
groups are open (otherwise, Git version control will track opening and \
closing of groups). As we cannot undo the opening of all groups, first save \
the current state, then run the following, and don\[CloseCurlyQuote]t save it \
after it has been run.\
\>", "Text",ExpressionUUID->"80a87b3a-2d8c-41a2-9d52-a2d60db6151d"],

Cell["\<\
Further, to avoid version tracking of Mathematica changing input- and output \
line numbers, we first quit the kernel by the following line. Placing this \
Quit[] statement here also has the advantage that if you just run the entire \
notebook, the current \[OpenCurlyDoubleQuote]Readable\[CloseCurlyDoubleQuote] \
version will not be overwritten as the Quit[] statement stops execution. Only \
if you execute the code after the Quit[] statement, the the notebook will be \
saved as a new version of the \[OpenCurlyDoubleQuote]Readable\
\[CloseCurlyDoubleQuote] (\[OpenCurlyDoubleQuote]...-R.nb\
\[CloseCurlyDoubleQuote]) file for Git. \
\>", "Text",ExpressionUUID->"8f203d45-af0a-4d97-aab9-29885ad20984"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[225]:=",ExpressionUUID->"679a0120-1349-40d3-8a10-da4861f9ebc3"],

Cell["\<\
If you ran the entire notebook, it will stop after the Quit[] above. All \
input- and output cell numbers will be reset.\
\>", "TA",ExpressionUUID->"40df5eae-ca0e-4df8-a9e4-99253cf1d47e"],

Cell["\<\
Before proceeding, you may want to backup the current version of this \
notebook, including the output data and current status of groups open/closed, \
by saving a copy to a different location. \
\>", "TA",ExpressionUUID->"9085664c-d43c-41d0-b295-2e4219a58387"],

Cell["\<\
To save the notebook without the output data and save a \
\[OpenCurlyDoubleQuote]readable,\[CloseCurlyDoubleQuote] \
\[OpenCurlyDoubleQuote]-R\[CloseCurlyDoubleQuote] version for Git, run the \
next subsection.\
\>", "TA",ExpressionUUID->"4a40bfec-a76e-4fdc-a6d9-4147755f7b20"],

Cell[CellGroupData[{

Cell["Save -R Version for Git", "Subsubsection",ExpressionUUID->"385a0e8b-1f23-4a6b-89f9-bc8cf41af9b0"],

Cell[TextData[{
 "Now we save a copy of this notebook in the \[OpenCurlyDoubleQuote]readable\
\[CloseCurlyDoubleQuote] format., which is more suitable for version \
tracking, while keeping all relevant information. Only the input cells will \
be saved. ",
 StyleBox["All output cells will be deleted.",
  FontSlant->"Italic"],
 " In order to minimize tracking of wether groups are open or closed, all \
groups will be opened before saving. "
}], "Text",ExpressionUUID->"20e784cf-8453-43a9-aff2-acfddb7063ea"],

Cell["\<\
To stop you from erroneously saving this notebook after the following \
operation, when all groups are open, the window will be closed *without* \
saving.\
\>", "TA",ExpressionUUID->"8c558e5e-989b-422a-94c5-3d1385b81daf"],

Cell["\<\
Define a function that opens all groups, appends \[OpenCurlyDoubleQuote]-R\
\[CloseCurlyDoubleQuote] (for \[OpenCurlyDoubleQuote]Readable Format\
\[CloseCurlyDoubleQuote]) to the file base name of the notebook, and saves \
the new notebook in the same directory as the original notebook.\
\>", "Text",ExpressionUUID->"b93079cb-2c7e-4a8f-921c-6e82fab76d44"],

Cell[BoxData[
 RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", 
  "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4a562ff9-9d9e-4c2d-98a4-75db2d104959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"saveR", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
     "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{"nb", ",", "All", ",", "Notebook"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FrontEndTokenExecute", "[", 
      RowBox[{"nb", ",", "\"\<SelectionOpenAllGroups\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<SaveReadableNotebook\>\"", "]"}], 
      "[", 
      RowBox[{
       RowBox[{"NotebookFileName", "[", "]"}], ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"NotebookFileName", "[", "]"}], ",", "\"\<.nb\>\""}], 
            "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "<>", "\"\<-R\>\"", "<>", "\"\<.nb\>\""}], "}"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"NotebookClose", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"Interactive", "->", "False"}]}], "]"}],
      FontSize->12]}]}], "]"}]}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"031005a7-ec4c-4cff-95cd-a514c38fb8d7"],

Cell["Now execute the function.", "Text",ExpressionUUID->"14674068-d6d6-45ec-bb5e-4453378f5e1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"saveR", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"4e797a9e-8c20-4870-a8b4-28e8b50899c9"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{720, 879},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6834ae7e-ca1e-44f3-859f-5425df6397de"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 83, 0, 98, "Title",ExpressionUUID->"4bffcede-9db8-4d82-82b0-f760447a5827"],
Cell[CellGroupData[{
Cell[688, 26, 144, 3, 69, "Chapter",ExpressionUUID->"a32133cb-441f-4de4-8b64-6c3a7f7e17e9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[835, 31, 155, 3, 67, "Section",ExpressionUUID->"14bf0795-8324-476b-bf0a-dbda742b5996",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[993, 36, 169, 3, 45, "Subsubsection",ExpressionUUID->"5e70a3ef-720f-42c4-8d8f-e2d6a9feca3d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1165, 41, 705, 13, 150, "Text",ExpressionUUID->"fcfc5d70-a2a7-4130-8519-816bc8acdaf7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1873, 56, 215, 4, 29, "Input",ExpressionUUID->"9d3f7ba4-6355-4594-8c08-0ff03f247c2f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2091, 62, 149, 3, 67, "Section",ExpressionUUID->"55d50fee-a451-4a21-ae8c-cf7959ad9bd8",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2243, 67, 378, 7, 29, "Input",ExpressionUUID->"53f39d9d-fe28-451c-ac20-4c0ba9400154",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2624, 76, 147, 3, 67, "Section",ExpressionUUID->"973ae5d5-c003-4001-a8b8-166d90d007e7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2774, 81, 161, 3, 45, "Subsubsection",ExpressionUUID->"fa70895d-ea6b-4650-8060-18af9e971c27",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2938, 86, 521, 10, 81, "Text",ExpressionUUID->"f7dab53f-62ab-4174-be47-c05abc684c9d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3462, 98, 163, 3, 45, "Subsubsection",ExpressionUUID->"3152b6fc-d5ce-425d-88c7-297d16d454af",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3628, 103, 250, 8, 35, "Text",ExpressionUUID->"485940a4-9af5-4f97-9844-1024197d7fdd",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3881, 113, 466, 11, 50, "Input",ExpressionUUID->"f7725e6d-96a8-47b5-b399-4005b4689c45",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4350, 126, 147, 3, 67, "Section",ExpressionUUID->"5f93470f-7ea4-4bb3-828a-4bbb9d2d78da",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4500, 131, 205, 5, 35, "Text",ExpressionUUID->"7693ef42-22c2-40b5-9b6c-4efd07a1ac5e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4708, 138, 208, 5, 35, "Text",ExpressionUUID->"d4b95f32-d474-409b-808a-4a52801405c8",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4919, 145, 217, 4, 29, "Input",ExpressionUUID->"2617f01f-e10f-4a84-96c2-c46ffac8fc0e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[5173, 154, 94, 0, 69, "Chapter",ExpressionUUID->"7caeabf8-e1a2-416d-b22b-3f93f06bfbb0"],
Cell[CellGroupData[{
Cell[5292, 158, 97, 0, 67, "Section",ExpressionUUID->"0a1749b0-0737-44b4-b2b0-aa2bc61b5b92"],
Cell[5392, 160, 589, 10, 127, "Text",ExpressionUUID->"e7a77704-f561-4b7e-b624-cc685f7354f9"],
Cell[5984, 172, 324, 5, 81, "Text",ExpressionUUID->"92b18b57-01f2-4d1d-b7d0-4c7eb96e870a"],
Cell[CellGroupData[{
Cell[6333, 181, 127, 0, 54, "Subsection",ExpressionUUID->"00f7b557-7beb-4f55-91ba-f170a9f5d594"],
Cell[6463, 183, 93, 0, 35, "Text",ExpressionUUID->"752961e2-10b1-47e4-a73e-e23f4cacd6cc"],
Cell[6559, 185, 53244, 1283, 8446, "Input",ExpressionUUID->"c200754f-e783-4a3c-a23e-3b9224a70754"],
Cell[59806, 1470, 71, 0, 35, "Text",ExpressionUUID->"23b347c5-89ad-4704-b448-63f0e20584b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59914, 1475, 94, 0, 54, "Subsection",ExpressionUUID->"ae6aebbc-605b-42f7-97e2-2839d0ae1633"],
Cell[60011, 1477, 481, 16, 35, "Text",ExpressionUUID->"9755afdb-e98d-4208-abfe-f359bac18b11"],
Cell[60495, 1495, 534, 18, 38, "Text",ExpressionUUID->"0a4d8d7a-78be-4b28-be7e-11e369127080"],
Cell[61032, 1515, 1455, 37, 216, "Input",ExpressionUUID->"015fb7a8-7cbd-44f2-873a-a798068ced21"],
Cell[CellGroupData[{
Cell[62512, 1556, 87, 0, 45, "Subsubsection",ExpressionUUID->"a5c73508-fc8f-4480-b6e1-3770f16e8751"],
Cell[62602, 1558, 2087, 62, 69, "Text",ExpressionUUID->"c18fc1ae-7d6b-4a87-a357-dc3596207e64"],
Cell[64692, 1622, 1158, 37, 69, "Input",ExpressionUUID->"133cb0ef-08dc-457e-88c1-387808df2029"]
}, Closed]],
Cell[CellGroupData[{
Cell[65887, 1664, 119, 0, 37, "Subsubsection",ExpressionUUID->"3fc13f38-36c8-4f50-a127-36430b10bcf2"],
Cell[66009, 1666, 1133, 37, 69, "Text",ExpressionUUID->"58246825-e3a2-48af-80ae-46c323de4481"],
Cell[67145, 1705, 986, 29, 69, "Input",ExpressionUUID->"d7861227-44be-4fbc-94c7-ac8d7b0bd553"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68192, 1741, 100, 0, 67, "Section",ExpressionUUID->"2c1e2ea3-b4aa-47b2-b8dd-a5c10a726f60"],
Cell[68295, 1743, 667, 14, 104, "Text",ExpressionUUID->"f438d87d-6d44-455a-89f1-b66328160b42"],
Cell[68965, 1759, 946, 14, 196, "Text",ExpressionUUID->"4db28e52-0a68-48e5-bd57-6424f0501eb5"],
Cell[69914, 1775, 5526, 170, 313, "Text",ExpressionUUID->"fa513b15-864b-4453-8d6e-634f24ad7c27"],
Cell[75443, 1947, 381, 8, 58, "Text",ExpressionUUID->"4d8eec40-5ceb-4c74-9a57-ea56a335fe6b"],
Cell[75827, 1957, 1179, 32, 127, "Text",ExpressionUUID->"235ed50b-2c47-4a41-ad90-36dbeecc8128"],
Cell[77009, 1991, 2649, 83, 152, "Text",ExpressionUUID->"6ab0ae4b-bfe7-4f43-889b-d4590a7edcb4"],
Cell[79661, 2076, 1672, 43, 157, "Text",ExpressionUUID->"fd19f71c-4104-4f30-b941-58be08b29ada"],
Cell[CellGroupData[{
Cell[81358, 2123, 107, 0, 54, "Subsection",ExpressionUUID->"4cd42cec-6a19-4851-9cbf-6f1f4c4c95b5"],
Cell[81468, 2125, 2314, 57, 69, "Text",ExpressionUUID->"c5717a15-64dd-444a-8e28-d0d33096a24c"],
Cell[83785, 2184, 29223, 761, 69, "Input",ExpressionUUID->"f042a66f-034f-4697-a694-e64c8798ff5a"]
}, Closed]],
Cell[CellGroupData[{
Cell[113045, 2950, 102, 0, 38, "Subsection",ExpressionUUID->"400c1fae-69e0-44d8-a08a-f8fbb914e813"],
Cell[113150, 2952, 308, 8, 69, "Text",ExpressionUUID->"792cc771-0edd-40f2-9ae3-580d757746bd"],
Cell[113461, 2962, 1006, 25, 69, "Input",ExpressionUUID->"b86c38c3-9ed3-4351-aac0-f2414682f8de"],
Cell[CellGroupData[{
Cell[114492, 2991, 87, 0, 69, "Subsubsection",ExpressionUUID->"df7278e2-d6e9-4491-8e22-86a482505110"],
Cell[114582, 2993, 191, 4, 69, "Text",ExpressionUUID->"9c74d6b1-2eae-4267-b3a6-52d5b5ee22a8"],
Cell[114776, 2999, 184, 3, 69, "Input",ExpressionUUID->"5c2aba2d-2d52-4479-bf50-b8a48982ef0e"],
Cell[114963, 3004, 859, 25, 69, "Input",ExpressionUUID->"72108194-038e-40f7-8fc8-a8b6189651ca"],
Cell[115825, 3031, 1872, 51, 69, "Text",ExpressionUUID->"4b579df4-2d3f-4dfe-b534-2f8dc4054e0e"],
Cell[117700, 3084, 955, 25, 69, "Input",ExpressionUUID->"a334eaf3-9cad-4ceb-b90c-b04498803702"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[118716, 3116, 86, 0, 53, "Section",ExpressionUUID->"34a4b8b3-11e0-4fe7-bad4-11859493e7cd"],
Cell[118805, 3118, 111, 0, 35, "Text",ExpressionUUID->"e2f1659d-fdd8-4fe5-acda-590f4d394849"],
Cell[118919, 3120, 160, 3, 29, "Input",ExpressionUUID->"6e6aaf51-cd65-4835-a3e9-b8bbde041de1"],
Cell[CellGroupData[{
Cell[119104, 3127, 104, 0, 54, "Subsection",ExpressionUUID->"c60bc2a3-167e-4ba9-a859-ca65ffe7735e"],
Cell[119211, 3129, 440, 11, 58, "Text",ExpressionUUID->"fddcbdd0-deb4-4b57-a0cc-323e48a4b4c2"],
Cell[119654, 3142, 309, 8, 66, "Input",ExpressionUUID->"1449ab30-4ef9-4144-aaaf-e41e44fdbd62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120000, 3155, 93, 0, 54, "Subsection",ExpressionUUID->"d2fa3041-3fd3-419d-b355-9e0775e57f52"],
Cell[120096, 3157, 141, 2, 35, "Text",ExpressionUUID->"2b09aa06-53bd-4482-9fe2-dae38bdc1111"],
Cell[120240, 3161, 374, 12, 54, "Text",ExpressionUUID->"9cd9e75e-9559-44af-bdc5-6f07cc35d9db"],
Cell[120617, 3175, 152, 2, 35, "Text",ExpressionUUID->"7a0458ba-2a73-4847-8d21-6eb0454835c6"],
Cell[CellGroupData[{
Cell[120794, 3181, 126, 0, 45, "Subsubsection",ExpressionUUID->"01e494c2-5681-47d2-98ac-99eb8da10df0"],
Cell[120923, 3183, 219, 6, 69, "Input",ExpressionUUID->"609f6ced-c74b-4e63-89fc-8301af46524a"],
Cell[121145, 3191, 568, 15, 69, "Text",ExpressionUUID->"937ffd66-071d-4b29-bd33-7224bd7e7880"],
Cell[121716, 3208, 580, 17, 69, "Input",ExpressionUUID->"a98b6ee7-a385-4020-8bbe-7df285def8f4"],
Cell[122299, 3227, 274, 7, 69, "Input",ExpressionUUID->"9222ee09-b98f-4066-8799-554f81796cd8"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122634, 3241, 94, 0, 67, "Section",ExpressionUUID->"bc17e21e-6c5e-407d-8e6b-9fd525af91a5"],
Cell[CellGroupData[{
Cell[122753, 3245, 115, 0, 45, "Subsubsection",ExpressionUUID->"f33b660c-cd25-4232-a8c7-3f378283b895"],
Cell[122871, 3247, 120, 0, 35, "Text",ExpressionUUID->"ab062836-24be-4986-8d33-95f9754e1137"],
Cell[122994, 3249, 183, 4, 29, "Input",ExpressionUUID->"d0561e6a-9b09-4c18-8c1b-d1852b1dd17a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123214, 3258, 93, 0, 54, "Subsection",ExpressionUUID->"b9b12a26-72d3-4fe1-9ea7-0d318bef5747"],
Cell[123310, 3260, 121, 0, 35, "Text",ExpressionUUID->"05079cea-fd15-447f-a607-9e6c9107c6e5"],
Cell[123434, 3262, 558, 18, 35, "Text",ExpressionUUID->"1bf837cd-188e-4ae7-807f-2a0ac800dae9"],
Cell[123995, 3282, 480, 15, 51, "Input",ExpressionUUID->"0d9c400d-61dd-4d74-a157-b83c7568b8e6"],
Cell[124478, 3299, 529, 15, 54, "Input",ExpressionUUID->"2225150d-abcb-467a-ae0b-fa6b4648646f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125056, 3320, 94, 0, 67, "Section",ExpressionUUID->"4c29b97d-cb81-4556-b4e2-1cdb25b71824"],
Cell[CellGroupData[{
Cell[125175, 3324, 87, 0, 54, "Subsection",ExpressionUUID->"af1616a9-5d10-4018-a1e0-0f12f0488881"],
Cell[125265, 3326, 893, 16, 126, "Text",ExpressionUUID->"bf4f8555-de4c-4239-a653-f6f840109691"],
Cell[126161, 3344, 1766, 48, 182, "Input",ExpressionUUID->"bef00173-37fb-4ed7-9cdc-2f32da3cc8dc"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127988, 3399, 95, 0, 69, "Chapter",ExpressionUUID->"92c69c99-834d-4dd7-bf01-3474a48aa0c6"],
Cell[CellGroupData[{
Cell[128108, 3403, 149, 3, 64, "Subchapter",ExpressionUUID->"a5a39318-7ec5-4105-ad5c-4fa6fd15df0b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[128260, 3408, 1644, 33, 288, "Text",ExpressionUUID->"a70baedb-dc32-4ef7-80b4-586cd4cd40a5",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[129941, 3446, 116, 0, 64, "Subchapter",ExpressionUUID->"f14eba74-804f-400a-a31f-a8cd5b4688eb"],
Cell[130060, 3448, 189, 3, 58, "Text",ExpressionUUID->"04942f41-c2ba-4de2-bc4e-cf0f5adb54df"],
Cell[130252, 3453, 1491, 35, 173, "Text",ExpressionUUID->"cde24a6b-a8f3-4f7d-b66e-f3e0c98beb79"],
Cell[131746, 3490, 463, 13, 35, "Text",ExpressionUUID->"5e0aa8b1-7a30-478d-a8e2-a374b2d46e52"],
Cell[132212, 3505, 2760, 81, 173, "Text",ExpressionUUID->"9091518b-1664-4a52-9cb6-097963094850"],
Cell[134975, 3588, 1789, 47, 150, "Text",ExpressionUUID->"3a8d8390-a810-4d7a-ae3c-2d5ca7ef60da"],
Cell[136767, 3637, 4720, 146, 249, "Text",ExpressionUUID->"f531af17-e025-4093-87f3-fc6f2487c3bc"],
Cell[141490, 3785, 2656, 79, 196, "Text",ExpressionUUID->"6de8080a-e84b-46ae-aa14-f83c539eb633"],
Cell[144149, 3866, 2712, 86, 104, "Text",ExpressionUUID->"32fed579-e05f-4fc9-9114-55a9c3138a09"],
Cell[146864, 3954, 2262, 78, 85, "Text",ExpressionUUID->"03a144af-f03a-4167-900e-ffc28c1f30cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149163, 4037, 233, 6, 64, "Subchapter",ExpressionUUID->"f681df66-eed6-4e3c-a940-fba05c9464da"],
Cell[149399, 4045, 1140, 32, 127, "Text",ExpressionUUID->"12bf7855-be8b-4b93-8740-df83e396c370"],
Cell[150542, 4079, 277, 4, 74, "Item",ExpressionUUID->"0e46bfcf-9c45-480a-b215-9216023378c2"],
Cell[150822, 4085, 284, 4, 53, "Item",ExpressionUUID->"defbf6eb-05f9-4321-8fcc-637a84be7d55"],
Cell[151109, 4091, 4166, 132, 272, "Text",ExpressionUUID->"97aa8421-3902-4be0-a2c0-a47a8831cbf7"],
Cell[155278, 4225, 2228, 47, 334, "Text",ExpressionUUID->"b8cdb74f-64b6-47a8-b61f-5cdb90d34ece"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157543, 4277, 206, 2, 101, "Subchapter",ExpressionUUID->"6661257d-8a9a-4842-b9cb-2136b3003f5b"],
Cell[CellGroupData[{
Cell[157774, 4283, 139, 1, 67, "Section",ExpressionUUID->"8b7fb2b2-03b1-41ae-b66a-54cb42902b03"],
Cell[157916, 4286, 684, 15, 69, "Text",ExpressionUUID->"d482c8f9-0e83-4c8e-95f0-9cf94fbc9afb"],
Cell[158603, 4303, 1150, 44, 69, "Text",ExpressionUUID->"36cf0441-e807-4588-87e3-6c2cf47f1a53"],
Cell[159756, 4349, 4487, 140, 69, "Text",ExpressionUUID->"4af93bdc-e998-4ff5-9fe9-ea460ad7950b"],
Cell[164246, 4491, 6155, 211, 69, "Text",ExpressionUUID->"bfcb4087-419f-46e9-affb-0df4be38e54f"],
Cell[170404, 4704, 3268, 105, 69, "Text",ExpressionUUID->"eacf2dd0-c78e-44ee-9541-fd969e060006"],
Cell[173675, 4811, 318, 5, 69, "Text",ExpressionUUID->"327a5cae-bf74-467b-b3d8-49d5cda71a50"],
Cell[173996, 4818, 1159, 42, 69, "Text",ExpressionUUID->"3f3d6d96-69f0-4984-bb3f-b05ee0d2757d"]
}, Closed]],
Cell[CellGroupData[{
Cell[175192, 4865, 113, 0, 53, "Section",ExpressionUUID->"dbff5c4e-1223-42b8-9cc5-fda0e661f4ca"],
Cell[175308, 4867, 994, 30, 81, "Text",ExpressionUUID->"d6b46a1a-b7f3-4d5e-9bf8-a823e618b775"],
Cell[176305, 4899, 533, 11, 84, "Text",ExpressionUUID->"4b7099ea-ee5b-4ebd-92bd-63c06d919e64"],
Cell[176841, 4912, 175, 2, 32, "Item",ExpressionUUID->"98f68ae6-5127-46af-bb41-958c8132e918"],
Cell[177019, 4916, 673, 20, 53, "Item",ExpressionUUID->"4f472639-8fd9-44f4-98a4-78242b622bb1"],
Cell[177695, 4938, 560, 18, 53, "Item",ExpressionUUID->"72c775fa-1388-4353-a694-ab70ee33d7c7"],
Cell[178258, 4958, 123, 0, 32, "Item",ExpressionUUID->"f9aaecac-d06c-4764-88e4-c1fe22022566"],
Cell[178384, 4960, 200, 3, 53, "Item",ExpressionUUID->"6b7b7335-e5a5-4858-827d-c2a657d31676"],
Cell[CellGroupData[{
Cell[178609, 4967, 580, 11, 77, "Item",ExpressionUUID->"573a1a91-3cd8-4a27-9662-2c14d9cfb12d"],
Cell[179192, 4980, 7476, 174, 763, "Input",ExpressionUUID->"cf21060c-460f-4cb9-878b-5eaaf633ee37"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186729, 5161, 87, 0, 64, "Subchapter",ExpressionUUID->"e8ba8802-daaf-4bd9-8c79-237c466f68c3"],
Cell[CellGroupData[{
Cell[186841, 5165, 76, 0, 67, "Section",ExpressionUUID->"9cffb08f-5ab1-40e3-a292-b4ff0bc9ff70"],
Cell[186920, 5167, 344, 5, 81, "Text",ExpressionUUID->"7fdeda8c-84e2-4c9e-8473-72a4dafc1db8"],
Cell[187267, 5174, 1367, 38, 88, "Input",ExpressionUUID->"996c1f03-f2c3-41bb-aaf8-91898acee417"],
Cell[188637, 5214, 1403, 40, 104, "Text",ExpressionUUID->"3ff25d4b-1ce7-46ca-8c1f-5fca94cece7a"],
Cell[190043, 5256, 252, 5, 29, "Input",ExpressionUUID->"b33b3d7a-9e8e-4ebe-9bfb-517a47831e8f"],
Cell[190298, 5263, 2719, 45, 380, "Text",ExpressionUUID->"6b676614-1df7-4c51-9157-283680533874"],
Cell[193020, 5310, 702, 21, 58, "Text",ExpressionUUID->"239ac4ba-8d33-4d0d-a89a-ba6d783f3e58"],
Cell[193725, 5333, 389, 10, 29, "Input",ExpressionUUID->"ca254e32-4a76-4b11-8a59-ebf48f00dcc4"],
Cell[194117, 5345, 268, 7, 35, "Text",ExpressionUUID->"a6e583a2-1e50-4f1b-86af-6a17a148cdc3"],
Cell[194388, 5354, 180, 3, 29, "Input",ExpressionUUID->"a180744b-24c7-4133-a04d-1eee76d1ee97"],
Cell[194571, 5359, 929, 30, 58, "Text",ExpressionUUID->"a69fbdc4-c694-4ff1-befa-288d9fec8336"],
Cell[195503, 5391, 279, 6, 29, "Input",ExpressionUUID->"0a58cf16-f9ba-4a66-9848-815e1da61143"],
Cell[195785, 5399, 467, 10, 61, "Text",ExpressionUUID->"cf6ef08e-5aeb-4559-92a0-871f99b4e6fc"],
Cell[196255, 5411, 890, 25, 110, "Input",ExpressionUUID->"0602f5b9-71ed-41eb-b9bf-86be2814827a"],
Cell[197148, 5438, 117, 0, 35, "Text",ExpressionUUID->"17702847-02b4-4e27-8845-66e520c74b5d"],
Cell[197268, 5440, 244, 6, 31, "Input",ExpressionUUID->"8da88dc7-596d-480e-810c-6faa62df41ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197549, 5451, 76, 0, 67, "Section",ExpressionUUID->"c1d86bd4-fa76-400b-9849-8faeda7f3944"],
Cell[197628, 5453, 605, 12, 104, "Text",ExpressionUUID->"93b4fe56-f4c0-4c2a-b5f5-4fcd0e908625"],
Cell[CellGroupData[{
Cell[198258, 5469, 82, 0, 54, "Subsection",ExpressionUUID->"92bee894-8384-4316-b872-79a7085d8180"],
Cell[198343, 5471, 192, 2, 35, "Text",ExpressionUUID->"c12a752e-7c4d-4561-9156-3d2e86e676a8"],
Cell[198538, 5475, 2570, 70, 215, "Input",ExpressionUUID->"d6b786eb-babd-45ec-8c1b-b4d734aebb7b"],
Cell[201111, 5547, 2960, 88, 196, "Text",ExpressionUUID->"05c1ae40-0b55-4933-918b-68fb1bd3409f"],
Cell[204074, 5637, 231, 5, 29, "Input",ExpressionUUID->"b3fd8cd5-83bd-45ee-b6a8-53b450840af1"],
Cell[204308, 5644, 1287, 18, 242, "Text",ExpressionUUID->"196bd9a2-7c0f-439f-a48d-c91c006d85b6"],
Cell[205598, 5664, 968, 24, 127, "Text",ExpressionUUID->"d9c0122a-2e4a-49b7-bed3-8796a5fd5334"],
Cell[206569, 5690, 442, 11, 50, "Input",ExpressionUUID->"c442432f-99f2-4c69-a495-3cf8793f3f7f"],
Cell[207014, 5703, 268, 7, 35, "Text",ExpressionUUID->"8905f18f-ad8e-4139-834f-c6e2baca1951"],
Cell[207285, 5712, 188, 4, 29, "Input",ExpressionUUID->"278c8dd6-91e7-45f7-880a-018e1d645f1c"],
Cell[207476, 5718, 473, 10, 61, "Text",ExpressionUUID->"e0820102-b316-46ed-b283-86a930279eae"],
Cell[207952, 5730, 890, 25, 110, "Input",ExpressionUUID->"c72e8d2a-dd36-4223-972b-5329d355cce4"],
Cell[208845, 5757, 97, 0, 35, "Text",ExpressionUUID->"39b01bb3-5e30-459c-9555-7b93031e0301"],
Cell[208945, 5759, 230, 5, 29, "Input",ExpressionUUID->"c9354936-1b1d-4bde-af9e-c3413fc03097"],
Cell[209178, 5766, 1325, 41, 110, "Input",ExpressionUUID->"6b0dc8ea-9c60-4aaa-ba29-ed931248bdae"],
Cell[210506, 5809, 93, 0, 35, "Text",ExpressionUUID->"3f7b085a-b4fd-4c5c-b1a8-0fbd6688097e"],
Cell[210602, 5811, 231, 5, 29, "Input",ExpressionUUID->"2c58827c-c527-4009-a2c2-a265ef7384ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210870, 5821, 81, 0, 54, "Subsection",ExpressionUUID->"78d994e5-60fe-417a-bf90-420961959096"],
Cell[210954, 5823, 1876, 48, 130, "Input",ExpressionUUID->"4cc7ba87-b4ff-4bd9-ac95-6bd0c6e45c28"],
Cell[212833, 5873, 1402, 40, 104, "Text",ExpressionUUID->"ecd2e5c1-8d88-4dbf-ada2-00ca7e65378d"],
Cell[214238, 5915, 256, 5, 29, "Input",ExpressionUUID->"52322a5e-f4f6-496e-a9f9-bf1a678730ce"],
Cell[214497, 5922, 2723, 45, 380, "Text",ExpressionUUID->"d2737406-9446-455b-b3b1-8ab152157fd7"],
Cell[217223, 5969, 710, 21, 58, "Text",ExpressionUUID->"ac5b836b-29df-4d2b-beb1-499304275793"],
Cell[217936, 5992, 397, 10, 50, "Input",ExpressionUUID->"dc431b93-97a1-4d0d-8e2b-8633395ff3ca"],
Cell[218336, 6004, 268, 7, 35, "Text",ExpressionUUID->"583a5012-19d4-48f4-af6b-d39a20f6e0e4"],
Cell[218607, 6013, 187, 4, 29, "Input",ExpressionUUID->"02e2c434-909c-4318-8c32-7c9272bfee14"],
Cell[218797, 6019, 929, 30, 58, "Text",ExpressionUUID->"39e97277-3063-4a13-9e9a-1c32d02a3ec5"],
Cell[219729, 6051, 287, 6, 29, "Input",ExpressionUUID->"bd49c567-60d4-48fd-a0c0-23626188ac4a"],
Cell[220019, 6059, 468, 10, 61, "Text",ExpressionUUID->"31babde8-03f9-4127-ba2e-0d6d972a1401"],
Cell[220490, 6071, 890, 25, 110, "Input",ExpressionUUID->"a6df6d80-4ee5-461a-9e3e-8a227ca49c0f"],
Cell[221383, 6098, 97, 0, 35, "Text",ExpressionUUID->"d759411d-30fe-4d08-8a22-965742833be8"],
Cell[221483, 6100, 228, 5, 29, "Input",ExpressionUUID->"a46b1df5-06ac-4aeb-8b71-8bff9c88f597"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221760, 6111, 83, 0, 67, "Section",ExpressionUUID->"95f5efd3-3814-488e-877b-2b4c7506a51f"],
Cell[221846, 6113, 111, 0, 35, "Text",ExpressionUUID->"50892568-d25b-43ab-89f2-2ec32bd2f114"],
Cell[221960, 6115, 2129, 55, 128, "Input",ExpressionUUID->"dd9fd867-d397-4a82-a6e4-31e164de376c"],
Cell[224092, 6172, 1403, 40, 104, "Text",ExpressionUUID->"0e16aa0f-9eb7-40de-acb1-4b454e931267"],
Cell[225498, 6214, 254, 5, 29, "Input",ExpressionUUID->"b5abd95f-1d27-4840-9e83-6c7829734139"],
Cell[225755, 6221, 706, 21, 58, "Text",ExpressionUUID->"43a3a9ef-5ecb-48d6-9981-e238765ddc6b"],
Cell[226464, 6244, 393, 10, 29, "Input",ExpressionUUID->"ea8f5cc1-01f9-4b8b-acd7-de8708c4f6fa"],
Cell[226860, 6256, 268, 7, 35, "Text",ExpressionUUID->"11f955ff-26e7-4fd0-afd5-e46af1cf3b78"],
Cell[227131, 6265, 184, 4, 29, "Input",ExpressionUUID->"fba067fc-42f9-4fd6-bb76-5fbcae4d4e4a"],
Cell[227318, 6271, 929, 30, 58, "Text",ExpressionUUID->"af300645-deda-47bc-bf6e-4e1196e4015a"],
Cell[228250, 6303, 283, 6, 29, "Input",ExpressionUUID->"94225b4d-cdf2-41b8-83ea-456792abdfef"],
Cell[228536, 6311, 467, 10, 61, "Text",ExpressionUUID->"b18c42d2-c2ec-4be0-8ccc-2fb2b4d8b31d"],
Cell[229006, 6323, 890, 25, 110, "Input",ExpressionUUID->"05a8ca48-982d-404e-ab58-fce0a7869514"],
Cell[229899, 6350, 117, 0, 35, "Text",ExpressionUUID->"2c5992b4-47a4-4be5-883d-43a8e6a5d312"],
Cell[230019, 6352, 248, 6, 31, "Input",ExpressionUUID->"fee00ff6-4b8e-4148-8ac2-5475e114a030"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230328, 6365, 88, 0, 69, "Chapter",ExpressionUUID->"0471f7cb-dbe4-488d-b03e-6b5cba62118b"],
Cell[CellGroupData[{
Cell[230441, 6369, 93, 0, 67, "Section",ExpressionUUID->"45a223e8-e051-42c2-90a6-d74cb56ea063"],
Cell[CellGroupData[{
Cell[230559, 6373, 95, 0, 54, "Subsection",ExpressionUUID->"48225956-0b47-44ce-b538-e8a6107e8996"],
Cell[230657, 6375, 632, 15, 104, "Text",ExpressionUUID->"1a794595-2980-443f-a9bc-cd21b57e5926"],
Cell[231292, 6392, 1411, 43, 125, "Input",ExpressionUUID->"b6068f96-5fca-4567-a9db-5d8079d41531"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232740, 6440, 95, 0, 54, "Subsection",ExpressionUUID->"566185c7-84e2-4080-9275-74587b2290eb"],
Cell[232838, 6442, 342, 9, 58, "Text",ExpressionUUID->"eb2d9291-a251-489a-9b17-05a5483b888f"],
Cell[233183, 6453, 800, 22, 110, "Input",ExpressionUUID->"1aa15f04-25bc-48ca-be99-3e71e56c8395"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234032, 6481, 97, 0, 67, "Section",ExpressionUUID->"22af09ae-9717-4a04-9c05-abff1469e405"],
Cell[234132, 6483, 364, 8, 58, "Text",ExpressionUUID->"01b12c0c-eaf4-409d-986b-00bc74a23263"],
Cell[234499, 6493, 397, 10, 29, "Input",ExpressionUUID->"f18d2c6e-2e77-42f5-b01f-be3d5a0e3371"],
Cell[234899, 6505, 175, 3, 35, "Text",ExpressionUUID->"2b160b18-104b-4c78-86cf-68ce3c0b648b"],
Cell[235077, 6510, 5014, 131, 503, "Input",ExpressionUUID->"1d74f320-4769-423b-9b91-99a1f679c321"],
Cell[240094, 6643, 114, 0, 35, "Text",ExpressionUUID->"e0bed04b-ef94-4c4a-a357-bb58b527764d"],
Cell[240211, 6645, 368, 8, 50, "Input",ExpressionUUID->"2ff61354-bb47-4691-b625-5f4b4eb9ca61"],
Cell[240582, 6655, 480, 12, 65, "Input",ExpressionUUID->"ba20ad21-fdda-42e7-92d2-e2a83a577bae"],
Cell[241065, 6669, 91, 0, 35, "Text",ExpressionUUID->"21e14132-6afc-48d7-9f3d-d9ea19486205"],
Cell[241159, 6671, 824, 23, 70, "Input",ExpressionUUID->"6a852f78-4088-4e5d-9eb1-82c68b92ef35"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242032, 6700, 96, 0, 69, "Chapter",ExpressionUUID->"4b756d97-d55b-4cf0-9f18-985c814e9581"],
Cell[CellGroupData[{
Cell[242153, 6704, 82, 0, 67, "Section",ExpressionUUID->"126eb2f6-5351-4689-8e5d-f17472b2551e"],
Cell[CellGroupData[{
Cell[242260, 6708, 93, 0, 54, "Subsection",ExpressionUUID->"8ba54490-3a68-4684-9571-a92a52340a12"],
Cell[242356, 6710, 521, 7, 127, "Text",ExpressionUUID->"b84085be-28c9-497b-851f-96d8fb37c758"],
Cell[242880, 6719, 338, 9, 50, "Input",ExpressionUUID->"95656b05-7b43-4c53-afc4-ebc813426fa7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243255, 6733, 90, 0, 54, "Subsection",ExpressionUUID->"09a063a1-947f-4bcf-9642-9c80cd42750b"],
Cell[243348, 6735, 1218, 31, 129, "Text",ExpressionUUID->"f886ecf0-48a3-4f98-9eb4-f68b3aa9f995"],
Cell[244569, 6768, 292, 6, 50, "Input",ExpressionUUID->"a6c6ff2b-021f-4a90-a402-40ec623dccd9"],
Cell[244864, 6776, 173, 5, 35, "Text",ExpressionUUID->"ea61257d-df1e-496a-83e5-ec5edf341d95"],
Cell[245040, 6783, 385, 9, 51, "Input",ExpressionUUID->"16bfdc0e-0260-4127-a4d3-d868b0ab77e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245462, 6797, 84, 0, 54, "Subsection",ExpressionUUID->"2fe41022-396a-4274-886f-e57e21bf0ad2"],
Cell[245549, 6799, 308, 8, 69, "Text",ExpressionUUID->"efbbe4f1-6bd9-4927-9abd-f8a330d36623"],
Cell[245860, 6809, 7134, 177, 69, "Input",ExpressionUUID->"aaa2f212-5c54-4f47-b234-f84adf28ba24"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[253043, 6992, 78, 0, 67, "Section",ExpressionUUID->"6bc44fd5-94ad-4494-aacf-6707b4558110"],
Cell[253124, 6994, 110, 0, 35, "Text",ExpressionUUID->"18e2075a-a22a-4f53-b662-9622d1043dd9"],
Cell[CellGroupData[{
Cell[253259, 6998, 91, 0, 54, "Subsection",ExpressionUUID->"5d769583-a2bf-490f-8f22-fe7abf7f03cf"],
Cell[253353, 7000, 461, 8, 104, "Text",ExpressionUUID->"4acfb8a7-ffab-47bc-bd3d-1525f49fc916"],
Cell[253817, 7010, 120, 3, 35, "Text",ExpressionUUID->"23874a2d-2f63-47fa-b963-76f54d94a523"],
Cell[253940, 7015, 15043, 342, 2693, "Code",ExpressionUUID->"b31e2216-77c3-4d44-ad41-b7480d505c2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269020, 7362, 102, 0, 54, "Subsection",ExpressionUUID->"33cba029-0c1a-4c83-8278-fd310a95306c"],
Cell[269125, 7364, 850, 18, 150, "Text",ExpressionUUID->"815813ee-a4ec-4ac7-83d8-4ceba2f76e60"],
Cell[CellGroupData[{
Cell[270000, 7386, 91, 0, 45, "Subsubsection",ExpressionUUID->"3c56f625-89a1-471a-97fa-223c4153c25e"],
Cell[270094, 7388, 93, 0, 35, "Text",ExpressionUUID->"4f24f892-de25-4c7b-98e7-02716db567ac"],
Cell[270190, 7390, 408, 10, 50, "Input",ExpressionUUID->"1e4a051c-da09-416f-9195-6716a3567cbd"],
Cell[270601, 7402, 106, 0, 35, "Text",ExpressionUUID->"86594c0c-09c4-4f69-b5d8-0daa6732dbd5"],
Cell[270710, 7404, 439, 10, 50, "Input",ExpressionUUID->"7aa63087-6845-47b3-8348-a818257ff997"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[271198, 7420, 89, 0, 54, "Subsection",ExpressionUUID->"f72edc14-e132-453e-a253-afb6a010a168"],
Cell[271290, 7422, 562, 8, 127, "Text",ExpressionUUID->"2fae1f5c-a2bd-4ff0-887d-f22fa704164d"],
Cell[CellGroupData[{
Cell[271877, 7434, 104, 0, 45, "Subsubsection",ExpressionUUID->"74090aa0-591b-43e2-ab1c-9b5e42de961e"],
Cell[271984, 7436, 222, 3, 69, "Text",ExpressionUUID->"2d878872-5dbb-43c4-ac88-dfe5d288ecc2"],
Cell[272209, 7441, 1133, 28, 69, "Input",ExpressionUUID->"a6540806-4184-4b0b-bcc3-fc2893ea124a"],
Cell[273345, 7471, 208, 3, 69, "Text",ExpressionUUID->"f446ce7e-fdf5-41b8-977d-fc0ec8a4d7d4"],
Cell[273556, 7476, 2853, 74, 69, "Input",ExpressionUUID->"d3a80637-a0ed-432d-9e79-9051c15baace"],
Cell[276412, 7552, 113, 0, 69, "Text",ExpressionUUID->"50f5c9ad-61c5-4bd2-9f17-87409e72e4cb"],
Cell[276528, 7554, 172, 4, 69, "Input",ExpressionUUID->"951f3c4c-91e8-48a4-b4e4-1ac1269a3176"]
}, Closed]],
Cell[CellGroupData[{
Cell[276737, 7563, 93, 0, 37, "Subsubsection",ExpressionUUID->"bd7f87c1-570d-4279-b0dd-bd7339ac9336"],
Cell[276833, 7565, 879, 26, 69, "Input",ExpressionUUID->"501845a2-3b8d-4ba4-834c-2d9585fe2474"]
}, Closed]],
Cell[CellGroupData[{
Cell[277749, 7596, 92, 0, 37, "Subsubsection",ExpressionUUID->"011f10a5-9d43-4ff3-a344-dea4993dc5cc"],
Cell[277844, 7598, 897, 26, 72, "Input",ExpressionUUID->"f93f791a-a94c-49c1-a248-4230e871d0b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278778, 7629, 90, 0, 45, "Subsubsection",ExpressionUUID->"2d5b5c77-1a89-4d83-a047-1bd659ee262a"],
Cell[278871, 7631, 891, 26, 69, "Input",ExpressionUUID->"e99c6949-5e64-4edc-84c5-75a65a265216"]
}, Closed]],
Cell[CellGroupData[{
Cell[279799, 7662, 95, 0, 37, "Subsubsection",ExpressionUUID->"1f26e320-407e-425d-9209-dfcd9cb77c16"],
Cell[279897, 7664, 2424, 67, 69, "Input",ExpressionUUID->"b1483028-accd-4c60-8e58-5e2674182e3c"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[282370, 7737, 86, 0, 54, "Subsection",ExpressionUUID->"7d6632a6-14a3-4775-b9ee-e736498733d5"],
Cell[CellGroupData[{
Cell[282481, 7741, 99, 0, 45, "Subsubsection",ExpressionUUID->"5363efab-ff9f-4489-b705-ce5b6b7a4e39"],
Cell[282583, 7743, 15937, 360, 1437, "Input",ExpressionUUID->"1183348c-8f9e-474d-a87c-48662099130f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298557, 8108, 93, 0, 45, "Subsubsection",ExpressionUUID->"c81201cf-ff3e-4ed2-a68c-c58594508827"],
Cell[298653, 8110, 13747, 315, 1617, "Input",ExpressionUUID->"678cdefa-52cc-4b91-9baf-30569acb62a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[312449, 8431, 91, 0, 54, "Subsection",ExpressionUUID->"57351ab8-9ddd-4bb4-b8e6-fe63bfcae2fa"],
Cell[312543, 8433, 272, 7, 31, "Input",ExpressionUUID->"633090a1-a62f-4609-b11f-0cb77639a3d0"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[312888, 8448, 84, 0, 98, "Title",ExpressionUUID->"85b79d37-30ac-44be-b21e-b3a94d0ae993"],
Cell[312975, 8450, 564, 8, 127, "Text",ExpressionUUID->"80a87b3a-2d8c-41a2-9d52-a2d60db6151d"],
Cell[313542, 8460, 715, 10, 150, "Text",ExpressionUUID->"8f203d45-af0a-4d97-aab9-29885ad20984"],
Cell[314260, 8472, 153, 4, 29, "Input",ExpressionUUID->"679a0120-1349-40d3-8a10-da4861f9ebc3"],
Cell[314416, 8478, 197, 3, 23, "TA",ExpressionUUID->"40df5eae-ca0e-4df8-a9e4-99253cf1d47e"],
Cell[314616, 8483, 271, 4, 39, "TA",ExpressionUUID->"9085664c-d43c-41d0-b295-2e4219a58387"],
Cell[314890, 8489, 287, 5, 23, "TA",ExpressionUUID->"4a40bfec-a76e-4fdc-a6d9-4147755f7b20"],
Cell[CellGroupData[{
Cell[315202, 8498, 103, 0, 45, "Subsubsection",ExpressionUUID->"385a0e8b-1f23-4a6b-89f9-bc8cf41af9b0"],
Cell[315308, 8500, 508, 9, 104, "Text",ExpressionUUID->"20e784cf-8453-43a9-aff2-acfddb7063ea"],
Cell[315819, 8511, 231, 4, 39, "TA",ExpressionUUID->"8c558e5e-989b-422a-94c5-3d1385b81daf"],
Cell[316053, 8517, 366, 5, 81, "Text",ExpressionUUID->"b93079cb-2c7e-4a8f-921c-6e82fab76d44"],
Cell[316422, 8524, 181, 3, 29, "Input",ExpressionUUID->"4a562ff9-9d9e-4c2d-98a4-75db2d104959"],
Cell[316606, 8529, 1599, 40, 190, "Input",ExpressionUUID->"031005a7-ec4c-4cff-95cd-a514c38fb8d7"],
Cell[318208, 8571, 96, 0, 35, "Text",ExpressionUUID->"14674068-d6d6-45ec-bb5e-4453378f5e1f"],
Cell[318307, 8573, 149, 3, 29, "Input",ExpressionUUID->"4e797a9e-8c20-4870-a8b4-28e8b50899c9"]
}, Open  ]]
}, Open  ]]
}
]
*)

